import{a as g,r as n,j as e,e as b}from"./index-CBPv6F-N.js";import{T as y}from"./Topbar-CFjW05tQ.js";import{U as v}from"./upload-GE-NSHzq.js";import{P as x}from"./paperclip-ZwBKu5Wg.js";import{L as N}from"./link-2-CSB41ZGr.js";import{T as k}from"./trash-2-BjhHTPCW.js";function C(){const{attachments:l,rubrics:d,addAttachment:c,deleteAttachment:h}=g(),[p,r]=n.useState(!1),[i,u]=n.useState(""),o=n.useRef(null),m=n.useCallback(t=>{t&&Array.from(t).forEach(s=>{const a=new FileReader;a.onload=()=>{c({name:s.name,mimeType:s.type,dataUrl:a.result,rubricId:i||void 0,size:s.size})},a.readAsDataURL(s)})},[c,i]);function j(t){const s=document.createElement("a");s.href=t.dataUrl,s.download=t.name,s.click()}function f(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/1024/1024).toFixed(1)} MB`}return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Attachments"}),e.jsxs("div",{className:"page-content fade-in",children:[e.jsxs("div",{className:`drop-zone ${p?"drag-over":""}`,style:{marginBottom:24},onClick:()=>{var t;return(t=o.current)==null?void 0:t.click()},onDragOver:t=>{t.preventDefault(),r(!0)},onDragLeave:()=>r(!1),onDrop:t=>{t.preventDefault(),r(!1),m(t.dataTransfer.files)},children:[e.jsx(v,{size:28,style:{margin:"0 auto 10px",display:"block"}}),e.jsx("p",{style:{fontWeight:600},children:"Drag & drop files here, or click to browse"}),e.jsx("p",{className:"text-xs text-muted",style:{marginTop:6},children:"PDFs, images, Word docs, and more"}),e.jsxs("div",{style:{marginTop:14,display:"flex",gap:10,justifyContent:"center",alignItems:"center"},children:[e.jsx("label",{className:"text-xs text-muted",children:"Link to rubric:"}),e.jsxs("select",{value:i,onChange:t=>u(t.target.value),style:{width:200},onClick:t=>t.stopPropagation(),children:[e.jsx("option",{value:"",children:"â€” No rubric â€”"}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]}),e.jsx("input",{ref:o,type:"file",multiple:!0,onChange:t=>m(t.target.files),style:{display:"none"}}),l.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(x,{size:32}),e.jsx("p",{children:"No attachments yet. Upload files above."})]}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Linked Rubric"}),e.jsx("th",{children:"Added"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:l.map(t=>{const s=d.find(a=>a.id===t.rubricId);return e.jsxs("tr",{children:[e.jsxs("td",{style:{fontWeight:500,display:"flex",alignItems:"center",gap:8},children:[e.jsx(x,{size:14,style:{color:"var(--accent)"}}),t.name]}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-blue",children:t.mimeType.split("/")[1]??t.mimeType})}),e.jsx("td",{className:"text-muted text-sm",children:f(t.size)}),e.jsx("td",{children:s?e.jsxs("span",{className:"badge badge-purple",children:[e.jsx(N,{size:11})," ",s.name]}):e.jsx("span",{className:"text-muted text-xs",children:"â€”"})}),e.jsx("td",{className:"text-muted text-sm",children:new Date(t.addedAt).toLocaleDateString()}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",onClick:()=>j(t),title:"Download",children:e.jsx(b,{size:14})}),t.mimeType.startsWith("image/")&&e.jsx("a",{href:t.dataUrl,target:"_blank",rel:"noopener noreferrer",className:"btn btn-ghost btn-icon btn-sm",title:"Preview",children:"ðŸ‘"}),e.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",style:{color:"var(--red)"},onClick:()=>h(t.id),children:e.jsx(k,{size:14})})]})})]},t.id)})})]})]})]})}export{C as default};
