import{c as at,a as La,r as ye,j as W,B as ti,R as jo,b as Et,u as Lo,d as Mo,D as Ri,S as Uo,F as Ci,n as tt}from"./index-CBPv6F-N.js";import{T as zo}from"./Topbar-CFjW05tQ.js";import{S as Wo}from"./search-BoT7dOho.js";import{A as Ho}from"./alert-circle-CvnIH5H0.js";import{L as qo,e as Ko}from"./pdfExport-BoXWpiSs.js";import{L as Ma}from"./link-2-CSB41ZGr.js";import{A as Go}from"./arrow-left-BQjf5gsB.js";import{S as Vo,X as Xo}from"./x-DqjBKJ4Y.js";import{P as Dt}from"./plus-DFQj3cQy.js";import{T as or}from"./trash-2-BjhHTPCW.js";import"./gradeCalc-sZypAYmG.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=at("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=at("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=at("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=at("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=at("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=at("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=at("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),ui="https://api.commonstandardsproject.com/api/v1";function ci(i){return{"Api-Key":i,"Content-Type":"application/json"}}async function el(i){const e=await fetch(`${ui}/jurisdictions`,{headers:ci(i)});if(!e.ok)throw new Error(`CSP API error ${e.status}: ${e.statusText}`);return(await e.json()).data??[]}async function tl(i,e){const t=await fetch(`${ui}/jurisdictions/${encodeURIComponent(e)}`,{headers:ci(i)});if(!t.ok)throw new Error(`CSP API error ${t.status}: ${t.statusText}`);return(await t.json()).data.standardSets??[]}async function rl(i,e){const t=await fetch(`${ui}/standard_sets/${encodeURIComponent(e)}`,{headers:ci(i)});if(!t.ok)throw new Error(`CSP API error ${t.status}: ${t.statusText}`);return(await t.json()).data}function Ni(i){const e=Object.values(i),t={},a=[],h=(n,c)=>{const w=n.statementNotation||n.description,_=c.statementNotation||c.description;return w.localeCompare(_,void 0,{numeric:!0,sensitivity:"base"})};e.forEach(n=>{const c=n.ancestorIds.length>0?n.ancestorIds[n.ancestorIds.length-1]:null;c&&i[c]?(t[c]||(t[c]=[]),t[c].push(n)):a.push(n)}),a.sort(h),Object.values(t).forEach(n=>n.sort(h));const l=[],d=n=>{n.forEach(c=>{l.push(c),t[c.id]&&d(t[c.id])})};return d(a),l}function nl({apiKey:i,onSelect:e,onClose:t}){const{favoriteStandards:a,addFavoriteStandard:h,removeFavoriteStandard:l,isFavoriteStandard:d}=La(),[n,c]=ye.useState("browse"),[w,_]=ye.useState("jurisdiction"),[k,C]=ye.useState(!1),[E,R]=ye.useState(""),[b,T]=ye.useState([]),[o,y]=ye.useState(null),[m,u]=ye.useState([]),[A,P]=ye.useState(null),[j,q]=ye.useState([]),[N,Y]=ye.useState("");ye.useEffect(()=>{n==="browse"&&w==="jurisdiction"&&b.length===0&&(C(!0),el(i).then(ee=>{T(ee),C(!1)}).catch(ee=>{R(ee.message),C(!1)}))},[i,n,w,b.length]);async function ue(ee){y(ee),_("set"),C(!0),R("");try{const V=await tl(i,ee.id);u(V)}catch(V){R(V.message)}C(!1)}async function I(ee){P(ee),_("standard"),C(!0),R("");try{const V=await rl(i,ee.id);q(Ni(V.standards))}catch(V){R(V.message)}C(!1)}function U(ee){e(ee),t()}function x(ee){const V={guid:ee.id,statementNotation:ee.statementNotation,description:ee.description,standardSetTitle:(A==null?void 0:A.title)??"",jurisdictionTitle:(o==null?void 0:o.title)??""};e(V),t()}function Z(ee,V){V.stopPropagation(),d(ee.id)?l(ee.id):h({guid:ee.id,statementNotation:ee.statementNotation,description:ee.description,standardSetTitle:(A==null?void 0:A.title)??"",jurisdictionTitle:(o==null?void 0:o.title)??"",ancestorIds:ee.ancestorIds,depth:ee.depth})}const re=ye.useMemo(()=>N.trim()?j.filter(ee=>ee.description.toLowerCase().includes(N.toLowerCase())||(ee.statementNotation??"").toLowerCase().includes(N.toLowerCase())):j,[j,N]),H=ye.useMemo(()=>N.trim()?a.filter(ee=>ee.description.toLowerCase().includes(N.toLowerCase())||(ee.statementNotation??"").toLowerCase().includes(N.toLowerCase())):a,[a,N]),ie=ye.useMemo(()=>{if(H.length===0)return[];const ee={};H.forEach(X=>{ee[X.guid]={id:X.guid,description:X.description,statementNotation:X.statementNotation,depth:X.depth??0,ancestorIds:X.ancestorIds??[]}});const V=Ni(ee),O=new Map(H.map(X=>[X.guid,X]));return V.map(X=>O.get(X.id)).filter(Boolean)},[H]),te=[{key:"jurisdiction",label:(o==null?void 0:o.title)??"Jurisdiction"},{key:"set",label:(A==null?void 0:A.title)??"Standard Set"},{key:"standard",label:"Pick Standard"}];return W.jsx("div",{className:"modal-overlay",onClick:t,children:W.jsxs("div",{className:"modal",style:{width:800,height:"85vh",maxHeight:"85vh",display:"flex",flexDirection:"column"},onClick:ee=>ee.stopPropagation(),children:[W.jsxs("div",{className:"modal-header",children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[W.jsx(ti,{size:20,style:{color:"var(--accent)"}}),W.jsx("h3",{children:"Link Standard"})]}),W.jsxs("div",{style:{display:"flex",background:"var(--bg-elevated)",borderRadius:6,padding:2,marginLeft:16},children:[W.jsx("button",{className:`btn btn-sm ${n==="browse"?"btn-white shadow-sm":"btn-ghost"}`,onClick:()=>c("browse"),style:{fontSize:"0.8rem",padding:"4px 12px"},children:"Browse"}),W.jsxs("button",{className:`btn btn-sm ${n==="favorites"?"btn-white shadow-sm":"btn-ghost"}`,onClick:()=>c("favorites"),style:{fontSize:"0.8rem",padding:"4px 12px",display:"flex",gap:4,alignItems:"center"},children:[W.jsx(jt,{size:12,fill:n==="favorites"?"var(--yellow)":"none",color:n==="favorites"?"var(--yellow)":"currentColor"}),"Favorites (",a.length,")"]})]})]}),W.jsx("button",{className:"btn btn-ghost btn-icon",onClick:t,children:"✕"})]}),n==="browse"&&W.jsx("div",{style:{display:"flex",gap:6,alignItems:"center",padding:"10px 20px",background:"var(--bg-elevated)",flexShrink:0,flexWrap:"wrap",borderBottom:"1px solid var(--border)"},children:te.map((ee,V)=>W.jsxs(jo.Fragment,{children:[V>0&&W.jsx(ri,{size:14,style:{color:"var(--text-muted)"}}),W.jsx("button",{className:`btn btn-ghost btn-sm ${ee.key===w?"":"text-muted"}`,style:{padding:"2px 6px",fontSize:"0.8rem",opacity:V<te.findIndex(O=>O.key===w)?1:.5},disabled:V>=te.findIndex(O=>O.key===w),onClick:()=>{V===0&&(_("jurisdiction"),P(null),y(null)),V===1&&o&&_("set")},children:ee.label})]},ee.key))}),(n==="browse"&&w==="standard"||n==="favorites")&&W.jsx("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)"},children:W.jsxs("div",{style:{position:"relative"},children:[W.jsx(Wo,{size:15,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),W.jsx("input",{type:"text",placeholder:n==="favorites"?"Search favorites...":"Search in current set...",value:N,onChange:ee=>Y(ee.target.value),style:{paddingLeft:32,width:"100%"}})]})}),W.jsxs("div",{className:"modal-body",style:{flex:1,overflowY:"auto",padding:0},children:[E&&W.jsx("div",{style:{padding:20},children:W.jsxs("div",{style:{background:"var(--red-subtle)",border:"1px solid var(--red)",borderRadius:8,padding:12,display:"flex",gap:8,alignItems:"flex-start"},children:[W.jsx(Ho,{size:16,style:{color:"var(--red)",marginTop:1,flexShrink:0}}),W.jsxs("div",{className:"text-sm",children:[W.jsx("strong",{children:"API Error:"})," ",E,E.includes("403")||E.includes("401")?W.jsxs("div",{style:{marginTop:4},children:["Check your API key in Settings, and make sure your origin is added to the ",W.jsx("a",{href:"https://commonstandardsproject.com/developers",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--accent)"},children:"CSP CORS allowlist"}),"."]}):null]})]})}),k&&W.jsx("div",{style:{display:"flex",justifyContent:"center",padding:48},children:W.jsx(qo,{size:24,className:"spin",style:{color:"var(--accent)"}})}),!k&&n==="favorites"&&W.jsxs("div",{style:{padding:"10px 0"},children:[a.length===0&&W.jsxs("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:[W.jsx(jt,{size:32,style:{marginBottom:12,opacity:.3}}),W.jsx("p",{children:"No favorites yet."}),W.jsx("p",{className:"text-sm",style:{marginTop:8},children:"Star standards in the Browse tab to save them here."})]}),H.length===0&&a.length>0&&W.jsx("div",{className:"text-muted text-sm",style:{padding:20,textAlign:"center"},children:"No favorites match your search."}),ie.map(ee=>W.jsxs("div",{className:"standard-row",style:{padding:`12px 20px 12px ${20+(ee.depth??0)*20}px`,borderBottom:"1px solid var(--border)",display:"flex",gap:12,alignItems:"flex-start",background:"var(--bg-card)"},children:[W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",onClick:()=>l(ee.guid),style:{flexShrink:0,marginTop:2,color:"var(--yellow)"},children:W.jsx(jt,{size:16,fill:"currentColor"})}),W.jsx("div",{style:{flex:1,cursor:"pointer"},onClick:()=>U(ee),children:W.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[W.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[ee.statementNotation&&W.jsx("span",{className:"badge badge-blue",style:{flexShrink:0,color:"var(--accent)"},children:ee.statementNotation}),W.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[ee.jurisdictionTitle," › ",ee.standardSetTitle]})]}),W.jsx("div",{style:{fontSize:"0.9rem",lineHeight:1.5,whiteSpace:"normal",color:"var(--text)"},children:ee.description})]})}),W.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>U(ee),children:"Select"})]},ee.guid))]}),!k&&n==="browse"&&W.jsxs(W.Fragment,{children:[w==="jurisdiction"&&W.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:12,padding:20},children:b.map(ee=>W.jsxs("button",{className:"card-hover",style:{textAlign:"left",padding:16,border:"1px solid var(--border)",borderRadius:8,background:"var(--bg-elevated)",display:"flex",flexDirection:"column",gap:4,transition:"all 0.2s",cursor:"pointer"},onClick:()=>ue(ee),children:[W.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem"},children:ee.title}),W.jsx("div",{className:"text-xs text-muted",children:ee.type})]},ee.id))}),w==="set"&&W.jsx("div",{style:{display:"flex",flexDirection:"column",padding:"10px 0"},children:m.map(ee=>{var V;return W.jsxs("button",{className:"btn btn-ghost",style:{justifyContent:"flex-start",textAlign:"left",padding:"14px 20px",height:"auto",borderBottom:"1px solid var(--border-subtle)"},onClick:()=>I(ee),children:[W.jsxs("div",{children:[W.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem"},children:ee.title}),W.jsxs("div",{className:"text-xs text-muted",style:{marginTop:4},children:[ee.subject,(V=ee.educationLevels)!=null&&V.length?` · ${ee.educationLevels.join(", ")}`:""]})]}),W.jsx(ri,{size:16,className:"text-muted",style:{marginLeft:"auto"}})]},ee.id)})}),w==="standard"&&W.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[re.map(ee=>{const V=d(ee.id);return W.jsxs("div",{style:{padding:`12px 20px 12px ${20+ee.depth*20}px`,borderBottom:"1px solid var(--border-subtle)",display:"flex",gap:12,alignItems:"flex-start",background:"var(--bg-card)"},children:[W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",onClick:O=>Z(ee,O),title:V?"Remove from favorites":"Add to favorites",style:{flexShrink:0,marginTop:2,color:V?"var(--yellow)":"var(--text-dim)"},children:W.jsx(jt,{size:16,fill:V?"currentColor":"none"})}),W.jsxs("div",{style:{flex:1,cursor:"pointer",display:"flex",gap:10,alignItems:"flex-start"},onClick:()=>x(ee),children:[ee.statementNotation&&W.jsx("span",{className:"badge badge-blue",style:{flexShrink:0,marginTop:1,fontSize:"0.75rem"},children:ee.statementNotation}),W.jsx("span",{style:{fontSize:"0.9rem",lineHeight:1.5,whiteSpace:"normal",color:"var(--text)"},children:ee.description})]}),W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm text-accent",onClick:()=>x(ee),children:W.jsx(Ma,{size:16})})]},ee.id)}),re.length===0&&!k&&W.jsx("div",{className:"text-muted text-sm",style:{padding:20,textAlign:"center"},children:"No standards match your search."})]})]})]})]})})}var il=Object.defineProperty,sl=Object.defineProperties,al=Object.getOwnPropertyDescriptors,Ii=Object.getOwnPropertySymbols,ol=Object.prototype.hasOwnProperty,ll=Object.prototype.propertyIsEnumerable,ni=(i,e,t)=>e in i?il(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,we=(i,e)=>{for(var t in e||(e={}))ol.call(e,t)&&ni(i,t,e[t]);if(Ii)for(var t of Ii(e))ll.call(e,t)&&ni(i,t,e[t]);return i},it=(i,e)=>sl(i,al(e)),ae=(i,e,t)=>ni(i,typeof e!="symbol"?e+"":e,t),ul=(i,e,t)=>new Promise((a,h)=>{var l=c=>{try{n(t.next(c))}catch(w){h(w)}},d=c=>{try{n(t.throw(c))}catch(w){h(w)}},n=c=>c.done?a(c.value):Promise.resolve(c.value).then(l,d);n((t=t.apply(i,e)).next())});class Zt{constructor(e){ae(this,"rootKey"),this.rootKey=e}}const cl=Object.seal({});class le extends Zt{constructor(e){super(e),ae(this,"root"),this.root=new Array}prepForXml(e){var t;e.stack.push(this);const a=this.root.map(h=>h instanceof Zt?h.prepForXml(e):h).filter(h=>h!==void 0);return e.stack.pop(),{[this.rootKey]:a.length?a.length===1&&((t=a[0])!=null&&t._attr)?a[0]:a:cl}}addChildElement(e){return this.root.push(e),this}}class Ke extends le{prepForXml(e){const t=super.prepForXml(e);if(t&&(typeof t[this.rootKey]!="object"||Object.keys(t[this.rootKey]).length))return t}}class pe extends Zt{constructor(e){super("_attr"),ae(this,"xmlKeys"),this.root=e}prepForXml(e){const t={};return Object.entries(this.root).forEach(([a,h])=>{if(h!==void 0){const l=this.xmlKeys&&this.xmlKeys[a]||a;t[l]=h}}),{_attr:t}}}class $e extends Zt{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:a})=>a!==void 0).reduce((a,{key:h,value:l})=>it(we({},a),{[h]:l}),{})}}}class _e extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ua(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var lr={},Lt={exports:{}},Fi;function hi(){if(Fi)return Lt.exports;Fi=1;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(A,P,j){return Function.prototype.apply.call(A,P,j)},t;i&&typeof i.ownKeys=="function"?t=i.ownKeys:Object.getOwnPropertySymbols?t=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:t=function(A){return Object.getOwnPropertyNames(A)};function a(u){console&&console.warn&&console.warn(u)}var h=Number.isNaN||function(A){return A!==A};function l(){l.init.call(this)}Lt.exports=l,Lt.exports.once=o,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var d=10;function n(u){if(typeof u!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof u)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(u){if(typeof u!="number"||u<0||h(u))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+u+".");d=u}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||h(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function c(u){return u._maxListeners===void 0?l.defaultMaxListeners:u._maxListeners}l.prototype.getMaxListeners=function(){return c(this)},l.prototype.emit=function(A){for(var P=[],j=1;j<arguments.length;j++)P.push(arguments[j]);var q=A==="error",N=this._events;if(N!==void 0)q=q&&N.error===void 0;else if(!q)return!1;if(q){var Y;if(P.length>0&&(Y=P[0]),Y instanceof Error)throw Y;var ue=new Error("Unhandled error."+(Y?" ("+Y.message+")":""));throw ue.context=Y,ue}var I=N[A];if(I===void 0)return!1;if(typeof I=="function")e(I,this,P);else for(var U=I.length,x=R(I,U),j=0;j<U;++j)e(x[j],this,P);return!0};function w(u,A,P,j){var q,N,Y;if(n(P),N=u._events,N===void 0?(N=u._events=Object.create(null),u._eventsCount=0):(N.newListener!==void 0&&(u.emit("newListener",A,P.listener?P.listener:P),N=u._events),Y=N[A]),Y===void 0)Y=N[A]=P,++u._eventsCount;else if(typeof Y=="function"?Y=N[A]=j?[P,Y]:[Y,P]:j?Y.unshift(P):Y.push(P),q=c(u),q>0&&Y.length>q&&!Y.warned){Y.warned=!0;var ue=new Error("Possible EventEmitter memory leak detected. "+Y.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");ue.name="MaxListenersExceededWarning",ue.emitter=u,ue.type=A,ue.count=Y.length,a(ue)}return u}l.prototype.addListener=function(A,P){return w(this,A,P,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(A,P){return w(this,A,P,!0)};function _(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function k(u,A,P){var j={fired:!1,wrapFn:void 0,target:u,type:A,listener:P},q=_.bind(j);return q.listener=P,j.wrapFn=q,q}l.prototype.once=function(A,P){return n(P),this.on(A,k(this,A,P)),this},l.prototype.prependOnceListener=function(A,P){return n(P),this.prependListener(A,k(this,A,P)),this},l.prototype.removeListener=function(A,P){var j,q,N,Y,ue;if(n(P),q=this._events,q===void 0)return this;if(j=q[A],j===void 0)return this;if(j===P||j.listener===P)--this._eventsCount===0?this._events=Object.create(null):(delete q[A],q.removeListener&&this.emit("removeListener",A,j.listener||P));else if(typeof j!="function"){for(N=-1,Y=j.length-1;Y>=0;Y--)if(j[Y]===P||j[Y].listener===P){ue=j[Y].listener,N=Y;break}if(N<0)return this;N===0?j.shift():b(j,N),j.length===1&&(q[A]=j[0]),q.removeListener!==void 0&&this.emit("removeListener",A,ue||P)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(A){var P,j,q;if(j=this._events,j===void 0)return this;if(j.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):j[A]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete j[A]),this;if(arguments.length===0){var N=Object.keys(j),Y;for(q=0;q<N.length;++q)Y=N[q],Y!=="removeListener"&&this.removeAllListeners(Y);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=j[A],typeof P=="function")this.removeListener(A,P);else if(P!==void 0)for(q=P.length-1;q>=0;q--)this.removeListener(A,P[q]);return this};function C(u,A,P){var j=u._events;if(j===void 0)return[];var q=j[A];return q===void 0?[]:typeof q=="function"?P?[q.listener||q]:[q]:P?T(q):R(q,q.length)}l.prototype.listeners=function(A){return C(this,A,!0)},l.prototype.rawListeners=function(A){return C(this,A,!1)},l.listenerCount=function(u,A){return typeof u.listenerCount=="function"?u.listenerCount(A):E.call(u,A)},l.prototype.listenerCount=E;function E(u){var A=this._events;if(A!==void 0){var P=A[u];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function R(u,A){for(var P=new Array(A),j=0;j<A;++j)P[j]=u[j];return P}function b(u,A){for(;A+1<u.length;A++)u[A]=u[A+1];u.pop()}function T(u){for(var A=new Array(u.length),P=0;P<A.length;++P)A[P]=u[P].listener||u[P];return A}function o(u,A){return new Promise(function(P,j){function q(Y){u.removeListener(A,N),j(Y)}function N(){typeof u.removeListener=="function"&&u.removeListener("error",q),P([].slice.call(arguments))}m(u,A,N,{once:!0}),A!=="error"&&y(u,q,{once:!0})})}function y(u,A,P){typeof u.on=="function"&&m(u,"error",A,P)}function m(u,A,P,j){if(typeof u.on=="function")j.once?u.once(A,P):u.on(A,P);else if(typeof u.addEventListener=="function")u.addEventListener(A,function q(N){j.once&&u.removeEventListener(A,q),P(N)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof u)}return Lt.exports}var Mt={exports:{}},Oi;function Ze(){return Oi||(Oi=1,typeof Object.create=="function"?Mt.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Mt.exports=function(e,t){if(t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}}),Mt.exports}function hl(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var za={exports:{}},Se=za.exports={},De,je;function ii(){throw new Error("setTimeout has not been defined")}function si(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?De=setTimeout:De=ii}catch{De=ii}try{typeof clearTimeout=="function"?je=clearTimeout:je=si}catch{je=si}})();function Wa(i){if(De===setTimeout)return setTimeout(i,0);if((De===ii||!De)&&setTimeout)return De=setTimeout,setTimeout(i,0);try{return De(i,0)}catch{try{return De.call(null,i,0)}catch{return De.call(this,i,0)}}}function fl(i){if(je===clearTimeout)return clearTimeout(i);if((je===si||!je)&&clearTimeout)return je=clearTimeout,clearTimeout(i);try{return je(i)}catch{try{return je.call(null,i)}catch{return je.call(this,i)}}}var He=[],dt=!1,rt,$t=-1;function dl(){!dt||!rt||(dt=!1,rt.length?He=rt.concat(He):$t=-1,He.length&&Ha())}function Ha(){if(!dt){var i=Wa(dl);dt=!0;for(var e=He.length;e;){for(rt=He,He=[];++$t<e;)rt&&rt[$t].run();$t=-1,e=He.length}rt=null,dt=!1,fl(i)}}Se.nextTick=function(i){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];He.push(new qa(i,e)),He.length===1&&!dt&&Wa(Ha)};function qa(i,e){this.fun=i,this.array=e}qa.prototype.run=function(){this.fun.apply(null,this.array)};Se.title="browser";Se.browser=!0;Se.env={};Se.argv=[];Se.version="";Se.versions={};function Ge(){}Se.on=Ge;Se.addListener=Ge;Se.once=Ge;Se.off=Ge;Se.removeListener=Ge;Se.removeAllListeners=Ge;Se.emit=Ge;Se.prependListener=Ge;Se.prependOnceListener=Ge;Se.listeners=function(i){return[]};Se.binding=function(i){throw new Error("process.binding is not supported")};Se.cwd=function(){return"/"};Se.chdir=function(i){throw new Error("process.chdir is not supported")};Se.umask=function(){return 0};var pl=za.exports;const ge=hl(pl);var ur,Pi;function Ka(){return Pi||(Pi=1,ur=hi().EventEmitter),ur}var cr={},St={},Bi;function ml(){if(Bi)return St;Bi=1,St.byteLength=n,St.toByteArray=w,St.fromByteArray=C;for(var i=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,l=a.length;h<l;++h)i[h]=a[h],e[a.charCodeAt(h)]=h;e[45]=62,e[95]=63;function d(E){var R=E.length;if(R%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b=E.indexOf("=");b===-1&&(b=R);var T=b===R?0:4-b%4;return[b,T]}function n(E){var R=d(E),b=R[0],T=R[1];return(b+T)*3/4-T}function c(E,R,b){return(R+b)*3/4-b}function w(E){var R,b=d(E),T=b[0],o=b[1],y=new t(c(E,T,o)),m=0,u=o>0?T-4:T,A;for(A=0;A<u;A+=4)R=e[E.charCodeAt(A)]<<18|e[E.charCodeAt(A+1)]<<12|e[E.charCodeAt(A+2)]<<6|e[E.charCodeAt(A+3)],y[m++]=R>>16&255,y[m++]=R>>8&255,y[m++]=R&255;return o===2&&(R=e[E.charCodeAt(A)]<<2|e[E.charCodeAt(A+1)]>>4,y[m++]=R&255),o===1&&(R=e[E.charCodeAt(A)]<<10|e[E.charCodeAt(A+1)]<<4|e[E.charCodeAt(A+2)]>>2,y[m++]=R>>8&255,y[m++]=R&255),y}function _(E){return i[E>>18&63]+i[E>>12&63]+i[E>>6&63]+i[E&63]}function k(E,R,b){for(var T,o=[],y=R;y<b;y+=3)T=(E[y]<<16&16711680)+(E[y+1]<<8&65280)+(E[y+2]&255),o.push(_(T));return o.join("")}function C(E){for(var R,b=E.length,T=b%3,o=[],y=16383,m=0,u=b-T;m<u;m+=y)o.push(k(E,m,m+y>u?u:m+y));return T===1?(R=E[b-1],o.push(i[R>>2]+i[R<<4&63]+"==")):T===2&&(R=(E[b-2]<<8)+E[b-1],o.push(i[R>>10]+i[R>>4&63]+i[R<<2&63]+"=")),o.join("")}return St}var Ut={},Di;function gl(){return Di||(Di=1,Ut.read=function(i,e,t,a,h){var l,d,n=h*8-a-1,c=(1<<n)-1,w=c>>1,_=-7,k=t?h-1:0,C=t?-1:1,E=i[e+k];for(k+=C,l=E&(1<<-_)-1,E>>=-_,_+=n;_>0;l=l*256+i[e+k],k+=C,_-=8);for(d=l&(1<<-_)-1,l>>=-_,_+=a;_>0;d=d*256+i[e+k],k+=C,_-=8);if(l===0)l=1-w;else{if(l===c)return d?NaN:(E?-1:1)*(1/0);d=d+Math.pow(2,a),l=l-w}return(E?-1:1)*d*Math.pow(2,l-a)},Ut.write=function(i,e,t,a,h,l){var d,n,c,w=l*8-h-1,_=(1<<w)-1,k=_>>1,C=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=a?0:l-1,R=a?1:-1,b=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(n=isNaN(e)?1:0,d=_):(d=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-d))<1&&(d--,c*=2),d+k>=1?e+=C/c:e+=C*Math.pow(2,1-k),e*c>=2&&(d++,c/=2),d+k>=_?(n=0,d=_):d+k>=1?(n=(e*c-1)*Math.pow(2,h),d=d+k):(n=e*Math.pow(2,k-1)*Math.pow(2,h),d=0));h>=8;i[t+E]=n&255,E+=R,n/=256,h-=8);for(d=d<<h|n,w+=h;w>0;i[t+E]=d&255,E+=R,d/=256,w-=8);i[t+E-R]|=b*128}),Ut}var ji;function Yt(){return ji||(ji=1,function(i){var e=ml(),t=gl(),a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;i.Buffer=n,i.SlowBuffer=y,i.INSPECT_MAX_BYTES=50;var h=2147483647;i.kMaxLength=h,n.TYPED_ARRAY_SUPPORT=l(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{var g=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(g,r),g.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}});function d(g){if(g>h)throw new RangeError('The value "'+g+'" is invalid for option "size"');var r=new Uint8Array(g);return Object.setPrototypeOf(r,n.prototype),r}function n(g,r,s){if(typeof g=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return k(g)}return c(g,r,s)}n.poolSize=8192;function c(g,r,s){if(typeof g=="string")return C(g,r);if(ArrayBuffer.isView(g))return R(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(Q(g,ArrayBuffer)||g&&Q(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Q(g,SharedArrayBuffer)||g&&Q(g.buffer,SharedArrayBuffer)))return b(g,r,s);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var f=g.valueOf&&g.valueOf();if(f!=null&&f!==g)return n.from(f,r,s);var D=T(g);if(D)return D;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return n.from(g[Symbol.toPrimitive]("string"),r,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}n.from=function(g,r,s){return c(g,r,s)},Object.setPrototypeOf(n.prototype,Uint8Array.prototype),Object.setPrototypeOf(n,Uint8Array);function w(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function _(g,r,s){return w(g),g<=0?d(g):r!==void 0?typeof s=="string"?d(g).fill(r,s):d(g).fill(r):d(g)}n.alloc=function(g,r,s){return _(g,r,s)};function k(g){return w(g),d(g<0?0:o(g)|0)}n.allocUnsafe=function(g){return k(g)},n.allocUnsafeSlow=function(g){return k(g)};function C(g,r){if((typeof r!="string"||r==="")&&(r="utf8"),!n.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var s=m(g,r)|0,f=d(s),D=f.write(g,r);return D!==s&&(f=f.slice(0,D)),f}function E(g){for(var r=g.length<0?0:o(g.length)|0,s=d(r),f=0;f<r;f+=1)s[f]=g[f]&255;return s}function R(g){if(Q(g,Uint8Array)){var r=new Uint8Array(g);return b(r.buffer,r.byteOffset,r.byteLength)}return E(g)}function b(g,r,s){if(r<0||g.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<r+(s||0))throw new RangeError('"length" is outside of buffer bounds');var f;return r===void 0&&s===void 0?f=new Uint8Array(g):s===void 0?f=new Uint8Array(g,r):f=new Uint8Array(g,r,s),Object.setPrototypeOf(f,n.prototype),f}function T(g){if(n.isBuffer(g)){var r=o(g.length)|0,s=d(r);return s.length===0||g.copy(s,0,0,r),s}if(g.length!==void 0)return typeof g.length!="number"||p(g.length)?d(0):E(g);if(g.type==="Buffer"&&Array.isArray(g.data))return E(g.data)}function o(g){if(g>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return g|0}function y(g){return+g!=g&&(g=0),n.alloc(+g)}n.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==n.prototype},n.compare=function(r,s){if(Q(r,Uint8Array)&&(r=n.from(r,r.offset,r.byteLength)),Q(s,Uint8Array)&&(s=n.from(s,s.offset,s.byteLength)),!n.isBuffer(r)||!n.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===s)return 0;for(var f=r.length,D=s.length,G=0,z=Math.min(f,D);G<z;++G)if(r[G]!==s[G]){f=r[G],D=s[G];break}return f<D?-1:D<f?1:0},n.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(r,s){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return n.alloc(0);var f;if(s===void 0)for(s=0,f=0;f<r.length;++f)s+=r[f].length;var D=n.allocUnsafe(s),G=0;for(f=0;f<r.length;++f){var z=r[f];if(Q(z,Uint8Array))G+z.length>D.length?n.from(z).copy(D,G):Uint8Array.prototype.set.call(D,z,G);else if(n.isBuffer(z))z.copy(D,G);else throw new TypeError('"list" argument must be an Array of Buffers');G+=z.length}return D};function m(g,r){if(n.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||Q(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);var s=g.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&s===0)return 0;for(var D=!1;;)switch(r){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return v(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s*2;case"hex":return s>>>1;case"base64":return F(g).length;default:if(D)return f?-1:v(g).length;r=(""+r).toLowerCase(),D=!0}}n.byteLength=m;function u(g,r,s){var f=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0,r>>>=0,s<=r))return"";for(g||(g="utf8");;)switch(g){case"hex":return te(this,r,s);case"utf8":case"utf-8":return x(this,r,s);case"ascii":return H(this,r,s);case"latin1":case"binary":return ie(this,r,s);case"base64":return U(this,r,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,r,s);default:if(f)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),f=!0}}n.prototype._isBuffer=!0;function A(g,r,s){var f=g[r];g[r]=g[s],g[s]=f}n.prototype.swap16=function(){var r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var s=0;s<r;s+=2)A(this,s,s+1);return this},n.prototype.swap32=function(){var r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var s=0;s<r;s+=4)A(this,s,s+3),A(this,s+1,s+2);return this},n.prototype.swap64=function(){var r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var s=0;s<r;s+=8)A(this,s,s+7),A(this,s+1,s+6),A(this,s+2,s+5),A(this,s+3,s+4);return this},n.prototype.toString=function(){var r=this.length;return r===0?"":arguments.length===0?x(this,0,r):u.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(r){if(!n.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:n.compare(this,r)===0},n.prototype.inspect=function(){var r="",s=i.INSPECT_MAX_BYTES;return r=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(r+=" ... "),"<Buffer "+r+">"},a&&(n.prototype[a]=n.prototype.inspect),n.prototype.compare=function(r,s,f,D,G){if(Q(r,Uint8Array)&&(r=n.from(r,r.offset,r.byteLength)),!n.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(s===void 0&&(s=0),f===void 0&&(f=r?r.length:0),D===void 0&&(D=0),G===void 0&&(G=this.length),s<0||f>r.length||D<0||G>this.length)throw new RangeError("out of range index");if(D>=G&&s>=f)return 0;if(D>=G)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,D>>>=0,G>>>=0,this===r)return 0;for(var z=G-D,se=f-s,ce=Math.min(z,se),oe=this.slice(D,G),fe=r.slice(s,f),de=0;de<ce;++de)if(oe[de]!==fe[de]){z=oe[de],se=fe[de];break}return z<se?-1:se<z?1:0};function P(g,r,s,f,D){if(g.length===0)return-1;if(typeof s=="string"?(f=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,p(s)&&(s=D?0:g.length-1),s<0&&(s=g.length+s),s>=g.length){if(D)return-1;s=g.length-1}else if(s<0)if(D)s=0;else return-1;if(typeof r=="string"&&(r=n.from(r,f)),n.isBuffer(r))return r.length===0?-1:j(g,r,s,f,D);if(typeof r=="number")return r=r&255,typeof Uint8Array.prototype.indexOf=="function"?D?Uint8Array.prototype.indexOf.call(g,r,s):Uint8Array.prototype.lastIndexOf.call(g,r,s):j(g,[r],s,f,D);throw new TypeError("val must be string, number or Buffer")}function j(g,r,s,f,D){var G=1,z=g.length,se=r.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(g.length<2||r.length<2)return-1;G=2,z/=2,se/=2,s/=2}function ce(ke,Ve){return G===1?ke[Ve]:ke.readUInt16BE(Ve*G)}var oe;if(D){var fe=-1;for(oe=s;oe<z;oe++)if(ce(g,oe)===ce(r,fe===-1?0:oe-fe)){if(fe===-1&&(fe=oe),oe-fe+1===se)return fe*G}else fe!==-1&&(oe-=oe-fe),fe=-1}else for(s+se>z&&(s=z-se),oe=s;oe>=0;oe--){for(var de=!0,me=0;me<se;me++)if(ce(g,oe+me)!==ce(r,me)){de=!1;break}if(de)return oe}return-1}n.prototype.includes=function(r,s,f){return this.indexOf(r,s,f)!==-1},n.prototype.indexOf=function(r,s,f){return P(this,r,s,f,!0)},n.prototype.lastIndexOf=function(r,s,f){return P(this,r,s,f,!1)};function q(g,r,s,f){s=Number(s)||0;var D=g.length-s;f?(f=Number(f),f>D&&(f=D)):f=D;var G=r.length;f>G/2&&(f=G/2);for(var z=0;z<f;++z){var se=parseInt(r.substr(z*2,2),16);if(p(se))return z;g[s+z]=se}return z}function N(g,r,s,f){return B(v(r,g.length-s),g,s,f)}function Y(g,r,s,f){return B(K(r),g,s,f)}function ue(g,r,s,f){return B(F(r),g,s,f)}function I(g,r,s,f){return B(L(r,g.length-s),g,s,f)}n.prototype.write=function(r,s,f,D){if(s===void 0)D="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")D=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,D===void 0&&(D="utf8")):(D=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var G=this.length-s;if((f===void 0||f>G)&&(f=G),r.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");D||(D="utf8");for(var z=!1;;)switch(D){case"hex":return q(this,r,s,f);case"utf8":case"utf-8":return N(this,r,s,f);case"ascii":case"latin1":case"binary":return Y(this,r,s,f);case"base64":return ue(this,r,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,r,s,f);default:if(z)throw new TypeError("Unknown encoding: "+D);D=(""+D).toLowerCase(),z=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(g,r,s){return r===0&&s===g.length?e.fromByteArray(g):e.fromByteArray(g.slice(r,s))}function x(g,r,s){s=Math.min(g.length,s);for(var f=[],D=r;D<s;){var G=g[D],z=null,se=G>239?4:G>223?3:G>191?2:1;if(D+se<=s){var ce,oe,fe,de;switch(se){case 1:G<128&&(z=G);break;case 2:ce=g[D+1],(ce&192)===128&&(de=(G&31)<<6|ce&63,de>127&&(z=de));break;case 3:ce=g[D+1],oe=g[D+2],(ce&192)===128&&(oe&192)===128&&(de=(G&15)<<12|(ce&63)<<6|oe&63,de>2047&&(de<55296||de>57343)&&(z=de));break;case 4:ce=g[D+1],oe=g[D+2],fe=g[D+3],(ce&192)===128&&(oe&192)===128&&(fe&192)===128&&(de=(G&15)<<18|(ce&63)<<12|(oe&63)<<6|fe&63,de>65535&&de<1114112&&(z=de))}}z===null?(z=65533,se=1):z>65535&&(z-=65536,f.push(z>>>10&1023|55296),z=56320|z&1023),f.push(z),D+=se}return re(f)}var Z=4096;function re(g){var r=g.length;if(r<=Z)return String.fromCharCode.apply(String,g);for(var s="",f=0;f<r;)s+=String.fromCharCode.apply(String,g.slice(f,f+=Z));return s}function H(g,r,s){var f="";s=Math.min(g.length,s);for(var D=r;D<s;++D)f+=String.fromCharCode(g[D]&127);return f}function ie(g,r,s){var f="";s=Math.min(g.length,s);for(var D=r;D<s;++D)f+=String.fromCharCode(g[D]);return f}function te(g,r,s){var f=g.length;(!r||r<0)&&(r=0),(!s||s<0||s>f)&&(s=f);for(var D="",G=r;G<s;++G)D+=M[g[G]];return D}function ee(g,r,s){for(var f=g.slice(r,s),D="",G=0;G<f.length-1;G+=2)D+=String.fromCharCode(f[G]+f[G+1]*256);return D}n.prototype.slice=function(r,s){var f=this.length;r=~~r,s=s===void 0?f:~~s,r<0?(r+=f,r<0&&(r=0)):r>f&&(r=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<r&&(s=r);var D=this.subarray(r,s);return Object.setPrototypeOf(D,n.prototype),D};function V(g,r,s){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+r>s)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUintLE=n.prototype.readUIntLE=function(r,s,f){r=r>>>0,s=s>>>0,f||V(r,s,this.length);for(var D=this[r],G=1,z=0;++z<s&&(G*=256);)D+=this[r+z]*G;return D},n.prototype.readUintBE=n.prototype.readUIntBE=function(r,s,f){r=r>>>0,s=s>>>0,f||V(r,s,this.length);for(var D=this[r+--s],G=1;s>0&&(G*=256);)D+=this[r+--s]*G;return D},n.prototype.readUint8=n.prototype.readUInt8=function(r,s){return r=r>>>0,s||V(r,1,this.length),this[r]},n.prototype.readUint16LE=n.prototype.readUInt16LE=function(r,s){return r=r>>>0,s||V(r,2,this.length),this[r]|this[r+1]<<8},n.prototype.readUint16BE=n.prototype.readUInt16BE=function(r,s){return r=r>>>0,s||V(r,2,this.length),this[r]<<8|this[r+1]},n.prototype.readUint32LE=n.prototype.readUInt32LE=function(r,s){return r=r>>>0,s||V(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216},n.prototype.readUint32BE=n.prototype.readUInt32BE=function(r,s){return r=r>>>0,s||V(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])},n.prototype.readIntLE=function(r,s,f){r=r>>>0,s=s>>>0,f||V(r,s,this.length);for(var D=this[r],G=1,z=0;++z<s&&(G*=256);)D+=this[r+z]*G;return G*=128,D>=G&&(D-=Math.pow(2,8*s)),D},n.prototype.readIntBE=function(r,s,f){r=r>>>0,s=s>>>0,f||V(r,s,this.length);for(var D=s,G=1,z=this[r+--D];D>0&&(G*=256);)z+=this[r+--D]*G;return G*=128,z>=G&&(z-=Math.pow(2,8*s)),z},n.prototype.readInt8=function(r,s){return r=r>>>0,s||V(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]},n.prototype.readInt16LE=function(r,s){r=r>>>0,s||V(r,2,this.length);var f=this[r]|this[r+1]<<8;return f&32768?f|4294901760:f},n.prototype.readInt16BE=function(r,s){r=r>>>0,s||V(r,2,this.length);var f=this[r+1]|this[r]<<8;return f&32768?f|4294901760:f},n.prototype.readInt32LE=function(r,s){return r=r>>>0,s||V(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},n.prototype.readInt32BE=function(r,s){return r=r>>>0,s||V(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},n.prototype.readFloatLE=function(r,s){return r=r>>>0,s||V(r,4,this.length),t.read(this,r,!0,23,4)},n.prototype.readFloatBE=function(r,s){return r=r>>>0,s||V(r,4,this.length),t.read(this,r,!1,23,4)},n.prototype.readDoubleLE=function(r,s){return r=r>>>0,s||V(r,8,this.length),t.read(this,r,!0,52,8)},n.prototype.readDoubleBE=function(r,s){return r=r>>>0,s||V(r,8,this.length),t.read(this,r,!1,52,8)};function O(g,r,s,f,D,G){if(!n.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>D||r<G)throw new RangeError('"value" argument is out of bounds');if(s+f>g.length)throw new RangeError("Index out of range")}n.prototype.writeUintLE=n.prototype.writeUIntLE=function(r,s,f,D){if(r=+r,s=s>>>0,f=f>>>0,!D){var G=Math.pow(2,8*f)-1;O(this,r,s,f,G,0)}var z=1,se=0;for(this[s]=r&255;++se<f&&(z*=256);)this[s+se]=r/z&255;return s+f},n.prototype.writeUintBE=n.prototype.writeUIntBE=function(r,s,f,D){if(r=+r,s=s>>>0,f=f>>>0,!D){var G=Math.pow(2,8*f)-1;O(this,r,s,f,G,0)}var z=f-1,se=1;for(this[s+z]=r&255;--z>=0&&(se*=256);)this[s+z]=r/se&255;return s+f},n.prototype.writeUint8=n.prototype.writeUInt8=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,1,255,0),this[s]=r&255,s+1},n.prototype.writeUint16LE=n.prototype.writeUInt16LE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,2,65535,0),this[s]=r&255,this[s+1]=r>>>8,s+2},n.prototype.writeUint16BE=n.prototype.writeUInt16BE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,2,65535,0),this[s]=r>>>8,this[s+1]=r&255,s+2},n.prototype.writeUint32LE=n.prototype.writeUInt32LE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,4,4294967295,0),this[s+3]=r>>>24,this[s+2]=r>>>16,this[s+1]=r>>>8,this[s]=r&255,s+4},n.prototype.writeUint32BE=n.prototype.writeUInt32BE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,4,4294967295,0),this[s]=r>>>24,this[s+1]=r>>>16,this[s+2]=r>>>8,this[s+3]=r&255,s+4},n.prototype.writeIntLE=function(r,s,f,D){if(r=+r,s=s>>>0,!D){var G=Math.pow(2,8*f-1);O(this,r,s,f,G-1,-G)}var z=0,se=1,ce=0;for(this[s]=r&255;++z<f&&(se*=256);)r<0&&ce===0&&this[s+z-1]!==0&&(ce=1),this[s+z]=(r/se>>0)-ce&255;return s+f},n.prototype.writeIntBE=function(r,s,f,D){if(r=+r,s=s>>>0,!D){var G=Math.pow(2,8*f-1);O(this,r,s,f,G-1,-G)}var z=f-1,se=1,ce=0;for(this[s+z]=r&255;--z>=0&&(se*=256);)r<0&&ce===0&&this[s+z+1]!==0&&(ce=1),this[s+z]=(r/se>>0)-ce&255;return s+f},n.prototype.writeInt8=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,1,127,-128),r<0&&(r=255+r+1),this[s]=r&255,s+1},n.prototype.writeInt16LE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,2,32767,-32768),this[s]=r&255,this[s+1]=r>>>8,s+2},n.prototype.writeInt16BE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,2,32767,-32768),this[s]=r>>>8,this[s+1]=r&255,s+2},n.prototype.writeInt32LE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,4,2147483647,-2147483648),this[s]=r&255,this[s+1]=r>>>8,this[s+2]=r>>>16,this[s+3]=r>>>24,s+4},n.prototype.writeInt32BE=function(r,s,f){return r=+r,s=s>>>0,f||O(this,r,s,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[s]=r>>>24,this[s+1]=r>>>16,this[s+2]=r>>>8,this[s+3]=r&255,s+4};function X(g,r,s,f,D,G){if(s+f>g.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function J(g,r,s,f,D){return r=+r,s=s>>>0,D||X(g,r,s,4),t.write(g,r,s,f,23,4),s+4}n.prototype.writeFloatLE=function(r,s,f){return J(this,r,s,!0,f)},n.prototype.writeFloatBE=function(r,s,f){return J(this,r,s,!1,f)};function ne(g,r,s,f,D){return r=+r,s=s>>>0,D||X(g,r,s,8),t.write(g,r,s,f,52,8),s+8}n.prototype.writeDoubleLE=function(r,s,f){return ne(this,r,s,!0,f)},n.prototype.writeDoubleBE=function(r,s,f){return ne(this,r,s,!1,f)},n.prototype.copy=function(r,s,f,D){if(!n.isBuffer(r))throw new TypeError("argument should be a Buffer");if(f||(f=0),!D&&D!==0&&(D=this.length),s>=r.length&&(s=r.length),s||(s=0),D>0&&D<f&&(D=f),D===f||r.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(D<0)throw new RangeError("sourceEnd out of bounds");D>this.length&&(D=this.length),r.length-s<D-f&&(D=r.length-s+f);var G=D-f;return this===r&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,f,D):Uint8Array.prototype.set.call(r,this.subarray(f,D),s),G},n.prototype.fill=function(r,s,f,D){if(typeof r=="string"){if(typeof s=="string"?(D=s,s=0,f=this.length):typeof f=="string"&&(D=f,f=this.length),D!==void 0&&typeof D!="string")throw new TypeError("encoding must be a string");if(typeof D=="string"&&!n.isEncoding(D))throw new TypeError("Unknown encoding: "+D);if(r.length===1){var G=r.charCodeAt(0);(D==="utf8"&&G<128||D==="latin1")&&(r=G)}}else typeof r=="number"?r=r&255:typeof r=="boolean"&&(r=Number(r));if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,r||(r=0);var z;if(typeof r=="number")for(z=s;z<f;++z)this[z]=r;else{var se=n.isBuffer(r)?r:n.from(r,D),ce=se.length;if(ce===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(z=0;z<f-s;++z)this[z+s]=se[z%ce]}return this};var $=/[^+/0-9A-Za-z-_]/g;function S(g){if(g=g.split("=")[0],g=g.trim().replace($,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function v(g,r){r=r||1/0;for(var s,f=g.length,D=null,G=[],z=0;z<f;++z){if(s=g.charCodeAt(z),s>55295&&s<57344){if(!D){if(s>56319){(r-=3)>-1&&G.push(239,191,189);continue}else if(z+1===f){(r-=3)>-1&&G.push(239,191,189);continue}D=s;continue}if(s<56320){(r-=3)>-1&&G.push(239,191,189),D=s;continue}s=(D-55296<<10|s-56320)+65536}else D&&(r-=3)>-1&&G.push(239,191,189);if(D=null,s<128){if((r-=1)<0)break;G.push(s)}else if(s<2048){if((r-=2)<0)break;G.push(s>>6|192,s&63|128)}else if(s<65536){if((r-=3)<0)break;G.push(s>>12|224,s>>6&63|128,s&63|128)}else if(s<1114112){if((r-=4)<0)break;G.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else throw new Error("Invalid code point")}return G}function K(g){for(var r=[],s=0;s<g.length;++s)r.push(g.charCodeAt(s)&255);return r}function L(g,r){for(var s,f,D,G=[],z=0;z<g.length&&!((r-=2)<0);++z)s=g.charCodeAt(z),f=s>>8,D=s%256,G.push(D),G.push(f);return G}function F(g){return e.toByteArray(S(g))}function B(g,r,s,f){for(var D=0;D<f&&!(D+s>=r.length||D>=g.length);++D)r[D+s]=g[D];return D}function Q(g,r){return g instanceof r||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===r.name}function p(g){return g!==g}var M=function(){for(var g="0123456789abcdef",r=new Array(256),s=0;s<16;++s)for(var f=s*16,D=0;D<16;++D)r[f+D]=g[s]+g[D];return r}()}(cr)),cr}var hr={},fr={},dr,Li;function Ga(){return Li||(Li=1,dr=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),a=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(a)!=="[object Symbol]")return!1;var h=42;e[t]=h;for(var l in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var d=Object.getOwnPropertySymbols(e);if(d.length!==1||d[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var n=Object.getOwnPropertyDescriptor(e,t);if(n.value!==h||n.enumerable!==!0)return!1}return!0}),dr}var pr,Mi;function fi(){if(Mi)return pr;Mi=1;var i=Ga();return pr=function(){return i()&&!!Symbol.toStringTag},pr}var mr,Ui;function Va(){return Ui||(Ui=1,mr=Object),mr}var gr,zi;function wl(){return zi||(zi=1,gr=Error),gr}var wr,Wi;function yl(){return Wi||(Wi=1,wr=EvalError),wr}var yr,Hi;function vl(){return Hi||(Hi=1,yr=RangeError),yr}var vr,qi;function bl(){return qi||(qi=1,vr=ReferenceError),vr}var br,Ki;function Xa(){return Ki||(Ki=1,br=SyntaxError),br}var xr,Gi;function Jt(){return Gi||(Gi=1,xr=TypeError),xr}var _r,Vi;function xl(){return Vi||(Vi=1,_r=URIError),_r}var Er,Xi;function _l(){return Xi||(Xi=1,Er=Math.abs),Er}var Sr,$i;function El(){return $i||($i=1,Sr=Math.floor),Sr}var Ar,Zi;function Sl(){return Zi||(Zi=1,Ar=Math.max),Ar}var Tr,Yi;function Al(){return Yi||(Yi=1,Tr=Math.min),Tr}var kr,Ji;function Tl(){return Ji||(Ji=1,kr=Math.pow),kr}var Rr,Qi;function kl(){return Qi||(Qi=1,Rr=Math.round),Rr}var Cr,es;function Rl(){return es||(es=1,Cr=Number.isNaN||function(e){return e!==e}),Cr}var Nr,ts;function Cl(){if(ts)return Nr;ts=1;var i=Rl();return Nr=function(t){return i(t)||t===0?t:t<0?-1:1},Nr}var Ir,rs;function Nl(){return rs||(rs=1,Ir=Object.getOwnPropertyDescriptor),Ir}var Fr,ns;function Nt(){if(ns)return Fr;ns=1;var i=Nl();if(i)try{i([],"length")}catch{i=null}return Fr=i,Fr}var Or,is;function Qt(){if(is)return Or;is=1;var i=Object.defineProperty||!1;if(i)try{i({},"a",{value:1})}catch{i=!1}return Or=i,Or}var Pr,ss;function Il(){if(ss)return Pr;ss=1;var i=typeof Symbol<"u"&&Symbol,e=Ga();return Pr=function(){return typeof i!="function"||typeof Symbol!="function"||typeof i("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Pr}var Br,as;function $a(){return as||(as=1,Br=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Br}var Dr,os;function Za(){if(os)return Dr;os=1;var i=Va();return Dr=i.getPrototypeOf||null,Dr}var jr,ls;function Fl(){if(ls)return jr;ls=1;var i="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,a="[object Function]",h=function(c,w){for(var _=[],k=0;k<c.length;k+=1)_[k]=c[k];for(var C=0;C<w.length;C+=1)_[C+c.length]=w[C];return _},l=function(c,w){for(var _=[],k=w,C=0;k<c.length;k+=1,C+=1)_[C]=c[k];return _},d=function(n,c){for(var w="",_=0;_<n.length;_+=1)w+=n[_],_+1<n.length&&(w+=c);return w};return jr=function(c){var w=this;if(typeof w!="function"||e.apply(w)!==a)throw new TypeError(i+w);for(var _=l(arguments,1),k,C=function(){if(this instanceof k){var o=w.apply(this,h(_,arguments));return Object(o)===o?o:this}return w.apply(c,h(_,arguments))},E=t(0,w.length-_.length),R=[],b=0;b<E;b++)R[b]="$"+b;if(k=Function("binder","return function ("+d(R,",")+"){ return binder.apply(this,arguments); }")(C),w.prototype){var T=function(){};T.prototype=w.prototype,k.prototype=new T,T.prototype=null}return k},jr}var Lr,us;function It(){if(us)return Lr;us=1;var i=Fl();return Lr=Function.prototype.bind||i,Lr}var Mr,cs;function di(){return cs||(cs=1,Mr=Function.prototype.call),Mr}var Ur,hs;function pi(){return hs||(hs=1,Ur=Function.prototype.apply),Ur}var zr,fs;function Ol(){return fs||(fs=1,zr=typeof Reflect<"u"&&Reflect&&Reflect.apply),zr}var Wr,ds;function Ya(){if(ds)return Wr;ds=1;var i=It(),e=pi(),t=di(),a=Ol();return Wr=a||i.call(t,e),Wr}var Hr,ps;function mi(){if(ps)return Hr;ps=1;var i=It(),e=Jt(),t=di(),a=Ya();return Hr=function(l){if(l.length<1||typeof l[0]!="function")throw new e("a function is required");return a(i,t,l)},Hr}var qr,ms;function Pl(){if(ms)return qr;ms=1;var i=mi(),e=Nt(),t;try{t=[].__proto__===Array.prototype}catch(d){if(!d||typeof d!="object"||!("code"in d)||d.code!=="ERR_PROTO_ACCESS")throw d}var a=!!t&&e&&e(Object.prototype,"__proto__"),h=Object,l=h.getPrototypeOf;return qr=a&&typeof a.get=="function"?i([a.get]):typeof l=="function"?function(n){return l(n==null?n:h(n))}:!1,qr}var Kr,gs;function Ja(){if(gs)return Kr;gs=1;var i=$a(),e=Za(),t=Pl();return Kr=i?function(h){return i(h)}:e?function(h){if(!h||typeof h!="object"&&typeof h!="function")throw new TypeError("getProto: not an object");return e(h)}:t?function(h){return t(h)}:null,Kr}var Gr,ws;function Bl(){if(ws)return Gr;ws=1;var i=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=It();return Gr=t.call(i,e),Gr}var Vr,ys;function Qa(){if(ys)return Vr;ys=1;var i,e=Va(),t=wl(),a=yl(),h=vl(),l=bl(),d=Xa(),n=Jt(),c=xl(),w=_l(),_=El(),k=Sl(),C=Al(),E=Tl(),R=kl(),b=Cl(),T=Function,o=function(K){try{return T('"use strict"; return ('+K+").constructor;")()}catch{}},y=Nt(),m=Qt(),u=function(){throw new n},A=y?function(){try{return arguments.callee,u}catch{try{return y(arguments,"callee").get}catch{return u}}}():u,P=Il()(),j=Ja(),q=Za(),N=$a(),Y=pi(),ue=di(),I={},U=typeof Uint8Array>"u"||!j?i:j(Uint8Array),x={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?i:ArrayBuffer,"%ArrayIteratorPrototype%":P&&j?j([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":I,"%AsyncGenerator%":I,"%AsyncGeneratorFunction%":I,"%AsyncIteratorPrototype%":I,"%Atomics%":typeof Atomics>"u"?i:Atomics,"%BigInt%":typeof BigInt>"u"?i:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?i:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":a,"%Float16Array%":typeof Float16Array>"u"?i:Float16Array,"%Float32Array%":typeof Float32Array>"u"?i:Float32Array,"%Float64Array%":typeof Float64Array>"u"?i:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?i:FinalizationRegistry,"%Function%":T,"%GeneratorFunction%":I,"%Int8Array%":typeof Int8Array>"u"?i:Int8Array,"%Int16Array%":typeof Int16Array>"u"?i:Int16Array,"%Int32Array%":typeof Int32Array>"u"?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":P&&j?j(j([][Symbol.iterator]())):i,"%JSON%":typeof JSON=="object"?JSON:i,"%Map%":typeof Map>"u"?i:Map,"%MapIteratorPrototype%":typeof Map>"u"||!P||!j?i:j(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":y,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?i:Promise,"%Proxy%":typeof Proxy>"u"?i:Proxy,"%RangeError%":h,"%ReferenceError%":l,"%Reflect%":typeof Reflect>"u"?i:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?i:Set,"%SetIteratorPrototype%":typeof Set>"u"||!P||!j?i:j(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":P&&j?j(""[Symbol.iterator]()):i,"%Symbol%":P?Symbol:i,"%SyntaxError%":d,"%ThrowTypeError%":A,"%TypedArray%":U,"%TypeError%":n,"%Uint8Array%":typeof Uint8Array>"u"?i:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?i:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?i:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?i:Uint32Array,"%URIError%":c,"%WeakMap%":typeof WeakMap>"u"?i:WeakMap,"%WeakRef%":typeof WeakRef>"u"?i:WeakRef,"%WeakSet%":typeof WeakSet>"u"?i:WeakSet,"%Function.prototype.call%":ue,"%Function.prototype.apply%":Y,"%Object.defineProperty%":m,"%Object.getPrototypeOf%":q,"%Math.abs%":w,"%Math.floor%":_,"%Math.max%":k,"%Math.min%":C,"%Math.pow%":E,"%Math.round%":R,"%Math.sign%":b,"%Reflect.getPrototypeOf%":N};if(j)try{null.error}catch(K){var Z=j(j(K));x["%Error.prototype%"]=Z}var re=function K(L){var F;if(L==="%AsyncFunction%")F=o("async function () {}");else if(L==="%GeneratorFunction%")F=o("function* () {}");else if(L==="%AsyncGeneratorFunction%")F=o("async function* () {}");else if(L==="%AsyncGenerator%"){var B=K("%AsyncGeneratorFunction%");B&&(F=B.prototype)}else if(L==="%AsyncIteratorPrototype%"){var Q=K("%AsyncGenerator%");Q&&j&&(F=j(Q.prototype))}return x[L]=F,F},H={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ie=It(),te=Bl(),ee=ie.call(ue,Array.prototype.concat),V=ie.call(Y,Array.prototype.splice),O=ie.call(ue,String.prototype.replace),X=ie.call(ue,String.prototype.slice),J=ie.call(ue,RegExp.prototype.exec),ne=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,$=/\\(\\)?/g,S=function(L){var F=X(L,0,1),B=X(L,-1);if(F==="%"&&B!=="%")throw new d("invalid intrinsic syntax, expected closing `%`");if(B==="%"&&F!=="%")throw new d("invalid intrinsic syntax, expected opening `%`");var Q=[];return O(L,ne,function(p,M,g,r){Q[Q.length]=g?O(r,$,"$1"):M||p}),Q},v=function(L,F){var B=L,Q;if(te(H,B)&&(Q=H[B],B="%"+Q[0]+"%"),te(x,B)){var p=x[B];if(p===I&&(p=re(B)),typeof p>"u"&&!F)throw new n("intrinsic "+L+" exists, but is not available. Please file an issue!");return{alias:Q,name:B,value:p}}throw new d("intrinsic "+L+" does not exist!")};return Vr=function(L,F){if(typeof L!="string"||L.length===0)throw new n("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof F!="boolean")throw new n('"allowMissing" argument must be a boolean');if(J(/^%?[^%]*%?$/,L)===null)throw new d("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var B=S(L),Q=B.length>0?B[0]:"",p=v("%"+Q+"%",F),M=p.name,g=p.value,r=!1,s=p.alias;s&&(Q=s[0],V(B,ee([0,1],s)));for(var f=1,D=!0;f<B.length;f+=1){var G=B[f],z=X(G,0,1),se=X(G,-1);if((z==='"'||z==="'"||z==="`"||se==='"'||se==="'"||se==="`")&&z!==se)throw new d("property names with quotes must have matching quotes");if((G==="constructor"||!D)&&(r=!0),Q+="."+G,M="%"+Q+"%",te(x,M))g=x[M];else if(g!=null){if(!(G in g)){if(!F)throw new n("base intrinsic for "+L+" exists, but the property is not available.");return}if(y&&f+1>=B.length){var ce=y(g,G);D=!!ce,D&&"get"in ce&&!("originalValue"in ce.get)?g=ce.get:g=g[G]}else D=te(g,G),g=g[G];D&&!r&&(x[M]=g)}}return g},Vr}var Xr,vs;function eo(){if(vs)return Xr;vs=1;var i=Qa(),e=mi(),t=e([i("%String.prototype.indexOf%")]);return Xr=function(h,l){var d=i(h,!!l);return typeof d=="function"&&t(h,".prototype.")>-1?e([d]):d},Xr}var $r,bs;function Dl(){if(bs)return $r;bs=1;var i=fi()(),e=eo(),t=e("Object.prototype.toString"),a=function(n){return i&&n&&typeof n=="object"&&Symbol.toStringTag in n?!1:t(n)==="[object Arguments]"},h=function(n){return a(n)?!0:n!==null&&typeof n=="object"&&"length"in n&&typeof n.length=="number"&&n.length>=0&&t(n)!=="[object Array]"&&"callee"in n&&t(n.callee)==="[object Function]"},l=function(){return a(arguments)}();return a.isLegacyArguments=h,$r=l?a:h,$r}var Zr,xs;function jl(){if(xs)return Zr;xs=1;var i=Object.prototype.toString,e=Function.prototype.toString,t=/^\s*(?:function)?\*/,a=fi()(),h=Object.getPrototypeOf,l=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch{}},d;return Zr=function(c){if(typeof c!="function")return!1;if(t.test(e.call(c)))return!0;if(!a){var w=i.call(c);return w==="[object GeneratorFunction]"}if(!h)return!1;if(typeof d>"u"){var _=l();d=_?h(_):!1}return h(c)===d},Zr}var Yr,_s;function Ll(){if(_s)return Yr;_s=1;var i=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,a;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw a}}),a={},e(function(){throw 42},null,t)}catch(y){y!==a&&(e=null)}else e=null;var h=/^\s*class\b/,l=function(m){try{var u=i.call(m);return h.test(u)}catch{return!1}},d=function(m){try{return l(m)?!1:(i.call(m),!0)}catch{return!1}},n=Object.prototype.toString,c="[object Object]",w="[object Function]",_="[object GeneratorFunction]",k="[object HTMLAllCollection]",C="[object HTML document.all class]",E="[object HTMLCollection]",R=typeof Symbol=="function"&&!!Symbol.toStringTag,b=!(0 in[,]),T=function(){return!1};if(typeof document=="object"){var o=document.all;n.call(o)===n.call(document.all)&&(T=function(m){if((b||!m)&&(typeof m>"u"||typeof m=="object"))try{var u=n.call(m);return(u===k||u===C||u===E||u===c)&&m("")==null}catch{}return!1})}return Yr=e?function(m){if(T(m))return!0;if(!m||typeof m!="function"&&typeof m!="object")return!1;try{e(m,null,t)}catch(u){if(u!==a)return!1}return!l(m)&&d(m)}:function(m){if(T(m))return!0;if(!m||typeof m!="function"&&typeof m!="object")return!1;if(R)return d(m);if(l(m))return!1;var u=n.call(m);return u!==w&&u!==_&&!/^\[object HTML/.test(u)?!1:d(m)},Yr}var Jr,Es;function Ml(){if(Es)return Jr;Es=1;var i=Ll(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,a=function(c,w,_){for(var k=0,C=c.length;k<C;k++)t.call(c,k)&&(_==null?w(c[k],k,c):w.call(_,c[k],k,c))},h=function(c,w,_){for(var k=0,C=c.length;k<C;k++)_==null?w(c.charAt(k),k,c):w.call(_,c.charAt(k),k,c)},l=function(c,w,_){for(var k in c)t.call(c,k)&&(_==null?w(c[k],k,c):w.call(_,c[k],k,c))};function d(n){return e.call(n)==="[object Array]"}return Jr=function(c,w,_){if(!i(w))throw new TypeError("iterator must be a function");var k;arguments.length>=3&&(k=_),d(c)?a(c,w,k):typeof c=="string"?h(c,w,k):l(c,w,k)},Jr}var Qr,Ss;function Ul(){return Ss||(Ss=1,Qr=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Qr}var en,As;function zl(){if(As)return en;As=1;var i=Ul(),e=typeof globalThis>"u"?Ie:globalThis;return en=function(){for(var a=[],h=0;h<i.length;h++)typeof e[i[h]]=="function"&&(a[a.length]=i[h]);return a},en}var tn={exports:{}},rn,Ts;function Wl(){if(Ts)return rn;Ts=1;var i=Qt(),e=Xa(),t=Jt(),a=Nt();return rn=function(l,d,n){if(!l||typeof l!="object"&&typeof l!="function")throw new t("`obj` must be an object or a function`");if(typeof d!="string"&&typeof d!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var c=arguments.length>3?arguments[3]:null,w=arguments.length>4?arguments[4]:null,_=arguments.length>5?arguments[5]:null,k=arguments.length>6?arguments[6]:!1,C=!!a&&a(l,d);if(i)i(l,d,{configurable:_===null&&C?C.configurable:!_,enumerable:c===null&&C?C.enumerable:!c,value:n,writable:w===null&&C?C.writable:!w});else if(k||!c&&!w&&!_)l[d]=n;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},rn}var nn,ks;function Hl(){if(ks)return nn;ks=1;var i=Qt(),e=function(){return!!i};return e.hasArrayLengthDefineBug=function(){if(!i)return null;try{return i([],"length",{value:1}).length!==1}catch{return!0}},nn=e,nn}var sn,Rs;function ql(){if(Rs)return sn;Rs=1;var i=Qa(),e=Wl(),t=Hl()(),a=Nt(),h=Jt(),l=i("%Math.floor%");return sn=function(n,c){if(typeof n!="function")throw new h("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||l(c)!==c)throw new h("`length` must be a positive 32-bit integer");var w=arguments.length>2&&!!arguments[2],_=!0,k=!0;if("length"in n&&a){var C=a(n,"length");C&&!C.configurable&&(_=!1),C&&!C.writable&&(k=!1)}return(_||k||!w)&&(t?e(n,"length",c,!0,!0):e(n,"length",c)),n},sn}var an,Cs;function Kl(){if(Cs)return an;Cs=1;var i=It(),e=pi(),t=Ya();return an=function(){return t(i,e,arguments)},an}var Ns;function Gl(){return Ns||(Ns=1,function(i){var e=ql(),t=Qt(),a=mi(),h=Kl();i.exports=function(d){var n=a(arguments),c=d.length-(arguments.length-1);return e(n,1+(c>0?c:0),!0)},t?t(i.exports,"apply",{value:h}):i.exports.apply=h}(tn)),tn.exports}var on,Is;function to(){if(Is)return on;Is=1;var i=Ml(),e=zl(),t=Gl(),a=eo(),h=Nt(),l=Ja(),d=a("Object.prototype.toString"),n=fi()(),c=typeof globalThis>"u"?Ie:globalThis,w=e(),_=a("String.prototype.slice"),k=a("Array.prototype.indexOf",!0)||function(T,o){for(var y=0;y<T.length;y+=1)if(T[y]===o)return y;return-1},C={__proto__:null};n&&h&&l?i(w,function(b){var T=new c[b];if(Symbol.toStringTag in T&&l){var o=l(T),y=h(o,Symbol.toStringTag);if(!y&&o){var m=l(o);y=h(m,Symbol.toStringTag)}C["$"+b]=t(y.get)}}):i(w,function(b){var T=new c[b],o=T.slice||T.set;o&&(C["$"+b]=t(o))});var E=function(T){var o=!1;return i(C,function(y,m){if(!o)try{"$"+y(T)===m&&(o=_(m,1))}catch{}}),o},R=function(T){var o=!1;return i(C,function(y,m){if(!o)try{y(T),o=_(m,1)}catch{}}),o};return on=function(T){if(!T||typeof T!="object")return!1;if(!n){var o=_(d(T),8,-1);return k(w,o)>-1?o:o!=="Object"?!1:R(T)}return h?E(T):null},on}var ln,Fs;function Vl(){if(Fs)return ln;Fs=1;var i=to();return ln=function(t){return!!i(t)},ln}var Os;function Xl(){return Os||(Os=1,function(i){var e=Dl(),t=jl(),a=to(),h=Vl();function l(f){return f.call.bind(f)}var d=typeof BigInt<"u",n=typeof Symbol<"u",c=l(Object.prototype.toString),w=l(Number.prototype.valueOf),_=l(String.prototype.valueOf),k=l(Boolean.prototype.valueOf);if(d)var C=l(BigInt.prototype.valueOf);if(n)var E=l(Symbol.prototype.valueOf);function R(f,D){if(typeof f!="object")return!1;try{return D(f),!0}catch{return!1}}i.isArgumentsObject=e,i.isGeneratorFunction=t,i.isTypedArray=h;function b(f){return typeof Promise<"u"&&f instanceof Promise||f!==null&&typeof f=="object"&&typeof f.then=="function"&&typeof f.catch=="function"}i.isPromise=b;function T(f){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(f):h(f)||X(f)}i.isArrayBufferView=T;function o(f){return a(f)==="Uint8Array"}i.isUint8Array=o;function y(f){return a(f)==="Uint8ClampedArray"}i.isUint8ClampedArray=y;function m(f){return a(f)==="Uint16Array"}i.isUint16Array=m;function u(f){return a(f)==="Uint32Array"}i.isUint32Array=u;function A(f){return a(f)==="Int8Array"}i.isInt8Array=A;function P(f){return a(f)==="Int16Array"}i.isInt16Array=P;function j(f){return a(f)==="Int32Array"}i.isInt32Array=j;function q(f){return a(f)==="Float32Array"}i.isFloat32Array=q;function N(f){return a(f)==="Float64Array"}i.isFloat64Array=N;function Y(f){return a(f)==="BigInt64Array"}i.isBigInt64Array=Y;function ue(f){return a(f)==="BigUint64Array"}i.isBigUint64Array=ue;function I(f){return c(f)==="[object Map]"}I.working=typeof Map<"u"&&I(new Map);function U(f){return typeof Map>"u"?!1:I.working?I(f):f instanceof Map}i.isMap=U;function x(f){return c(f)==="[object Set]"}x.working=typeof Set<"u"&&x(new Set);function Z(f){return typeof Set>"u"?!1:x.working?x(f):f instanceof Set}i.isSet=Z;function re(f){return c(f)==="[object WeakMap]"}re.working=typeof WeakMap<"u"&&re(new WeakMap);function H(f){return typeof WeakMap>"u"?!1:re.working?re(f):f instanceof WeakMap}i.isWeakMap=H;function ie(f){return c(f)==="[object WeakSet]"}ie.working=typeof WeakSet<"u"&&ie(new WeakSet);function te(f){return ie(f)}i.isWeakSet=te;function ee(f){return c(f)==="[object ArrayBuffer]"}ee.working=typeof ArrayBuffer<"u"&&ee(new ArrayBuffer);function V(f){return typeof ArrayBuffer>"u"?!1:ee.working?ee(f):f instanceof ArrayBuffer}i.isArrayBuffer=V;function O(f){return c(f)==="[object DataView]"}O.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&O(new DataView(new ArrayBuffer(1),0,1));function X(f){return typeof DataView>"u"?!1:O.working?O(f):f instanceof DataView}i.isDataView=X;var J=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ne(f){return c(f)==="[object SharedArrayBuffer]"}function $(f){return typeof J>"u"?!1:(typeof ne.working>"u"&&(ne.working=ne(new J)),ne.working?ne(f):f instanceof J)}i.isSharedArrayBuffer=$;function S(f){return c(f)==="[object AsyncFunction]"}i.isAsyncFunction=S;function v(f){return c(f)==="[object Map Iterator]"}i.isMapIterator=v;function K(f){return c(f)==="[object Set Iterator]"}i.isSetIterator=K;function L(f){return c(f)==="[object Generator]"}i.isGeneratorObject=L;function F(f){return c(f)==="[object WebAssembly.Module]"}i.isWebAssemblyCompiledModule=F;function B(f){return R(f,w)}i.isNumberObject=B;function Q(f){return R(f,_)}i.isStringObject=Q;function p(f){return R(f,k)}i.isBooleanObject=p;function M(f){return d&&R(f,C)}i.isBigIntObject=M;function g(f){return n&&R(f,E)}i.isSymbolObject=g;function r(f){return B(f)||Q(f)||p(f)||M(f)||g(f)}i.isBoxedPrimitive=r;function s(f){return typeof Uint8Array<"u"&&(V(f)||$(f))}i.isAnyArrayBuffer=s,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(f){Object.defineProperty(i,f,{enumerable:!1,value:function(){throw new Error(f+" is not supported in userland")}})})}(fr)),fr}var un,Ps;function $l(){return Ps||(Ps=1,un=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),un}var Bs;function ro(){return Bs||(Bs=1,function(i){var e=Object.getOwnPropertyDescriptors||function(X){for(var J=Object.keys(X),ne={},$=0;$<J.length;$++)ne[J[$]]=Object.getOwnPropertyDescriptor(X,J[$]);return ne},t=/%[sdj%]/g;i.format=function(O){if(!A(O)){for(var X=[],J=0;J<arguments.length;J++)X.push(d(arguments[J]));return X.join(" ")}for(var J=1,ne=arguments,$=ne.length,S=String(O).replace(t,function(K){if(K==="%%")return"%";if(J>=$)return K;switch(K){case"%s":return String(ne[J++]);case"%d":return Number(ne[J++]);case"%j":try{return JSON.stringify(ne[J++])}catch{return"[Circular]"}default:return K}}),v=ne[J];J<$;v=ne[++J])y(v)||!N(v)?S+=" "+v:S+=" "+d(v);return S},i.deprecate=function(O,X){if(typeof ge<"u"&&ge.noDeprecation===!0)return O;if(typeof ge>"u")return function(){return i.deprecate(O,X).apply(this,arguments)};var J=!1;function ne(){if(!J){if(ge.throwDeprecation)throw new Error(X);ge.traceDeprecation?console.trace(X):console.error(X),J=!0}return O.apply(this,arguments)}return ne};var a={},h=/^$/;if(ge.env.NODE_DEBUG){var l=ge.env.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),h=new RegExp("^"+l+"$","i")}i.debuglog=function(O){if(O=O.toUpperCase(),!a[O])if(h.test(O)){var X=ge.pid;a[O]=function(){var J=i.format.apply(i,arguments);console.error("%s %d: %s",O,X,J)}}else a[O]=function(){};return a[O]};function d(O,X){var J={seen:[],stylize:c};return arguments.length>=3&&(J.depth=arguments[2]),arguments.length>=4&&(J.colors=arguments[3]),o(X)?J.showHidden=X:X&&i._extend(J,X),j(J.showHidden)&&(J.showHidden=!1),j(J.depth)&&(J.depth=2),j(J.colors)&&(J.colors=!1),j(J.customInspect)&&(J.customInspect=!0),J.colors&&(J.stylize=n),_(J,O,J.depth)}i.inspect=d,d.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},d.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(O,X){var J=d.styles[X];return J?"\x1B["+d.colors[J][0]+"m"+O+"\x1B["+d.colors[J][1]+"m":O}function c(O,X){return O}function w(O){var X={};return O.forEach(function(J,ne){X[J]=!0}),X}function _(O,X,J){if(O.customInspect&&X&&I(X.inspect)&&X.inspect!==i.inspect&&!(X.constructor&&X.constructor.prototype===X)){var ne=X.inspect(J,O);return A(ne)||(ne=_(O,ne,J)),ne}var $=k(O,X);if($)return $;var S=Object.keys(X),v=w(S);if(O.showHidden&&(S=Object.getOwnPropertyNames(X)),ue(X)&&(S.indexOf("message")>=0||S.indexOf("description")>=0))return C(X);if(S.length===0){if(I(X)){var K=X.name?": "+X.name:"";return O.stylize("[Function"+K+"]","special")}if(q(X))return O.stylize(RegExp.prototype.toString.call(X),"regexp");if(Y(X))return O.stylize(Date.prototype.toString.call(X),"date");if(ue(X))return C(X)}var L="",F=!1,B=["{","}"];if(T(X)&&(F=!0,B=["[","]"]),I(X)){var Q=X.name?": "+X.name:"";L=" [Function"+Q+"]"}if(q(X)&&(L=" "+RegExp.prototype.toString.call(X)),Y(X)&&(L=" "+Date.prototype.toUTCString.call(X)),ue(X)&&(L=" "+C(X)),S.length===0&&(!F||X.length==0))return B[0]+L+B[1];if(J<0)return q(X)?O.stylize(RegExp.prototype.toString.call(X),"regexp"):O.stylize("[Object]","special");O.seen.push(X);var p;return F?p=E(O,X,J,v,S):p=S.map(function(M){return R(O,X,J,v,M,F)}),O.seen.pop(),b(p,L,B)}function k(O,X){if(j(X))return O.stylize("undefined","undefined");if(A(X)){var J="'"+JSON.stringify(X).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return O.stylize(J,"string")}if(u(X))return O.stylize(""+X,"number");if(o(X))return O.stylize(""+X,"boolean");if(y(X))return O.stylize("null","null")}function C(O){return"["+Error.prototype.toString.call(O)+"]"}function E(O,X,J,ne,$){for(var S=[],v=0,K=X.length;v<K;++v)ie(X,String(v))?S.push(R(O,X,J,ne,String(v),!0)):S.push("");return $.forEach(function(L){L.match(/^\d+$/)||S.push(R(O,X,J,ne,L,!0))}),S}function R(O,X,J,ne,$,S){var v,K,L;if(L=Object.getOwnPropertyDescriptor(X,$)||{value:X[$]},L.get?L.set?K=O.stylize("[Getter/Setter]","special"):K=O.stylize("[Getter]","special"):L.set&&(K=O.stylize("[Setter]","special")),ie(ne,$)||(v="["+$+"]"),K||(O.seen.indexOf(L.value)<0?(y(J)?K=_(O,L.value,null):K=_(O,L.value,J-1),K.indexOf(`
`)>-1&&(S?K=K.split(`
`).map(function(F){return"  "+F}).join(`
`).slice(2):K=`
`+K.split(`
`).map(function(F){return"   "+F}).join(`
`))):K=O.stylize("[Circular]","special")),j(v)){if(S&&$.match(/^\d+$/))return K;v=JSON.stringify(""+$),v.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(v=v.slice(1,-1),v=O.stylize(v,"name")):(v=v.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),v=O.stylize(v,"string"))}return v+": "+K}function b(O,X,J){var ne=O.reduce(function($,S){return S.indexOf(`
`)>=0,$+S.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ne>60?J[0]+(X===""?"":X+`
 `)+" "+O.join(`,
  `)+" "+J[1]:J[0]+X+" "+O.join(", ")+" "+J[1]}i.types=Xl();function T(O){return Array.isArray(O)}i.isArray=T;function o(O){return typeof O=="boolean"}i.isBoolean=o;function y(O){return O===null}i.isNull=y;function m(O){return O==null}i.isNullOrUndefined=m;function u(O){return typeof O=="number"}i.isNumber=u;function A(O){return typeof O=="string"}i.isString=A;function P(O){return typeof O=="symbol"}i.isSymbol=P;function j(O){return O===void 0}i.isUndefined=j;function q(O){return N(O)&&x(O)==="[object RegExp]"}i.isRegExp=q,i.types.isRegExp=q;function N(O){return typeof O=="object"&&O!==null}i.isObject=N;function Y(O){return N(O)&&x(O)==="[object Date]"}i.isDate=Y,i.types.isDate=Y;function ue(O){return N(O)&&(x(O)==="[object Error]"||O instanceof Error)}i.isError=ue,i.types.isNativeError=ue;function I(O){return typeof O=="function"}i.isFunction=I;function U(O){return O===null||typeof O=="boolean"||typeof O=="number"||typeof O=="string"||typeof O=="symbol"||typeof O>"u"}i.isPrimitive=U,i.isBuffer=$l();function x(O){return Object.prototype.toString.call(O)}function Z(O){return O<10?"0"+O.toString(10):O.toString(10)}var re=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function H(){var O=new Date,X=[Z(O.getHours()),Z(O.getMinutes()),Z(O.getSeconds())].join(":");return[O.getDate(),re[O.getMonth()],X].join(" ")}i.log=function(){console.log("%s - %s",H(),i.format.apply(i,arguments))},i.inherits=Ze(),i._extend=function(O,X){if(!X||!N(X))return O;for(var J=Object.keys(X),ne=J.length;ne--;)O[J[ne]]=X[J[ne]];return O};function ie(O,X){return Object.prototype.hasOwnProperty.call(O,X)}var te=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;i.promisify=function(X){if(typeof X!="function")throw new TypeError('The "original" argument must be of type Function');if(te&&X[te]){var J=X[te];if(typeof J!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(J,te,{value:J,enumerable:!1,writable:!1,configurable:!0}),J}function J(){for(var ne,$,S=new Promise(function(L,F){ne=L,$=F}),v=[],K=0;K<arguments.length;K++)v.push(arguments[K]);v.push(function(L,F){L?$(L):ne(F)});try{X.apply(this,v)}catch(L){$(L)}return S}return Object.setPrototypeOf(J,Object.getPrototypeOf(X)),te&&Object.defineProperty(J,te,{value:J,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(J,e(X))},i.promisify.custom=te;function ee(O,X){if(!O){var J=new Error("Promise was rejected with a falsy value");J.reason=O,O=J}return X(O)}function V(O){if(typeof O!="function")throw new TypeError('The "original" argument must be of type Function');function X(){for(var J=[],ne=0;ne<arguments.length;ne++)J.push(arguments[ne]);var $=J.pop();if(typeof $!="function")throw new TypeError("The last argument must be of type Function");var S=this,v=function(){return $.apply(S,arguments)};O.apply(this,J).then(function(K){ge.nextTick(v.bind(null,null,K))},function(K){ge.nextTick(ee.bind(null,K,v))})}return Object.setPrototypeOf(X,Object.getPrototypeOf(O)),Object.defineProperties(X,e(O)),X}i.callbackify=V}(hr)),hr}var cn,Ds;function Zl(){if(Ds)return cn;Ds=1;function i(R,b){var T=Object.keys(R);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(R);b&&(o=o.filter(function(y){return Object.getOwnPropertyDescriptor(R,y).enumerable})),T.push.apply(T,o)}return T}function e(R){for(var b=1;b<arguments.length;b++){var T=arguments[b]!=null?arguments[b]:{};b%2?i(Object(T),!0).forEach(function(o){t(R,o,T[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(T)):i(Object(T)).forEach(function(o){Object.defineProperty(R,o,Object.getOwnPropertyDescriptor(T,o))})}return R}function t(R,b,T){return b=d(b),b in R?Object.defineProperty(R,b,{value:T,enumerable:!0,configurable:!0,writable:!0}):R[b]=T,R}function a(R,b){if(!(R instanceof b))throw new TypeError("Cannot call a class as a function")}function h(R,b){for(var T=0;T<b.length;T++){var o=b[T];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(R,d(o.key),o)}}function l(R,b,T){return b&&h(R.prototype,b),Object.defineProperty(R,"prototype",{writable:!1}),R}function d(R){var b=n(R,"string");return typeof b=="symbol"?b:String(b)}function n(R,b){if(typeof R!="object"||R===null)return R;var T=R[Symbol.toPrimitive];if(T!==void 0){var o=T.call(R,b);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(R)}var c=Yt(),w=c.Buffer,_=ro(),k=_.inspect,C=k&&k.custom||"inspect";function E(R,b,T){w.prototype.copy.call(R,b,T)}return cn=function(){function R(){a(this,R),this.head=null,this.tail=null,this.length=0}return l(R,[{key:"push",value:function(T){var o={data:T,next:null};this.length>0?this.tail.next=o:this.head=o,this.tail=o,++this.length}},{key:"unshift",value:function(T){var o={data:T,next:this.head};this.length===0&&(this.tail=o),this.head=o,++this.length}},{key:"shift",value:function(){if(this.length!==0){var T=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,T}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(T){if(this.length===0)return"";for(var o=this.head,y=""+o.data;o=o.next;)y+=T+o.data;return y}},{key:"concat",value:function(T){if(this.length===0)return w.alloc(0);for(var o=w.allocUnsafe(T>>>0),y=this.head,m=0;y;)E(y.data,o,m),m+=y.data.length,y=y.next;return o}},{key:"consume",value:function(T,o){var y;return T<this.head.data.length?(y=this.head.data.slice(0,T),this.head.data=this.head.data.slice(T)):T===this.head.data.length?y=this.shift():y=o?this._getString(T):this._getBuffer(T),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(T){var o=this.head,y=1,m=o.data;for(T-=m.length;o=o.next;){var u=o.data,A=T>u.length?u.length:T;if(A===u.length?m+=u:m+=u.slice(0,T),T-=A,T===0){A===u.length?(++y,o.next?this.head=o.next:this.head=this.tail=null):(this.head=o,o.data=u.slice(A));break}++y}return this.length-=y,m}},{key:"_getBuffer",value:function(T){var o=w.allocUnsafe(T),y=this.head,m=1;for(y.data.copy(o),T-=y.data.length;y=y.next;){var u=y.data,A=T>u.length?u.length:T;if(u.copy(o,o.length-T,0,A),T-=A,T===0){A===u.length?(++m,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=u.slice(A));break}++m}return this.length-=m,o}},{key:C,value:function(T,o){return k(this,e(e({},o),{},{depth:0,customInspect:!1}))}}]),R}(),cn}var hn,js;function no(){if(js)return hn;js=1;function i(d,n){var c=this,w=this._readableState&&this._readableState.destroyed,_=this._writableState&&this._writableState.destroyed;return w||_?(n?n(d):d&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,ge.nextTick(h,this,d)):ge.nextTick(h,this,d)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(d||null,function(k){!n&&k?c._writableState?c._writableState.errorEmitted?ge.nextTick(t,c):(c._writableState.errorEmitted=!0,ge.nextTick(e,c,k)):ge.nextTick(e,c,k):n?(ge.nextTick(t,c),n(k)):ge.nextTick(t,c)}),this)}function e(d,n){h(d,n),t(d)}function t(d){d._writableState&&!d._writableState.emitClose||d._readableState&&!d._readableState.emitClose||d.emit("close")}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function h(d,n){d.emit("error",n)}function l(d,n){var c=d._readableState,w=d._writableState;c&&c.autoDestroy||w&&w.autoDestroy?d.destroy(n):d.emit("error",n)}return hn={destroy:i,undestroy:a,errorOrDestroy:l},hn}var fn={},Ls;function bt(){if(Ls)return fn;Ls=1;function i(n,c){n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.__proto__=c}var e={};function t(n,c,w){w||(w=Error);function _(C,E,R){return typeof c=="string"?c:c(C,E,R)}var k=function(C){i(E,C);function E(R,b,T){return C.call(this,_(R,b,T))||this}return E}(w);k.prototype.name=w.name,k.prototype.code=n,e[n]=k}function a(n,c){if(Array.isArray(n)){var w=n.length;return n=n.map(function(_){return String(_)}),w>2?"one of ".concat(c," ").concat(n.slice(0,w-1).join(", "),", or ")+n[w-1]:w===2?"one of ".concat(c," ").concat(n[0]," or ").concat(n[1]):"of ".concat(c," ").concat(n[0])}else return"of ".concat(c," ").concat(String(n))}function h(n,c,w){return n.substr(0,c.length)===c}function l(n,c,w){return(w===void 0||w>n.length)&&(w=n.length),n.substring(w-c.length,w)===c}function d(n,c,w){return typeof w!="number"&&(w=0),w+c.length>n.length?!1:n.indexOf(c,w)!==-1}return t("ERR_INVALID_OPT_VALUE",function(n,c){return'The value "'+c+'" is invalid for option "'+n+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(n,c,w){var _;typeof c=="string"&&h(c,"not ")?(_="must not be",c=c.replace(/^not /,"")):_="must be";var k;if(l(n," argument"))k="The ".concat(n," ").concat(_," ").concat(a(c,"type"));else{var C=d(n,".")?"property":"argument";k='The "'.concat(n,'" ').concat(C," ").concat(_," ").concat(a(c,"type"))}return k+=". Received type ".concat(typeof w),k},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(n){return"The "+n+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(n){return"Cannot call "+n+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(n){return"Unknown encoding: "+n},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),fn.codes=e,fn}var dn,Ms;function io(){if(Ms)return dn;Ms=1;var i=bt().codes.ERR_INVALID_OPT_VALUE;function e(a,h,l){return a.highWaterMark!=null?a.highWaterMark:h?a[l]:null}function t(a,h,l,d){var n=e(h,d,l);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var c=d?l:"highWaterMark";throw new i(c,n)}return Math.floor(n)}return a.objectMode?16:16*1024}return dn={getHighWaterMark:t},dn}var pn,Us;function Yl(){if(Us)return pn;Us=1,pn=i;function i(t,a){if(e("noDeprecation"))return t;var h=!1;function l(){if(!h){if(e("throwDeprecation"))throw new Error(a);e("traceDeprecation")?console.trace(a):console.warn(a),h=!0}return t.apply(this,arguments)}return l}function e(t){try{if(!Ie.localStorage)return!1}catch{return!1}var a=Ie.localStorage[t];return a==null?!1:String(a).toLowerCase()==="true"}return pn}var mn,zs;function so(){if(zs)return mn;zs=1,mn=q;function i($){var S=this;this.next=null,this.entry=null,this.finish=function(){ne(S,$)}}var e;q.WritableState=P;var t={deprecate:Yl()},a=Ka(),h=Yt().Buffer,l=(typeof Ie<"u"?Ie:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function d($){return h.from($)}function n($){return h.isBuffer($)||$ instanceof l}var c=no(),w=io(),_=w.getHighWaterMark,k=bt().codes,C=k.ERR_INVALID_ARG_TYPE,E=k.ERR_METHOD_NOT_IMPLEMENTED,R=k.ERR_MULTIPLE_CALLBACK,b=k.ERR_STREAM_CANNOT_PIPE,T=k.ERR_STREAM_DESTROYED,o=k.ERR_STREAM_NULL_VALUES,y=k.ERR_STREAM_WRITE_AFTER_END,m=k.ERR_UNKNOWN_ENCODING,u=c.errorOrDestroy;Ze()(q,a);function A(){}function P($,S,v){e=e||mt(),$=$||{},typeof v!="boolean"&&(v=S instanceof e),this.objectMode=!!$.objectMode,v&&(this.objectMode=this.objectMode||!!$.writableObjectMode),this.highWaterMark=_(this,$,"writableHighWaterMark",v),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var K=$.decodeStrings===!1;this.decodeStrings=!K,this.defaultEncoding=$.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(L){re(S,L)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=$.emitClose!==!1,this.autoDestroy=!!$.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}P.prototype.getBuffer=function(){for(var S=this.bufferedRequest,v=[];S;)v.push(S),S=S.next;return v},function(){try{Object.defineProperty(P.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var j;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(j=Function.prototype[Symbol.hasInstance],Object.defineProperty(q,Symbol.hasInstance,{value:function(S){return j.call(this,S)?!0:this!==q?!1:S&&S._writableState instanceof P}})):j=function(S){return S instanceof this};function q($){e=e||mt();var S=this instanceof e;if(!S&&!j.call(q,this))return new q($);this._writableState=new P($,this,S),this.writable=!0,$&&(typeof $.write=="function"&&(this._write=$.write),typeof $.writev=="function"&&(this._writev=$.writev),typeof $.destroy=="function"&&(this._destroy=$.destroy),typeof $.final=="function"&&(this._final=$.final)),a.call(this)}q.prototype.pipe=function(){u(this,new b)};function N($,S){var v=new y;u($,v),ge.nextTick(S,v)}function Y($,S,v,K){var L;return v===null?L=new o:typeof v!="string"&&!S.objectMode&&(L=new C("chunk",["string","Buffer"],v)),L?(u($,L),ge.nextTick(K,L),!1):!0}q.prototype.write=function($,S,v){var K=this._writableState,L=!1,F=!K.objectMode&&n($);return F&&!h.isBuffer($)&&($=d($)),typeof S=="function"&&(v=S,S=null),F?S="buffer":S||(S=K.defaultEncoding),typeof v!="function"&&(v=A),K.ending?N(this,v):(F||Y(this,K,$,v))&&(K.pendingcb++,L=I(this,K,F,$,S,v)),L},q.prototype.cork=function(){this._writableState.corked++},q.prototype.uncork=function(){var $=this._writableState;$.corked&&($.corked--,!$.writing&&!$.corked&&!$.bufferProcessing&&$.bufferedRequest&&te(this,$))},q.prototype.setDefaultEncoding=function(S){if(typeof S=="string"&&(S=S.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((S+"").toLowerCase())>-1))throw new m(S);return this._writableState.defaultEncoding=S,this},Object.defineProperty(q.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ue($,S,v){return!$.objectMode&&$.decodeStrings!==!1&&typeof S=="string"&&(S=h.from(S,v)),S}Object.defineProperty(q.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function I($,S,v,K,L,F){if(!v){var B=ue(S,K,L);K!==B&&(v=!0,L="buffer",K=B)}var Q=S.objectMode?1:K.length;S.length+=Q;var p=S.length<S.highWaterMark;if(p||(S.needDrain=!0),S.writing||S.corked){var M=S.lastBufferedRequest;S.lastBufferedRequest={chunk:K,encoding:L,isBuf:v,callback:F,next:null},M?M.next=S.lastBufferedRequest:S.bufferedRequest=S.lastBufferedRequest,S.bufferedRequestCount+=1}else U($,S,!1,Q,K,L,F);return p}function U($,S,v,K,L,F,B){S.writelen=K,S.writecb=B,S.writing=!0,S.sync=!0,S.destroyed?S.onwrite(new T("write")):v?$._writev(L,S.onwrite):$._write(L,F,S.onwrite),S.sync=!1}function x($,S,v,K,L){--S.pendingcb,v?(ge.nextTick(L,K),ge.nextTick(X,$,S),$._writableState.errorEmitted=!0,u($,K)):(L(K),$._writableState.errorEmitted=!0,u($,K),X($,S))}function Z($){$.writing=!1,$.writecb=null,$.length-=$.writelen,$.writelen=0}function re($,S){var v=$._writableState,K=v.sync,L=v.writecb;if(typeof L!="function")throw new R;if(Z(v),S)x($,v,K,S,L);else{var F=ee(v)||$.destroyed;!F&&!v.corked&&!v.bufferProcessing&&v.bufferedRequest&&te($,v),K?ge.nextTick(H,$,v,F,L):H($,v,F,L)}}function H($,S,v,K){v||ie($,S),S.pendingcb--,K(),X($,S)}function ie($,S){S.length===0&&S.needDrain&&(S.needDrain=!1,$.emit("drain"))}function te($,S){S.bufferProcessing=!0;var v=S.bufferedRequest;if($._writev&&v&&v.next){var K=S.bufferedRequestCount,L=new Array(K),F=S.corkedRequestsFree;F.entry=v;for(var B=0,Q=!0;v;)L[B]=v,v.isBuf||(Q=!1),v=v.next,B+=1;L.allBuffers=Q,U($,S,!0,S.length,L,"",F.finish),S.pendingcb++,S.lastBufferedRequest=null,F.next?(S.corkedRequestsFree=F.next,F.next=null):S.corkedRequestsFree=new i(S),S.bufferedRequestCount=0}else{for(;v;){var p=v.chunk,M=v.encoding,g=v.callback,r=S.objectMode?1:p.length;if(U($,S,!1,r,p,M,g),v=v.next,S.bufferedRequestCount--,S.writing)break}v===null&&(S.lastBufferedRequest=null)}S.bufferedRequest=v,S.bufferProcessing=!1}q.prototype._write=function($,S,v){v(new E("_write()"))},q.prototype._writev=null,q.prototype.end=function($,S,v){var K=this._writableState;return typeof $=="function"?(v=$,$=null,S=null):typeof S=="function"&&(v=S,S=null),$!=null&&this.write($,S),K.corked&&(K.corked=1,this.uncork()),K.ending||J(this,K,v),this},Object.defineProperty(q.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ee($){return $.ending&&$.length===0&&$.bufferedRequest===null&&!$.finished&&!$.writing}function V($,S){$._final(function(v){S.pendingcb--,v&&u($,v),S.prefinished=!0,$.emit("prefinish"),X($,S)})}function O($,S){!S.prefinished&&!S.finalCalled&&(typeof $._final=="function"&&!S.destroyed?(S.pendingcb++,S.finalCalled=!0,ge.nextTick(V,$,S)):(S.prefinished=!0,$.emit("prefinish")))}function X($,S){var v=ee(S);if(v&&(O($,S),S.pendingcb===0&&(S.finished=!0,$.emit("finish"),S.autoDestroy))){var K=$._readableState;(!K||K.autoDestroy&&K.endEmitted)&&$.destroy()}return v}function J($,S,v){S.ending=!0,X($,S),v&&(S.finished?ge.nextTick(v):$.once("finish",v)),S.ended=!0,$.writable=!1}function ne($,S,v){var K=$.entry;for($.entry=null;K;){var L=K.callback;S.pendingcb--,L(v),K=K.next}S.corkedRequestsFree.next=$}return Object.defineProperty(q.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(S){this._writableState&&(this._writableState.destroyed=S)}}),q.prototype.destroy=c.destroy,q.prototype._undestroy=c.undestroy,q.prototype._destroy=function($,S){S($)},mn}var gn,Ws;function mt(){if(Ws)return gn;Ws=1;var i=Object.keys||function(w){var _=[];for(var k in w)_.push(k);return _};gn=d;var e=ao(),t=so();Ze()(d,e);for(var a=i(t.prototype),h=0;h<a.length;h++){var l=a[h];d.prototype[l]||(d.prototype[l]=t.prototype[l])}function d(w){if(!(this instanceof d))return new d(w);e.call(this,w),t.call(this,w),this.allowHalfOpen=!0,w&&(w.readable===!1&&(this.readable=!1),w.writable===!1&&(this.writable=!1),w.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",n)))}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function n(){this._writableState.ended||ge.nextTick(c,this)}function c(w){w.end()}return Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(_){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=_,this._writableState.destroyed=_)}}),gn}var wn={},zt={exports:{}},Hs;function Jl(){return Hs||(Hs=1,function(i,e){var t=Yt(),a=t.Buffer;function h(d,n){for(var c in d)n[c]=d[c]}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?i.exports=t:(h(t,e),e.Buffer=l);function l(d,n,c){return a(d,n,c)}h(a,l),l.from=function(d,n,c){if(typeof d=="number")throw new TypeError("Argument must not be a number");return a(d,n,c)},l.alloc=function(d,n,c){if(typeof d!="number")throw new TypeError("Argument must be a number");var w=a(d);return n!==void 0?typeof c=="string"?w.fill(n,c):w.fill(n):w.fill(0),w},l.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return a(d)},l.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(d)}}(zt,zt.exports)),zt.exports}var qs;function ai(){if(qs)return wn;qs=1;var i=Jl().Buffer,e=i.isEncoding||function(o){switch(o=""+o,o&&o.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(o){if(!o)return"utf8";for(var y;;)switch(o){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return o;default:if(y)return;o=(""+o).toLowerCase(),y=!0}}function a(o){var y=t(o);if(typeof y!="string"&&(i.isEncoding===e||!e(o)))throw new Error("Unknown encoding: "+o);return y||o}wn.StringDecoder=h;function h(o){this.encoding=a(o);var y;switch(this.encoding){case"utf16le":this.text=k,this.end=C,y=4;break;case"utf8":this.fillLast=c,y=4;break;case"base64":this.text=E,this.end=R,y=3;break;default:this.write=b,this.end=T;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(y)}h.prototype.write=function(o){if(o.length===0)return"";var y,m;if(this.lastNeed){if(y=this.fillLast(o),y===void 0)return"";m=this.lastNeed,this.lastNeed=0}else m=0;return m<o.length?y?y+this.text(o,m):this.text(o,m):y||""},h.prototype.end=_,h.prototype.text=w,h.prototype.fillLast=function(o){if(this.lastNeed<=o.length)return o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,o.length),this.lastNeed-=o.length};function l(o){return o<=127?0:o>>5===6?2:o>>4===14?3:o>>3===30?4:o>>6===2?-1:-2}function d(o,y,m){var u=y.length-1;if(u<m)return 0;var A=l(y[u]);return A>=0?(A>0&&(o.lastNeed=A-1),A):--u<m||A===-2?0:(A=l(y[u]),A>=0?(A>0&&(o.lastNeed=A-2),A):--u<m||A===-2?0:(A=l(y[u]),A>=0?(A>0&&(A===2?A=0:o.lastNeed=A-3),A):0))}function n(o,y,m){if((y[0]&192)!==128)return o.lastNeed=0,"�";if(o.lastNeed>1&&y.length>1){if((y[1]&192)!==128)return o.lastNeed=1,"�";if(o.lastNeed>2&&y.length>2&&(y[2]&192)!==128)return o.lastNeed=2,"�"}}function c(o){var y=this.lastTotal-this.lastNeed,m=n(this,o);if(m!==void 0)return m;if(this.lastNeed<=o.length)return o.copy(this.lastChar,y,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);o.copy(this.lastChar,y,0,o.length),this.lastNeed-=o.length}function w(o,y){var m=d(this,o,y);if(!this.lastNeed)return o.toString("utf8",y);this.lastTotal=m;var u=o.length-(m-this.lastNeed);return o.copy(this.lastChar,0,u),o.toString("utf8",y,u)}function _(o){var y=o&&o.length?this.write(o):"";return this.lastNeed?y+"�":y}function k(o,y){if((o.length-y)%2===0){var m=o.toString("utf16le",y);if(m){var u=m.charCodeAt(m.length-1);if(u>=55296&&u<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1],m.slice(0,-1)}return m}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=o[o.length-1],o.toString("utf16le",y,o.length-1)}function C(o){var y=o&&o.length?this.write(o):"";if(this.lastNeed){var m=this.lastTotal-this.lastNeed;return y+this.lastChar.toString("utf16le",0,m)}return y}function E(o,y){var m=(o.length-y)%3;return m===0?o.toString("base64",y):(this.lastNeed=3-m,this.lastTotal=3,m===1?this.lastChar[0]=o[o.length-1]:(this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1]),o.toString("base64",y,o.length-m))}function R(o){var y=o&&o.length?this.write(o):"";return this.lastNeed?y+this.lastChar.toString("base64",0,3-this.lastNeed):y}function b(o){return o.toString(this.encoding)}function T(o){return o&&o.length?this.write(o):""}return wn}var yn,Ks;function gi(){if(Ks)return yn;Ks=1;var i=bt().codes.ERR_STREAM_PREMATURE_CLOSE;function e(l){var d=!1;return function(){if(!d){d=!0;for(var n=arguments.length,c=new Array(n),w=0;w<n;w++)c[w]=arguments[w];l.apply(this,c)}}}function t(){}function a(l){return l.setHeader&&typeof l.abort=="function"}function h(l,d,n){if(typeof d=="function")return h(l,null,d);d||(d={}),n=e(n||t);var c=d.readable||d.readable!==!1&&l.readable,w=d.writable||d.writable!==!1&&l.writable,_=function(){l.writable||C()},k=l._writableState&&l._writableState.finished,C=function(){w=!1,k=!0,c||n.call(l)},E=l._readableState&&l._readableState.endEmitted,R=function(){c=!1,E=!0,w||n.call(l)},b=function(m){n.call(l,m)},T=function(){var m;if(c&&!E)return(!l._readableState||!l._readableState.ended)&&(m=new i),n.call(l,m);if(w&&!k)return(!l._writableState||!l._writableState.ended)&&(m=new i),n.call(l,m)},o=function(){l.req.on("finish",C)};return a(l)?(l.on("complete",C),l.on("abort",T),l.req?o():l.on("request",o)):w&&!l._writableState&&(l.on("end",_),l.on("close",_)),l.on("end",R),l.on("finish",C),d.error!==!1&&l.on("error",b),l.on("close",T),function(){l.removeListener("complete",C),l.removeListener("abort",T),l.removeListener("request",o),l.req&&l.req.removeListener("finish",C),l.removeListener("end",_),l.removeListener("close",_),l.removeListener("finish",C),l.removeListener("end",R),l.removeListener("error",b),l.removeListener("close",T)}}return yn=h,yn}var vn,Gs;function Ql(){if(Gs)return vn;Gs=1;var i;function e(m,u,A){return u=t(u),u in m?Object.defineProperty(m,u,{value:A,enumerable:!0,configurable:!0,writable:!0}):m[u]=A,m}function t(m){var u=a(m,"string");return typeof u=="symbol"?u:String(u)}function a(m,u){if(typeof m!="object"||m===null)return m;var A=m[Symbol.toPrimitive];if(A!==void 0){var P=A.call(m,u);if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(m)}var h=gi(),l=Symbol("lastResolve"),d=Symbol("lastReject"),n=Symbol("error"),c=Symbol("ended"),w=Symbol("lastPromise"),_=Symbol("handlePromise"),k=Symbol("stream");function C(m,u){return{value:m,done:u}}function E(m){var u=m[l];if(u!==null){var A=m[k].read();A!==null&&(m[w]=null,m[l]=null,m[d]=null,u(C(A,!1)))}}function R(m){ge.nextTick(E,m)}function b(m,u){return function(A,P){m.then(function(){if(u[c]){A(C(void 0,!0));return}u[_](A,P)},P)}}var T=Object.getPrototypeOf(function(){}),o=Object.setPrototypeOf((i={get stream(){return this[k]},next:function(){var u=this,A=this[n];if(A!==null)return Promise.reject(A);if(this[c])return Promise.resolve(C(void 0,!0));if(this[k].destroyed)return new Promise(function(N,Y){ge.nextTick(function(){u[n]?Y(u[n]):N(C(void 0,!0))})});var P=this[w],j;if(P)j=new Promise(b(P,this));else{var q=this[k].read();if(q!==null)return Promise.resolve(C(q,!1));j=new Promise(this[_])}return this[w]=j,j}},e(i,Symbol.asyncIterator,function(){return this}),e(i,"return",function(){var u=this;return new Promise(function(A,P){u[k].destroy(null,function(j){if(j){P(j);return}A(C(void 0,!0))})})}),i),T),y=function(u){var A,P=Object.create(o,(A={},e(A,k,{value:u,writable:!0}),e(A,l,{value:null,writable:!0}),e(A,d,{value:null,writable:!0}),e(A,n,{value:null,writable:!0}),e(A,c,{value:u._readableState.endEmitted,writable:!0}),e(A,_,{value:function(q,N){var Y=P[k].read();Y?(P[w]=null,P[l]=null,P[d]=null,q(C(Y,!1))):(P[l]=q,P[d]=N)},writable:!0}),A));return P[w]=null,h(u,function(j){if(j&&j.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=P[d];q!==null&&(P[w]=null,P[l]=null,P[d]=null,q(j)),P[n]=j;return}var N=P[l];N!==null&&(P[w]=null,P[l]=null,P[d]=null,N(C(void 0,!0))),P[c]=!0}),u.on("readable",R.bind(null,P)),P};return vn=y,vn}var bn,Vs;function eu(){return Vs||(Vs=1,bn=function(){throw new Error("Readable.from is not available in the browser")}),bn}var xn,Xs;function ao(){if(Xs)return xn;Xs=1,xn=N;var i;N.ReadableState=q,hi().EventEmitter;var e=function(B,Q){return B.listeners(Q).length},t=Ka(),a=Yt().Buffer,h=(typeof Ie<"u"?Ie:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function l(F){return a.from(F)}function d(F){return a.isBuffer(F)||F instanceof h}var n=ro(),c;n&&n.debuglog?c=n.debuglog("stream"):c=function(){};var w=Zl(),_=no(),k=io(),C=k.getHighWaterMark,E=bt().codes,R=E.ERR_INVALID_ARG_TYPE,b=E.ERR_STREAM_PUSH_AFTER_EOF,T=E.ERR_METHOD_NOT_IMPLEMENTED,o=E.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,y,m,u;Ze()(N,t);var A=_.errorOrDestroy,P=["error","close","destroy","pause","resume"];function j(F,B,Q){if(typeof F.prependListener=="function")return F.prependListener(B,Q);!F._events||!F._events[B]?F.on(B,Q):Array.isArray(F._events[B])?F._events[B].unshift(Q):F._events[B]=[Q,F._events[B]]}function q(F,B,Q){i=i||mt(),F=F||{},typeof Q!="boolean"&&(Q=B instanceof i),this.objectMode=!!F.objectMode,Q&&(this.objectMode=this.objectMode||!!F.readableObjectMode),this.highWaterMark=C(this,F,"readableHighWaterMark",Q),this.buffer=new w,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=F.emitClose!==!1,this.autoDestroy=!!F.autoDestroy,this.destroyed=!1,this.defaultEncoding=F.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,F.encoding&&(y||(y=ai().StringDecoder),this.decoder=new y(F.encoding),this.encoding=F.encoding)}function N(F){if(i=i||mt(),!(this instanceof N))return new N(F);var B=this instanceof i;this._readableState=new q(F,this,B),this.readable=!0,F&&(typeof F.read=="function"&&(this._read=F.read),typeof F.destroy=="function"&&(this._destroy=F.destroy)),t.call(this)}Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),N.prototype.destroy=_.destroy,N.prototype._undestroy=_.undestroy,N.prototype._destroy=function(F,B){B(F)},N.prototype.push=function(F,B){var Q=this._readableState,p;return Q.objectMode?p=!0:typeof F=="string"&&(B=B||Q.defaultEncoding,B!==Q.encoding&&(F=a.from(F,B),B=""),p=!0),Y(this,F,B,!1,p)},N.prototype.unshift=function(F){return Y(this,F,null,!0,!1)};function Y(F,B,Q,p,M){c("readableAddChunk",B);var g=F._readableState;if(B===null)g.reading=!1,re(F,g);else{var r;if(M||(r=I(g,B)),r)A(F,r);else if(g.objectMode||B&&B.length>0)if(typeof B!="string"&&!g.objectMode&&Object.getPrototypeOf(B)!==a.prototype&&(B=l(B)),p)g.endEmitted?A(F,new o):ue(F,g,B,!0);else if(g.ended)A(F,new b);else{if(g.destroyed)return!1;g.reading=!1,g.decoder&&!Q?(B=g.decoder.write(B),g.objectMode||B.length!==0?ue(F,g,B,!1):te(F,g)):ue(F,g,B,!1)}else p||(g.reading=!1,te(F,g))}return!g.ended&&(g.length<g.highWaterMark||g.length===0)}function ue(F,B,Q,p){B.flowing&&B.length===0&&!B.sync?(B.awaitDrain=0,F.emit("data",Q)):(B.length+=B.objectMode?1:Q.length,p?B.buffer.unshift(Q):B.buffer.push(Q),B.needReadable&&H(F)),te(F,B)}function I(F,B){var Q;return!d(B)&&typeof B!="string"&&B!==void 0&&!F.objectMode&&(Q=new R("chunk",["string","Buffer","Uint8Array"],B)),Q}N.prototype.isPaused=function(){return this._readableState.flowing===!1},N.prototype.setEncoding=function(F){y||(y=ai().StringDecoder);var B=new y(F);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var Q=this._readableState.buffer.head,p="";Q!==null;)p+=B.write(Q.data),Q=Q.next;return this._readableState.buffer.clear(),p!==""&&this._readableState.buffer.push(p),this._readableState.length=p.length,this};var U=1073741824;function x(F){return F>=U?F=U:(F--,F|=F>>>1,F|=F>>>2,F|=F>>>4,F|=F>>>8,F|=F>>>16,F++),F}function Z(F,B){return F<=0||B.length===0&&B.ended?0:B.objectMode?1:F!==F?B.flowing&&B.length?B.buffer.head.data.length:B.length:(F>B.highWaterMark&&(B.highWaterMark=x(F)),F<=B.length?F:B.ended?B.length:(B.needReadable=!0,0))}N.prototype.read=function(F){c("read",F),F=parseInt(F,10);var B=this._readableState,Q=F;if(F!==0&&(B.emittedReadable=!1),F===0&&B.needReadable&&((B.highWaterMark!==0?B.length>=B.highWaterMark:B.length>0)||B.ended))return c("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?v(this):H(this),null;if(F=Z(F,B),F===0&&B.ended)return B.length===0&&v(this),null;var p=B.needReadable;c("need readable",p),(B.length===0||B.length-F<B.highWaterMark)&&(p=!0,c("length less than watermark",p)),B.ended||B.reading?(p=!1,c("reading or ended",p)):p&&(c("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(F=Z(Q,B)));var M;return F>0?M=S(F,B):M=null,M===null?(B.needReadable=B.length<=B.highWaterMark,F=0):(B.length-=F,B.awaitDrain=0),B.length===0&&(B.ended||(B.needReadable=!0),Q!==F&&B.ended&&v(this)),M!==null&&this.emit("data",M),M};function re(F,B){if(c("onEofChunk"),!B.ended){if(B.decoder){var Q=B.decoder.end();Q&&Q.length&&(B.buffer.push(Q),B.length+=B.objectMode?1:Q.length)}B.ended=!0,B.sync?H(F):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,ie(F)))}}function H(F){var B=F._readableState;c("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(c("emitReadable",B.flowing),B.emittedReadable=!0,ge.nextTick(ie,F))}function ie(F){var B=F._readableState;c("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(F.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,$(F)}function te(F,B){B.readingMore||(B.readingMore=!0,ge.nextTick(ee,F,B))}function ee(F,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&B.length===0);){var Q=B.length;if(c("maybeReadMore read 0"),F.read(0),Q===B.length)break}B.readingMore=!1}N.prototype._read=function(F){A(this,new T("_read()"))},N.prototype.pipe=function(F,B){var Q=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=F;break;case 1:p.pipes=[p.pipes,F];break;default:p.pipes.push(F);break}p.pipesCount+=1,c("pipe count=%d opts=%j",p.pipesCount,B);var M=(!B||B.end!==!1)&&F!==ge.stdout&&F!==ge.stderr,g=M?s:fe;p.endEmitted?ge.nextTick(g):Q.once("end",g),F.on("unpipe",r);function r(de,me){c("onunpipe"),de===Q&&me&&me.hasUnpiped===!1&&(me.hasUnpiped=!0,G())}function s(){c("onend"),F.end()}var f=V(Q);F.on("drain",f);var D=!1;function G(){c("cleanup"),F.removeListener("close",ce),F.removeListener("finish",oe),F.removeListener("drain",f),F.removeListener("error",se),F.removeListener("unpipe",r),Q.removeListener("end",s),Q.removeListener("end",fe),Q.removeListener("data",z),D=!0,p.awaitDrain&&(!F._writableState||F._writableState.needDrain)&&f()}Q.on("data",z);function z(de){c("ondata");var me=F.write(de);c("dest.write",me),me===!1&&((p.pipesCount===1&&p.pipes===F||p.pipesCount>1&&L(p.pipes,F)!==-1)&&!D&&(c("false write response, pause",p.awaitDrain),p.awaitDrain++),Q.pause())}function se(de){c("onerror",de),fe(),F.removeListener("error",se),e(F,"error")===0&&A(F,de)}j(F,"error",se);function ce(){F.removeListener("finish",oe),fe()}F.once("close",ce);function oe(){c("onfinish"),F.removeListener("close",ce),fe()}F.once("finish",oe);function fe(){c("unpipe"),Q.unpipe(F)}return F.emit("pipe",Q),p.flowing||(c("pipe resume"),Q.resume()),F};function V(F){return function(){var Q=F._readableState;c("pipeOnDrain",Q.awaitDrain),Q.awaitDrain&&Q.awaitDrain--,Q.awaitDrain===0&&e(F,"data")&&(Q.flowing=!0,$(F))}}N.prototype.unpipe=function(F){var B=this._readableState,Q={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return F&&F!==B.pipes?this:(F||(F=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,F&&F.emit("unpipe",this,Q),this);if(!F){var p=B.pipes,M=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var g=0;g<M;g++)p[g].emit("unpipe",this,{hasUnpiped:!1});return this}var r=L(B.pipes,F);return r===-1?this:(B.pipes.splice(r,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),F.emit("unpipe",this,Q),this)},N.prototype.on=function(F,B){var Q=t.prototype.on.call(this,F,B),p=this._readableState;return F==="data"?(p.readableListening=this.listenerCount("readable")>0,p.flowing!==!1&&this.resume()):F==="readable"&&!p.endEmitted&&!p.readableListening&&(p.readableListening=p.needReadable=!0,p.flowing=!1,p.emittedReadable=!1,c("on readable",p.length,p.reading),p.length?H(this):p.reading||ge.nextTick(X,this)),Q},N.prototype.addListener=N.prototype.on,N.prototype.removeListener=function(F,B){var Q=t.prototype.removeListener.call(this,F,B);return F==="readable"&&ge.nextTick(O,this),Q},N.prototype.removeAllListeners=function(F){var B=t.prototype.removeAllListeners.apply(this,arguments);return(F==="readable"||F===void 0)&&ge.nextTick(O,this),B};function O(F){var B=F._readableState;B.readableListening=F.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:F.listenerCount("data")>0&&F.resume()}function X(F){c("readable nexttick read 0"),F.read(0)}N.prototype.resume=function(){var F=this._readableState;return F.flowing||(c("resume"),F.flowing=!F.readableListening,J(this,F)),F.paused=!1,this};function J(F,B){B.resumeScheduled||(B.resumeScheduled=!0,ge.nextTick(ne,F,B))}function ne(F,B){c("resume",B.reading),B.reading||F.read(0),B.resumeScheduled=!1,F.emit("resume"),$(F),B.flowing&&!B.reading&&F.read(0)}N.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function $(F){var B=F._readableState;for(c("flow",B.flowing);B.flowing&&F.read()!==null;);}N.prototype.wrap=function(F){var B=this,Q=this._readableState,p=!1;F.on("end",function(){if(c("wrapped end"),Q.decoder&&!Q.ended){var r=Q.decoder.end();r&&r.length&&B.push(r)}B.push(null)}),F.on("data",function(r){if(c("wrapped data"),Q.decoder&&(r=Q.decoder.write(r)),!(Q.objectMode&&r==null)&&!(!Q.objectMode&&(!r||!r.length))){var s=B.push(r);s||(p=!0,F.pause())}});for(var M in F)this[M]===void 0&&typeof F[M]=="function"&&(this[M]=function(s){return function(){return F[s].apply(F,arguments)}}(M));for(var g=0;g<P.length;g++)F.on(P[g],this.emit.bind(this,P[g]));return this._read=function(r){c("wrapped _read",r),p&&(p=!1,F.resume())},this},typeof Symbol=="function"&&(N.prototype[Symbol.asyncIterator]=function(){return m===void 0&&(m=Ql()),m(this)}),Object.defineProperty(N.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(N.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(N.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),N._fromList=S,Object.defineProperty(N.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function S(F,B){if(B.length===0)return null;var Q;return B.objectMode?Q=B.buffer.shift():!F||F>=B.length?(B.decoder?Q=B.buffer.join(""):B.buffer.length===1?Q=B.buffer.first():Q=B.buffer.concat(B.length),B.buffer.clear()):Q=B.buffer.consume(F,B.decoder),Q}function v(F){var B=F._readableState;c("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,ge.nextTick(K,B,F))}function K(F,B){if(c("endReadableNT",F.endEmitted,F.length),!F.endEmitted&&F.length===0&&(F.endEmitted=!0,B.readable=!1,B.emit("end"),F.autoDestroy)){var Q=B._writableState;(!Q||Q.autoDestroy&&Q.finished)&&B.destroy()}}typeof Symbol=="function"&&(N.from=function(F,B){return u===void 0&&(u=eu()),u(N,F,B)});function L(F,B){for(var Q=0,p=F.length;Q<p;Q++)if(F[Q]===B)return Q;return-1}return xn}var _n,$s;function oo(){if($s)return _n;$s=1,_n=n;var i=bt().codes,e=i.ERR_METHOD_NOT_IMPLEMENTED,t=i.ERR_MULTIPLE_CALLBACK,a=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,h=i.ERR_TRANSFORM_WITH_LENGTH_0,l=mt();Ze()(n,l);function d(_,k){var C=this._transformState;C.transforming=!1;var E=C.writecb;if(E===null)return this.emit("error",new t);C.writechunk=null,C.writecb=null,k!=null&&this.push(k),E(_);var R=this._readableState;R.reading=!1,(R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}function n(_){if(!(this instanceof n))return new n(_);l.call(this,_),this._transformState={afterTransform:d.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,_&&(typeof _.transform=="function"&&(this._transform=_.transform),typeof _.flush=="function"&&(this._flush=_.flush)),this.on("prefinish",c)}function c(){var _=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(k,C){w(_,k,C)}):w(this,null,null)}n.prototype.push=function(_,k){return this._transformState.needTransform=!1,l.prototype.push.call(this,_,k)},n.prototype._transform=function(_,k,C){C(new e("_transform()"))},n.prototype._write=function(_,k,C){var E=this._transformState;if(E.writecb=C,E.writechunk=_,E.writeencoding=k,!E.transforming){var R=this._readableState;(E.needTransform||R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}},n.prototype._read=function(_){var k=this._transformState;k.writechunk!==null&&!k.transforming?(k.transforming=!0,this._transform(k.writechunk,k.writeencoding,k.afterTransform)):k.needTransform=!0},n.prototype._destroy=function(_,k){l.prototype._destroy.call(this,_,function(C){k(C)})};function w(_,k,C){if(k)return _.emit("error",k);if(C!=null&&_.push(C),_._writableState.length)throw new h;if(_._transformState.transforming)throw new a;return _.push(null)}return _n}var En,Zs;function tu(){if(Zs)return En;Zs=1,En=e;var i=oo();Ze()(e,i);function e(t){if(!(this instanceof e))return new e(t);i.call(this,t)}return e.prototype._transform=function(t,a,h){h(null,t)},En}var Sn,Ys;function ru(){if(Ys)return Sn;Ys=1;var i;function e(C){var E=!1;return function(){E||(E=!0,C.apply(void 0,arguments))}}var t=bt().codes,a=t.ERR_MISSING_ARGS,h=t.ERR_STREAM_DESTROYED;function l(C){if(C)throw C}function d(C){return C.setHeader&&typeof C.abort=="function"}function n(C,E,R,b){b=e(b);var T=!1;C.on("close",function(){T=!0}),i===void 0&&(i=gi()),i(C,{readable:E,writable:R},function(y){if(y)return b(y);T=!0,b()});var o=!1;return function(y){if(!T&&!o){if(o=!0,d(C))return C.abort();if(typeof C.destroy=="function")return C.destroy();b(y||new h("pipe"))}}}function c(C){C()}function w(C,E){return C.pipe(E)}function _(C){return!C.length||typeof C[C.length-1]!="function"?l:C.pop()}function k(){for(var C=arguments.length,E=new Array(C),R=0;R<C;R++)E[R]=arguments[R];var b=_(E);if(Array.isArray(E[0])&&(E=E[0]),E.length<2)throw new a("streams");var T,o=E.map(function(y,m){var u=m<E.length-1,A=m>0;return n(y,u,A,function(P){T||(T=P),P&&o.forEach(c),!u&&(o.forEach(c),b(T))})});return E.reduce(w)}return Sn=k,Sn}var An,Js;function wi(){if(Js)return An;Js=1,An=t;var i=hi().EventEmitter,e=Ze();e(t,i),t.Readable=ao(),t.Writable=so(),t.Duplex=mt(),t.Transform=oo(),t.PassThrough=tu(),t.finished=gi(),t.pipeline=ru(),t.Stream=t;function t(){i.call(this)}return t.prototype.pipe=function(a,h){var l=this;function d(E){a.writable&&a.write(E)===!1&&l.pause&&l.pause()}l.on("data",d);function n(){l.readable&&l.resume&&l.resume()}a.on("drain",n),!a._isStdio&&(!h||h.end!==!1)&&(l.on("end",w),l.on("close",_));var c=!1;function w(){c||(c=!0,a.end())}function _(){c||(c=!0,typeof a.destroy=="function"&&a.destroy())}function k(E){if(C(),i.listenerCount(this,"error")===0)throw E}l.on("error",k),a.on("error",k);function C(){l.removeListener("data",d),a.removeListener("drain",n),l.removeListener("end",w),l.removeListener("close",_),l.removeListener("error",k),a.removeListener("error",k),l.removeListener("end",C),l.removeListener("close",C),a.removeListener("close",C)}return l.on("end",C),l.on("close",C),a.on("close",C),a.emit("pipe",l),a},An}var Qs;function nu(){return Qs||(Qs=1,function(i){(function(e){e.parser=function(S,v){return new a(S,v)},e.SAXParser=a,e.SAXStream=_,e.createStream=w,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function a(S,v){if(!(this instanceof a))return new a(S,v);var K=this;l(K),K.q=K.c="",K.bufferCheckPosition=e.MAX_BUFFER_LENGTH,K.opt=v||{},K.opt.lowercase=K.opt.lowercase||K.opt.lowercasetags,K.looseCase=K.opt.lowercase?"toLowerCase":"toUpperCase",K.tags=[],K.closed=K.closedRoot=K.sawRoot=!1,K.tag=K.error=null,K.strict=!!S,K.noscript=!!(S||K.opt.noscript),K.state=N.BEGIN,K.strictEntities=K.opt.strictEntities,K.ENTITIES=K.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),K.attribList=[],K.opt.xmlns&&(K.ns=Object.create(b)),K.trackPosition=K.opt.position!==!1,K.trackPosition&&(K.position=K.line=K.column=0),ue(K,"onready")}Object.create||(Object.create=function(S){function v(){}v.prototype=S;var K=new v;return K}),Object.keys||(Object.keys=function(S){var v=[];for(var K in S)S.hasOwnProperty(K)&&v.push(K);return v});function h(S){for(var v=Math.max(e.MAX_BUFFER_LENGTH,10),K=0,L=0,F=t.length;L<F;L++){var B=S[t[L]].length;if(B>v)switch(t[L]){case"textNode":U(S);break;case"cdata":I(S,"oncdata",S.cdata),S.cdata="";break;case"script":I(S,"onscript",S.script),S.script="";break;default:Z(S,"Max buffer length exceeded: "+t[L])}K=Math.max(K,B)}var Q=e.MAX_BUFFER_LENGTH-K;S.bufferCheckPosition=Q+S.position}function l(S){for(var v=0,K=t.length;v<K;v++)S[t[v]]=""}function d(S){U(S),S.cdata!==""&&(I(S,"oncdata",S.cdata),S.cdata=""),S.script!==""&&(I(S,"onscript",S.script),S.script="")}a.prototype={end:function(){re(this)},write:$,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){d(this)}};var n;try{n=wi().Stream}catch{n=function(){}}var c=e.EVENTS.filter(function(S){return S!=="error"&&S!=="end"});function w(S,v){return new _(S,v)}function _(S,v){if(!(this instanceof _))return new _(S,v);n.apply(this),this._parser=new a(S,v),this.writable=!0,this.readable=!0;var K=this;this._parser.onend=function(){K.emit("end")},this._parser.onerror=function(L){K.emit("error",L),K._parser.error=null},this._decoder=null,c.forEach(function(L){Object.defineProperty(K,"on"+L,{get:function(){return K._parser["on"+L]},set:function(F){if(!F)return K.removeAllListeners(L),K._parser["on"+L]=F,F;K.on(L,F)},enumerable:!0,configurable:!1})})}_.prototype=Object.create(n.prototype,{constructor:{value:_}}),_.prototype.write=function(S){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(S)){if(!this._decoder){var v=ai().StringDecoder;this._decoder=new v("utf8")}S=this._decoder.write(S)}return this._parser.write(S.toString()),this.emit("data",S),!0},_.prototype.end=function(S){return S&&S.length&&this.write(S),this._parser.end(),!0},_.prototype.on=function(S,v){var K=this;return!K._parser["on"+S]&&c.indexOf(S)!==-1&&(K._parser["on"+S]=function(){var L=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);L.splice(0,0,S),K.emit.apply(K,L)}),n.prototype.on.call(K,S,v)};var k="[CDATA[",C="DOCTYPE",E="http://www.w3.org/XML/1998/namespace",R="http://www.w3.org/2000/xmlns/",b={xml:E,xmlns:R},T=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,o=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function u(S){return S===" "||S===`
`||S==="\r"||S==="	"}function A(S){return S==='"'||S==="'"}function P(S){return S===">"||u(S)}function j(S,v){return S.test(v)}function q(S,v){return!j(S,v)}var N=0;e.STATE={BEGIN:N++,BEGIN_WHITESPACE:N++,TEXT:N++,TEXT_ENTITY:N++,OPEN_WAKA:N++,SGML_DECL:N++,SGML_DECL_QUOTED:N++,DOCTYPE:N++,DOCTYPE_QUOTED:N++,DOCTYPE_DTD:N++,DOCTYPE_DTD_QUOTED:N++,COMMENT_STARTING:N++,COMMENT:N++,COMMENT_ENDING:N++,COMMENT_ENDED:N++,CDATA:N++,CDATA_ENDING:N++,CDATA_ENDING_2:N++,PROC_INST:N++,PROC_INST_BODY:N++,PROC_INST_ENDING:N++,OPEN_TAG:N++,OPEN_TAG_SLASH:N++,ATTRIB:N++,ATTRIB_NAME:N++,ATTRIB_NAME_SAW_WHITE:N++,ATTRIB_VALUE:N++,ATTRIB_VALUE_QUOTED:N++,ATTRIB_VALUE_CLOSED:N++,ATTRIB_VALUE_UNQUOTED:N++,ATTRIB_VALUE_ENTITY_Q:N++,ATTRIB_VALUE_ENTITY_U:N++,CLOSE_TAG:N++,CLOSE_TAG_SAW_WHITE:N++,SCRIPT:N++,SCRIPT_ENDING:N++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(S){var v=e.ENTITIES[S],K=typeof v=="number"?String.fromCharCode(v):v;e.ENTITIES[S]=K});for(var Y in e.STATE)e.STATE[e.STATE[Y]]=Y;N=e.STATE;function ue(S,v,K){S[v]&&S[v](K)}function I(S,v,K){S.textNode&&U(S),ue(S,v,K)}function U(S){S.textNode=x(S.opt,S.textNode),S.textNode&&ue(S,"ontext",S.textNode),S.textNode=""}function x(S,v){return S.trim&&(v=v.trim()),S.normalize&&(v=v.replace(/\s+/g," ")),v}function Z(S,v){return U(S),S.trackPosition&&(v+=`
Line: `+S.line+`
Column: `+S.column+`
Char: `+S.c),v=new Error(v),S.error=v,ue(S,"onerror",v),S}function re(S){return S.sawRoot&&!S.closedRoot&&H(S,"Unclosed root tag"),S.state!==N.BEGIN&&S.state!==N.BEGIN_WHITESPACE&&S.state!==N.TEXT&&Z(S,"Unexpected end"),U(S),S.c="",S.closed=!0,ue(S,"onend"),a.call(S,S.strict,S.opt),S}function H(S,v){if(typeof S!="object"||!(S instanceof a))throw new Error("bad call to strictFail");S.strict&&Z(S,v)}function ie(S){S.strict||(S.tagName=S.tagName[S.looseCase]());var v=S.tags[S.tags.length-1]||S,K=S.tag={name:S.tagName,attributes:{}};S.opt.xmlns&&(K.ns=v.ns),S.attribList.length=0,I(S,"onopentagstart",K)}function te(S,v){var K=S.indexOf(":"),L=K<0?["",S]:S.split(":"),F=L[0],B=L[1];return v&&S==="xmlns"&&(F="xmlns",B=""),{prefix:F,local:B}}function ee(S){if(S.strict||(S.attribName=S.attribName[S.looseCase]()),S.attribList.indexOf(S.attribName)!==-1||S.tag.attributes.hasOwnProperty(S.attribName)){S.attribName=S.attribValue="";return}if(S.opt.xmlns){var v=te(S.attribName,!0),K=v.prefix,L=v.local;if(K==="xmlns")if(L==="xml"&&S.attribValue!==E)H(S,"xml: prefix must be bound to "+E+`
Actual: `+S.attribValue);else if(L==="xmlns"&&S.attribValue!==R)H(S,"xmlns: prefix must be bound to "+R+`
Actual: `+S.attribValue);else{var F=S.tag,B=S.tags[S.tags.length-1]||S;F.ns===B.ns&&(F.ns=Object.create(B.ns)),F.ns[L]=S.attribValue}S.attribList.push([S.attribName,S.attribValue])}else S.tag.attributes[S.attribName]=S.attribValue,I(S,"onattribute",{name:S.attribName,value:S.attribValue});S.attribName=S.attribValue=""}function V(S,v){if(S.opt.xmlns){var K=S.tag,L=te(S.tagName);K.prefix=L.prefix,K.local=L.local,K.uri=K.ns[L.prefix]||"",K.prefix&&!K.uri&&(H(S,"Unbound namespace prefix: "+JSON.stringify(S.tagName)),K.uri=L.prefix);var F=S.tags[S.tags.length-1]||S;K.ns&&F.ns!==K.ns&&Object.keys(K.ns).forEach(function(z){I(S,"onopennamespace",{prefix:z,uri:K.ns[z]})});for(var B=0,Q=S.attribList.length;B<Q;B++){var p=S.attribList[B],M=p[0],g=p[1],r=te(M,!0),s=r.prefix,f=r.local,D=s===""?"":K.ns[s]||"",G={name:M,value:g,prefix:s,local:f,uri:D};s&&s!=="xmlns"&&!D&&(H(S,"Unbound namespace prefix: "+JSON.stringify(s)),G.uri=s),S.tag.attributes[M]=G,I(S,"onattribute",G)}S.attribList.length=0}S.tag.isSelfClosing=!!v,S.sawRoot=!0,S.tags.push(S.tag),I(S,"onopentag",S.tag),v||(!S.noscript&&S.tagName.toLowerCase()==="script"?S.state=N.SCRIPT:S.state=N.TEXT,S.tag=null,S.tagName=""),S.attribName=S.attribValue="",S.attribList.length=0}function O(S){if(!S.tagName){H(S,"Weird empty close tag."),S.textNode+="</>",S.state=N.TEXT;return}if(S.script){if(S.tagName!=="script"){S.script+="</"+S.tagName+">",S.tagName="",S.state=N.SCRIPT;return}I(S,"onscript",S.script),S.script=""}var v=S.tags.length,K=S.tagName;S.strict||(K=K[S.looseCase]());for(var L=K;v--;){var F=S.tags[v];if(F.name!==L)H(S,"Unexpected close tag");else break}if(v<0){H(S,"Unmatched closing tag: "+S.tagName),S.textNode+="</"+S.tagName+">",S.state=N.TEXT;return}S.tagName=K;for(var B=S.tags.length;B-- >v;){var Q=S.tag=S.tags.pop();S.tagName=S.tag.name,I(S,"onclosetag",S.tagName);var p={};for(var M in Q.ns)p[M]=Q.ns[M];var g=S.tags[S.tags.length-1]||S;S.opt.xmlns&&Q.ns!==g.ns&&Object.keys(Q.ns).forEach(function(r){var s=Q.ns[r];I(S,"onclosenamespace",{prefix:r,uri:s})})}v===0&&(S.closedRoot=!0),S.tagName=S.attribValue=S.attribName="",S.attribList.length=0,S.state=N.TEXT}function X(S){var v=S.entity,K=v.toLowerCase(),L,F="";return S.ENTITIES[v]?S.ENTITIES[v]:S.ENTITIES[K]?S.ENTITIES[K]:(v=K,v.charAt(0)==="#"&&(v.charAt(1)==="x"?(v=v.slice(2),L=parseInt(v,16),F=L.toString(16)):(v=v.slice(1),L=parseInt(v,10),F=L.toString(10))),v=v.replace(/^0+/,""),isNaN(L)||F.toLowerCase()!==v?(H(S,"Invalid character entity"),"&"+S.entity+";"):String.fromCodePoint(L))}function J(S,v){v==="<"?(S.state=N.OPEN_WAKA,S.startTagPosition=S.position):u(v)||(H(S,"Non-whitespace before first tag."),S.textNode=v,S.state=N.TEXT)}function ne(S,v){var K="";return v<S.length&&(K=S.charAt(v)),K}function $(S){var v=this;if(this.error)throw this.error;if(v.closed)return Z(v,"Cannot write after close. Assign an onready handler.");if(S===null)return re(v);typeof S=="object"&&(S=S.toString());for(var K=0,L="";L=ne(S,K++),v.c=L,!!L;)switch(v.trackPosition&&(v.position++,L===`
`?(v.line++,v.column=0):v.column++),v.state){case N.BEGIN:if(v.state=N.BEGIN_WHITESPACE,L==="\uFEFF")continue;J(v,L);continue;case N.BEGIN_WHITESPACE:J(v,L);continue;case N.TEXT:if(v.sawRoot&&!v.closedRoot){for(var F=K-1;L&&L!=="<"&&L!=="&";)L=ne(S,K++),L&&v.trackPosition&&(v.position++,L===`
`?(v.line++,v.column=0):v.column++);v.textNode+=S.substring(F,K-1)}L==="<"&&!(v.sawRoot&&v.closedRoot&&!v.strict)?(v.state=N.OPEN_WAKA,v.startTagPosition=v.position):(!u(L)&&(!v.sawRoot||v.closedRoot)&&H(v,"Text data outside of root node."),L==="&"?v.state=N.TEXT_ENTITY:v.textNode+=L);continue;case N.SCRIPT:L==="<"?v.state=N.SCRIPT_ENDING:v.script+=L;continue;case N.SCRIPT_ENDING:L==="/"?v.state=N.CLOSE_TAG:(v.script+="<"+L,v.state=N.SCRIPT);continue;case N.OPEN_WAKA:if(L==="!")v.state=N.SGML_DECL,v.sgmlDecl="";else if(!u(L))if(j(T,L))v.state=N.OPEN_TAG,v.tagName=L;else if(L==="/")v.state=N.CLOSE_TAG,v.tagName="";else if(L==="?")v.state=N.PROC_INST,v.procInstName=v.procInstBody="";else{if(H(v,"Unencoded <"),v.startTagPosition+1<v.position){var B=v.position-v.startTagPosition;L=new Array(B).join(" ")+L}v.textNode+="<"+L,v.state=N.TEXT}continue;case N.SGML_DECL:(v.sgmlDecl+L).toUpperCase()===k?(I(v,"onopencdata"),v.state=N.CDATA,v.sgmlDecl="",v.cdata=""):v.sgmlDecl+L==="--"?(v.state=N.COMMENT,v.comment="",v.sgmlDecl=""):(v.sgmlDecl+L).toUpperCase()===C?(v.state=N.DOCTYPE,(v.doctype||v.sawRoot)&&H(v,"Inappropriately located doctype declaration"),v.doctype="",v.sgmlDecl=""):L===">"?(I(v,"onsgmldeclaration",v.sgmlDecl),v.sgmlDecl="",v.state=N.TEXT):(A(L)&&(v.state=N.SGML_DECL_QUOTED),v.sgmlDecl+=L);continue;case N.SGML_DECL_QUOTED:L===v.q&&(v.state=N.SGML_DECL,v.q=""),v.sgmlDecl+=L;continue;case N.DOCTYPE:L===">"?(v.state=N.TEXT,I(v,"ondoctype",v.doctype),v.doctype=!0):(v.doctype+=L,L==="["?v.state=N.DOCTYPE_DTD:A(L)&&(v.state=N.DOCTYPE_QUOTED,v.q=L));continue;case N.DOCTYPE_QUOTED:v.doctype+=L,L===v.q&&(v.q="",v.state=N.DOCTYPE);continue;case N.DOCTYPE_DTD:v.doctype+=L,L==="]"?v.state=N.DOCTYPE:A(L)&&(v.state=N.DOCTYPE_DTD_QUOTED,v.q=L);continue;case N.DOCTYPE_DTD_QUOTED:v.doctype+=L,L===v.q&&(v.state=N.DOCTYPE_DTD,v.q="");continue;case N.COMMENT:L==="-"?v.state=N.COMMENT_ENDING:v.comment+=L;continue;case N.COMMENT_ENDING:L==="-"?(v.state=N.COMMENT_ENDED,v.comment=x(v.opt,v.comment),v.comment&&I(v,"oncomment",v.comment),v.comment=""):(v.comment+="-"+L,v.state=N.COMMENT);continue;case N.COMMENT_ENDED:L!==">"?(H(v,"Malformed comment"),v.comment+="--"+L,v.state=N.COMMENT):v.state=N.TEXT;continue;case N.CDATA:L==="]"?v.state=N.CDATA_ENDING:v.cdata+=L;continue;case N.CDATA_ENDING:L==="]"?v.state=N.CDATA_ENDING_2:(v.cdata+="]"+L,v.state=N.CDATA);continue;case N.CDATA_ENDING_2:L===">"?(v.cdata&&I(v,"oncdata",v.cdata),I(v,"onclosecdata"),v.cdata="",v.state=N.TEXT):L==="]"?v.cdata+="]":(v.cdata+="]]"+L,v.state=N.CDATA);continue;case N.PROC_INST:L==="?"?v.state=N.PROC_INST_ENDING:u(L)?v.state=N.PROC_INST_BODY:v.procInstName+=L;continue;case N.PROC_INST_BODY:if(!v.procInstBody&&u(L))continue;L==="?"?v.state=N.PROC_INST_ENDING:v.procInstBody+=L;continue;case N.PROC_INST_ENDING:L===">"?(I(v,"onprocessinginstruction",{name:v.procInstName,body:v.procInstBody}),v.procInstName=v.procInstBody="",v.state=N.TEXT):(v.procInstBody+="?"+L,v.state=N.PROC_INST_BODY);continue;case N.OPEN_TAG:j(o,L)?v.tagName+=L:(ie(v),L===">"?V(v):L==="/"?v.state=N.OPEN_TAG_SLASH:(u(L)||H(v,"Invalid character in tag name"),v.state=N.ATTRIB));continue;case N.OPEN_TAG_SLASH:L===">"?(V(v,!0),O(v)):(H(v,"Forward-slash in opening tag not followed by >"),v.state=N.ATTRIB);continue;case N.ATTRIB:if(u(L))continue;L===">"?V(v):L==="/"?v.state=N.OPEN_TAG_SLASH:j(T,L)?(v.attribName=L,v.attribValue="",v.state=N.ATTRIB_NAME):H(v,"Invalid attribute name");continue;case N.ATTRIB_NAME:L==="="?v.state=N.ATTRIB_VALUE:L===">"?(H(v,"Attribute without value"),v.attribValue=v.attribName,ee(v),V(v)):u(L)?v.state=N.ATTRIB_NAME_SAW_WHITE:j(o,L)?v.attribName+=L:H(v,"Invalid attribute name");continue;case N.ATTRIB_NAME_SAW_WHITE:if(L==="=")v.state=N.ATTRIB_VALUE;else{if(u(L))continue;H(v,"Attribute without value"),v.tag.attributes[v.attribName]="",v.attribValue="",I(v,"onattribute",{name:v.attribName,value:""}),v.attribName="",L===">"?V(v):j(T,L)?(v.attribName=L,v.state=N.ATTRIB_NAME):(H(v,"Invalid attribute name"),v.state=N.ATTRIB)}continue;case N.ATTRIB_VALUE:if(u(L))continue;A(L)?(v.q=L,v.state=N.ATTRIB_VALUE_QUOTED):(H(v,"Unquoted attribute value"),v.state=N.ATTRIB_VALUE_UNQUOTED,v.attribValue=L);continue;case N.ATTRIB_VALUE_QUOTED:if(L!==v.q){L==="&"?v.state=N.ATTRIB_VALUE_ENTITY_Q:v.attribValue+=L;continue}ee(v),v.q="",v.state=N.ATTRIB_VALUE_CLOSED;continue;case N.ATTRIB_VALUE_CLOSED:u(L)?v.state=N.ATTRIB:L===">"?V(v):L==="/"?v.state=N.OPEN_TAG_SLASH:j(T,L)?(H(v,"No whitespace between attributes"),v.attribName=L,v.attribValue="",v.state=N.ATTRIB_NAME):H(v,"Invalid attribute name");continue;case N.ATTRIB_VALUE_UNQUOTED:if(!P(L)){L==="&"?v.state=N.ATTRIB_VALUE_ENTITY_U:v.attribValue+=L;continue}ee(v),L===">"?V(v):v.state=N.ATTRIB;continue;case N.CLOSE_TAG:if(v.tagName)L===">"?O(v):j(o,L)?v.tagName+=L:v.script?(v.script+="</"+v.tagName,v.tagName="",v.state=N.SCRIPT):(u(L)||H(v,"Invalid tagname in closing tag"),v.state=N.CLOSE_TAG_SAW_WHITE);else{if(u(L))continue;q(T,L)?v.script?(v.script+="</"+L,v.state=N.SCRIPT):H(v,"Invalid tagname in closing tag."):v.tagName=L}continue;case N.CLOSE_TAG_SAW_WHITE:if(u(L))continue;L===">"?O(v):H(v,"Invalid characters in closing tag");continue;case N.TEXT_ENTITY:case N.ATTRIB_VALUE_ENTITY_Q:case N.ATTRIB_VALUE_ENTITY_U:var Q,p;switch(v.state){case N.TEXT_ENTITY:Q=N.TEXT,p="textNode";break;case N.ATTRIB_VALUE_ENTITY_Q:Q=N.ATTRIB_VALUE_QUOTED,p="attribValue";break;case N.ATTRIB_VALUE_ENTITY_U:Q=N.ATTRIB_VALUE_UNQUOTED,p="attribValue";break}L===";"?(v[p]+=X(v),v.entity="",v.state=Q):j(v.entity.length?m:y,L)?v.entity+=L:(H(v,"Invalid character in entity name"),v[p]+="&"+v.entity+L,v.entity="",v.state=Q);continue;default:throw new Error(v,"Unknown state: "+v.state)}return v.position>=v.bufferCheckPosition&&h(v),v}String.fromCodePoint||function(){var S=String.fromCharCode,v=Math.floor,K=function(){var L=16384,F=[],B,Q,p=-1,M=arguments.length;if(!M)return"";for(var g="";++p<M;){var r=Number(arguments[p]);if(!isFinite(r)||r<0||r>1114111||v(r)!==r)throw RangeError("Invalid code point: "+r);r<=65535?F.push(r):(r-=65536,B=(r>>10)+55296,Q=r%1024+56320,F.push(B,Q)),(p+1===M||F.length>L)&&(g+=S.apply(null,F),F.length=0)}return g};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:K,configurable:!0,writable:!0}):String.fromCodePoint=K}()})(i)}(lr)),lr}var Tn,ea;function yi(){return ea||(ea=1,Tn={isArray:function(i){return Array.isArray?Array.isArray(i):Object.prototype.toString.call(i)==="[object Array]"}}),Tn}var kn,ta;function vi(){if(ta)return kn;ta=1;var i=yi().isArray;return kn={copyOptions:function(e){var t,a={};for(t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);return a},ensureFlagExists:function(e,t){(!(e in t)||typeof t[e]!="boolean")&&(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||typeof e.spaces!="number"&&typeof e.spaces!="string")&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){(!("alwaysArray"in e)||typeof e.alwaysArray!="boolean"&&!i(e.alwaysArray))&&(e.alwaysArray=!1)},ensureKeyExists:function(e,t){(!(e+"Key"in t)||typeof t[e+"Key"]!="string")&&(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}},kn}var Rn,ra;function lo(){if(ra)return Rn;ra=1;var i=nu(),e=vi(),t=yi().isArray,a,h;function l(o){return a=e.copyOptions(o),e.ensureFlagExists("ignoreDeclaration",a),e.ensureFlagExists("ignoreInstruction",a),e.ensureFlagExists("ignoreAttributes",a),e.ensureFlagExists("ignoreText",a),e.ensureFlagExists("ignoreComment",a),e.ensureFlagExists("ignoreCdata",a),e.ensureFlagExists("ignoreDoctype",a),e.ensureFlagExists("compact",a),e.ensureFlagExists("alwaysChildren",a),e.ensureFlagExists("addParent",a),e.ensureFlagExists("trim",a),e.ensureFlagExists("nativeType",a),e.ensureFlagExists("nativeTypeAttributes",a),e.ensureFlagExists("sanitize",a),e.ensureFlagExists("instructionHasAttributes",a),e.ensureFlagExists("captureSpacesBetweenElements",a),e.ensureAlwaysArrayExists(a),e.ensureKeyExists("declaration",a),e.ensureKeyExists("instruction",a),e.ensureKeyExists("attributes",a),e.ensureKeyExists("text",a),e.ensureKeyExists("comment",a),e.ensureKeyExists("cdata",a),e.ensureKeyExists("doctype",a),e.ensureKeyExists("type",a),e.ensureKeyExists("name",a),e.ensureKeyExists("elements",a),e.ensureKeyExists("parent",a),e.checkFnExists("doctype",a),e.checkFnExists("instruction",a),e.checkFnExists("cdata",a),e.checkFnExists("comment",a),e.checkFnExists("text",a),e.checkFnExists("instructionName",a),e.checkFnExists("elementName",a),e.checkFnExists("attributeName",a),e.checkFnExists("attributeValue",a),e.checkFnExists("attributes",a),a}function d(o){var y=Number(o);if(!isNaN(y))return y;var m=o.toLowerCase();return m==="true"?!0:m==="false"?!1:o}function n(o,y){var m;if(a.compact){if(!h[a[o+"Key"]]&&(t(a.alwaysArray)?a.alwaysArray.indexOf(a[o+"Key"])!==-1:a.alwaysArray)&&(h[a[o+"Key"]]=[]),h[a[o+"Key"]]&&!t(h[a[o+"Key"]])&&(h[a[o+"Key"]]=[h[a[o+"Key"]]]),o+"Fn"in a&&typeof y=="string"&&(y=a[o+"Fn"](y,h)),o==="instruction"&&("instructionFn"in a||"instructionNameFn"in a)){for(m in y)if(y.hasOwnProperty(m))if("instructionFn"in a)y[m]=a.instructionFn(y[m],m,h);else{var u=y[m];delete y[m],y[a.instructionNameFn(m,u,h)]=u}}t(h[a[o+"Key"]])?h[a[o+"Key"]].push(y):h[a[o+"Key"]]=y}else{h[a.elementsKey]||(h[a.elementsKey]=[]);var A={};if(A[a.typeKey]=o,o==="instruction"){for(m in y)if(y.hasOwnProperty(m))break;A[a.nameKey]="instructionNameFn"in a?a.instructionNameFn(m,y,h):m,a.instructionHasAttributes?(A[a.attributesKey]=y[m][a.attributesKey],"instructionFn"in a&&(A[a.attributesKey]=a.instructionFn(A[a.attributesKey],m,h))):("instructionFn"in a&&(y[m]=a.instructionFn(y[m],m,h)),A[a.instructionKey]=y[m])}else o+"Fn"in a&&(y=a[o+"Fn"](y,h)),A[a[o+"Key"]]=y;a.addParent&&(A[a.parentKey]=h),h[a.elementsKey].push(A)}}function c(o){if("attributesFn"in a&&o&&(o=a.attributesFn(o,h)),(a.trim||"attributeValueFn"in a||"attributeNameFn"in a||a.nativeTypeAttributes)&&o){var y;for(y in o)if(o.hasOwnProperty(y)&&(a.trim&&(o[y]=o[y].trim()),a.nativeTypeAttributes&&(o[y]=d(o[y])),"attributeValueFn"in a&&(o[y]=a.attributeValueFn(o[y],y,h)),"attributeNameFn"in a)){var m=o[y];delete o[y],o[a.attributeNameFn(y,o[y],h)]=m}}return o}function w(o){var y={};if(o.body&&(o.name.toLowerCase()==="xml"||a.instructionHasAttributes)){for(var m=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,u;(u=m.exec(o.body))!==null;)y[u[1]]=u[2]||u[3]||u[4];y=c(y)}if(o.name.toLowerCase()==="xml"){if(a.ignoreDeclaration)return;h[a.declarationKey]={},Object.keys(y).length&&(h[a.declarationKey][a.attributesKey]=y),a.addParent&&(h[a.declarationKey][a.parentKey]=h)}else{if(a.ignoreInstruction)return;a.trim&&(o.body=o.body.trim());var A={};a.instructionHasAttributes&&Object.keys(y).length?(A[o.name]={},A[o.name][a.attributesKey]=y):A[o.name]=o.body,n("instruction",A)}}function _(o,y){var m;if(typeof o=="object"&&(y=o.attributes,o=o.name),y=c(y),"elementNameFn"in a&&(o=a.elementNameFn(o,h)),a.compact){if(m={},!a.ignoreAttributes&&y&&Object.keys(y).length){m[a.attributesKey]={};var u;for(u in y)y.hasOwnProperty(u)&&(m[a.attributesKey][u]=y[u])}!(o in h)&&(t(a.alwaysArray)?a.alwaysArray.indexOf(o)!==-1:a.alwaysArray)&&(h[o]=[]),h[o]&&!t(h[o])&&(h[o]=[h[o]]),t(h[o])?h[o].push(m):h[o]=m}else h[a.elementsKey]||(h[a.elementsKey]=[]),m={},m[a.typeKey]="element",m[a.nameKey]=o,!a.ignoreAttributes&&y&&Object.keys(y).length&&(m[a.attributesKey]=y),a.alwaysChildren&&(m[a.elementsKey]=[]),h[a.elementsKey].push(m);m[a.parentKey]=h,h=m}function k(o){a.ignoreText||!o.trim()&&!a.captureSpacesBetweenElements||(a.trim&&(o=o.trim()),a.nativeType&&(o=d(o)),a.sanitize&&(o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n("text",o))}function C(o){a.ignoreComment||(a.trim&&(o=o.trim()),n("comment",o))}function E(o){var y=h[a.parentKey];a.addParent||delete h[a.parentKey],h=y}function R(o){a.ignoreCdata||(a.trim&&(o=o.trim()),n("cdata",o))}function b(o){a.ignoreDoctype||(o=o.replace(/^ /,""),a.trim&&(o=o.trim()),n("doctype",o))}function T(o){o.note=o}return Rn=function(o,y){var m=i.parser(!0,{}),u={};if(h=u,a=l(y),m.opt={strictEntities:!0},m.onopentag=_,m.ontext=k,m.oncomment=C,m.onclosetag=E,m.onerror=T,m.oncdata=R,m.ondoctype=b,m.onprocessinginstruction=w,m.write(o).close(),u[a.elementsKey]){var A=u[a.elementsKey];delete u[a.elementsKey],u[a.elementsKey]=A,delete u.text}return u},Rn}var Cn,na;function iu(){if(na)return Cn;na=1;var i=vi(),e=lo();function t(a){var h=i.copyOptions(a);return i.ensureSpacesExists(h),h}return Cn=function(a,h){var l,d,n,c;return l=t(h),d=e(a,l),c="compact"in l&&l.compact?"_parent":"parent","addParent"in l&&l.addParent?n=JSON.stringify(d,function(w,_){return w===c?"_":_},l.spaces):n=JSON.stringify(d,null,l.spaces),n.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},Cn}var Nn,ia;function uo(){if(ia)return Nn;ia=1;var i=vi(),e=yi().isArray,t,a;function h(m){var u=i.copyOptions(m);return i.ensureFlagExists("ignoreDeclaration",u),i.ensureFlagExists("ignoreInstruction",u),i.ensureFlagExists("ignoreAttributes",u),i.ensureFlagExists("ignoreText",u),i.ensureFlagExists("ignoreComment",u),i.ensureFlagExists("ignoreCdata",u),i.ensureFlagExists("ignoreDoctype",u),i.ensureFlagExists("compact",u),i.ensureFlagExists("indentText",u),i.ensureFlagExists("indentCdata",u),i.ensureFlagExists("indentAttributes",u),i.ensureFlagExists("indentInstruction",u),i.ensureFlagExists("fullTagEmptyElement",u),i.ensureFlagExists("noQuotesForNativeAttributes",u),i.ensureSpacesExists(u),typeof u.spaces=="number"&&(u.spaces=Array(u.spaces+1).join(" ")),i.ensureKeyExists("declaration",u),i.ensureKeyExists("instruction",u),i.ensureKeyExists("attributes",u),i.ensureKeyExists("text",u),i.ensureKeyExists("comment",u),i.ensureKeyExists("cdata",u),i.ensureKeyExists("doctype",u),i.ensureKeyExists("type",u),i.ensureKeyExists("name",u),i.ensureKeyExists("elements",u),i.checkFnExists("doctype",u),i.checkFnExists("instruction",u),i.checkFnExists("cdata",u),i.checkFnExists("comment",u),i.checkFnExists("text",u),i.checkFnExists("instructionName",u),i.checkFnExists("elementName",u),i.checkFnExists("attributeName",u),i.checkFnExists("attributeValue",u),i.checkFnExists("attributes",u),i.checkFnExists("fullTagEmptyElement",u),u}function l(m,u,A){return(!A&&m.spaces?`
`:"")+Array(u+1).join(m.spaces)}function d(m,u,A){if(u.ignoreAttributes)return"";"attributesFn"in u&&(m=u.attributesFn(m,a,t));var P,j,q,N,Y=[];for(P in m)m.hasOwnProperty(P)&&m[P]!==null&&m[P]!==void 0&&(N=u.noQuotesForNativeAttributes&&typeof m[P]!="string"?"":'"',j=""+m[P],j=j.replace(/"/g,"&quot;"),q="attributeNameFn"in u?u.attributeNameFn(P,j,a,t):P,Y.push(u.spaces&&u.indentAttributes?l(u,A+1,!1):" "),Y.push(q+"="+N+("attributeValueFn"in u?u.attributeValueFn(j,P,a,t):j)+N));return m&&Object.keys(m).length&&u.spaces&&u.indentAttributes&&Y.push(l(u,A,!1)),Y.join("")}function n(m,u,A){return t=m,a="xml",u.ignoreDeclaration?"":"<?xml"+d(m[u.attributesKey],u,A)+"?>"}function c(m,u,A){if(u.ignoreInstruction)return"";var P;for(P in m)if(m.hasOwnProperty(P))break;var j="instructionNameFn"in u?u.instructionNameFn(P,m[P],a,t):P;if(typeof m[P]=="object")return t=m,a=j,"<?"+j+d(m[P][u.attributesKey],u,A)+"?>";var q=m[P]?m[P]:"";return"instructionFn"in u&&(q=u.instructionFn(q,P,a,t)),"<?"+j+(q?" "+q:"")+"?>"}function w(m,u){return u.ignoreComment?"":"<!--"+("commentFn"in u?u.commentFn(m,a,t):m)+"-->"}function _(m,u){return u.ignoreCdata?"":"<![CDATA["+("cdataFn"in u?u.cdataFn(m,a,t):m.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function k(m,u){return u.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in u?u.doctypeFn(m,a,t):m)+">"}function C(m,u){return u.ignoreText?"":(m=""+m,m=m.replace(/&amp;/g,"&"),m=m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in u?u.textFn(m,a,t):m)}function E(m,u){var A;if(m.elements&&m.elements.length)for(A=0;A<m.elements.length;++A)switch(m.elements[A][u.typeKey]){case"text":if(u.indentText)return!0;break;case"cdata":if(u.indentCdata)return!0;break;case"instruction":if(u.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function R(m,u,A){t=m,a=m.name;var P=[],j="elementNameFn"in u?u.elementNameFn(m.name,m):m.name;P.push("<"+j),m[u.attributesKey]&&P.push(d(m[u.attributesKey],u,A));var q=m[u.elementsKey]&&m[u.elementsKey].length||m[u.attributesKey]&&m[u.attributesKey]["xml:space"]==="preserve";return q||("fullTagEmptyElementFn"in u?q=u.fullTagEmptyElementFn(m.name,m):q=u.fullTagEmptyElement),q?(P.push(">"),m[u.elementsKey]&&m[u.elementsKey].length&&(P.push(b(m[u.elementsKey],u,A+1)),t=m,a=m.name),P.push(u.spaces&&E(m,u)?`
`+Array(A+1).join(u.spaces):""),P.push("</"+j+">")):P.push("/>"),P.join("")}function b(m,u,A,P){return m.reduce(function(j,q){var N=l(u,A,P&&!j);switch(q.type){case"element":return j+N+R(q,u,A);case"comment":return j+N+w(q[u.commentKey],u);case"doctype":return j+N+k(q[u.doctypeKey],u);case"cdata":return j+(u.indentCdata?N:"")+_(q[u.cdataKey],u);case"text":return j+(u.indentText?N:"")+C(q[u.textKey],u);case"instruction":var Y={};return Y[q[u.nameKey]]=q[u.attributesKey]?q:q[u.instructionKey],j+(u.indentInstruction?N:"")+c(Y,u,A)}},"")}function T(m,u,A){var P;for(P in m)if(m.hasOwnProperty(P))switch(P){case u.parentKey:case u.attributesKey:break;case u.textKey:if(u.indentText||A)return!0;break;case u.cdataKey:if(u.indentCdata||A)return!0;break;case u.instructionKey:if(u.indentInstruction||A)return!0;break;case u.doctypeKey:case u.commentKey:return!0;default:return!0}return!1}function o(m,u,A,P,j){t=m,a=u;var q="elementNameFn"in A?A.elementNameFn(u,m):u;if(typeof m>"u"||m===null||m==="")return"fullTagEmptyElementFn"in A&&A.fullTagEmptyElementFn(u,m)||A.fullTagEmptyElement?"<"+q+"></"+q+">":"<"+q+"/>";var N=[];if(u){if(N.push("<"+q),typeof m!="object")return N.push(">"+C(m,A)+"</"+q+">"),N.join("");m[A.attributesKey]&&N.push(d(m[A.attributesKey],A,P));var Y=T(m,A,!0)||m[A.attributesKey]&&m[A.attributesKey]["xml:space"]==="preserve";if(Y||("fullTagEmptyElementFn"in A?Y=A.fullTagEmptyElementFn(u,m):Y=A.fullTagEmptyElement),Y)N.push(">");else return N.push("/>"),N.join("")}return N.push(y(m,A,P+1,!1)),t=m,a=u,u&&N.push((j?l(A,P,!1):"")+"</"+q+">"),N.join("")}function y(m,u,A,P){var j,q,N,Y=[];for(q in m)if(m.hasOwnProperty(q))for(N=e(m[q])?m[q]:[m[q]],j=0;j<N.length;++j){switch(q){case u.declarationKey:Y.push(n(N[j],u,A));break;case u.instructionKey:Y.push((u.indentInstruction?l(u,A,P):"")+c(N[j],u,A));break;case u.attributesKey:case u.parentKey:break;case u.textKey:Y.push((u.indentText?l(u,A,P):"")+C(N[j],u));break;case u.cdataKey:Y.push((u.indentCdata?l(u,A,P):"")+_(N[j],u));break;case u.doctypeKey:Y.push(l(u,A,P)+k(N[j],u));break;case u.commentKey:Y.push(l(u,A,P)+w(N[j],u));break;default:Y.push(l(u,A,P)+o(N[j],q,u,A,T(N[j],u)))}P=P&&!Y.length}return Y.join("")}return Nn=function(m,u){u=h(u);var A=[];return t=m,a="_root_",u.compact?A.push(y(m,u,0,!0)):(m[u.declarationKey]&&A.push(n(m[u.declarationKey],u,0)),m[u.elementsKey]&&m[u.elementsKey].length&&A.push(b(m[u.elementsKey],u,0,!A.length))),A.join("")},Nn}var In,sa;function su(){if(sa)return In;sa=1;var i=uo();return In=function(e,t){e instanceof Buffer&&(e=e.toString());var a=null;if(typeof e=="string")try{a=JSON.parse(e)}catch{throw new Error("The JSON structure is invalid")}else a=e;return i(a,t)},In}var Fn,aa;function au(){if(aa)return Fn;aa=1;var i=lo(),e=iu(),t=uo(),a=su();return Fn={xml2js:i,xml2json:e,js2xml:t,json2xml:a},Fn}var co=au();const bi=i=>{switch(i.type){case void 0:case"element":const e=new lu(i.name,i.attributes),t=i.elements||[];for(const a of t){const h=bi(a);h!==void 0&&e.push(h)}return e;case"text":return i.text;default:return}};class ou extends pe{}class lu extends le{static fromXmlString(e){const t=co.xml2js(e,{compact:!1});return bi(t)}constructor(e,t){super(e),t&&this.root.push(new ou(t))}push(e){this.root.push(e)}}class uu extends le{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}}class ho extends le{constructor(e,t){super(e),t&&(this.root=t.root)}}const Te=i=>{if(isNaN(i))throw new Error(`Invalid value '${i}' specified. Must be an integer.`);return Math.floor(i)},er=i=>{const e=Te(i);if(e<0)throw new Error(`Invalid value '${i}' specified. Must be a positive integer.`);return e},fo=(i,e)=>{const t=e*2;if(i.length!==t||isNaN(+`0x${i}`))throw new Error(`Invalid hex value '${i}'. Expected ${t} digit hex value`);return i},oa=i=>fo(i,1),xi=i=>{const e=i.slice(-2),t=i.substring(0,i.length-2);return`${Number(t)}${e}`},po=i=>{const e=xi(i);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},gt=i=>{if(i==="auto")return i;const e=i.charAt(0)==="#"?i.substring(1):i;return fo(e,3)},qe=i=>typeof i=="string"?xi(i):Te(i),cu=i=>typeof i=="string"?po(i):er(i),Ae=i=>typeof i=="string"?po(i):er(i),hu=i=>{const e=i.substring(0,i.length-1);return`${Number(e)}%`},mo=i=>typeof i=="number"?Te(i):i.slice(-1)==="%"?hu(i):xi(i),fu=er,du=er,pu=i=>i.toISOString();class he extends le{constructor(e,t=!0){super(e),t!==!0&&this.root.push(new _e({val:t}))}}class On extends le{constructor(e,t){super(e),this.root.push(new _e({val:cu(t)}))}}class st extends le{constructor(e,t){super(e),this.root.push(new _e({val:t}))}}const At=(i,e)=>new Le({name:i,attributes:{value:{key:"w:val",value:e}}});class Ct extends le{constructor(e,t){super(e),this.root.push(new _e({val:t}))}}class mu extends le{constructor(e,t){super(e),this.root.push(new _e({val:t}))}}class Je extends le{constructor(e,t){super(e),this.root.push(t)}}class Le extends le{constructor({name:e,attributes:t,children:a}){super(e),t&&this.root.push(new $e(t)),a&&this.root.push(...a)}}const Ce={START:"start",CENTER:"center",LEFT:"left",RIGHT:"right"};class gu extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class go extends le{constructor(e){super("w:jc"),this.root.push(new gu({val:e}))}}class ve extends le{constructor(e,{color:t,size:a,space:h,style:l}){super(e),this.root.push(new wu({style:l,color:t===void 0?void 0:gt(t),size:a===void 0?void 0:fu(a),space:h===void 0?void 0:du(h)}))}}class wu extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const _i={SINGLE:"single",NONE:"none"};class yu extends Ke{constructor(e){super("w:pBdr"),e.top&&this.root.push(new ve("w:top",e.top)),e.bottom&&this.root.push(new ve("w:bottom",e.bottom)),e.left&&this.root.push(new ve("w:left",e.left)),e.right&&this.root.push(new ve("w:right",e.right)),e.between&&this.root.push(new ve("w:between",e.between))}}class vu extends le{constructor(){super("w:pBdr");const e=new ve("w:bottom",{color:"auto",space:1,style:_i.SINGLE,size:6});this.root.push(e)}}class bu extends le{constructor({start:e,end:t,left:a,right:h,hanging:l,firstLine:d}){super("w:ind"),this.root.push(new $e({start:{key:"w:start",value:e===void 0?void 0:qe(e)},end:{key:"w:end",value:t===void 0?void 0:qe(t)},left:{key:"w:left",value:a===void 0?void 0:qe(a)},right:{key:"w:right",value:h===void 0?void 0:qe(h)},hanging:{key:"w:hanging",value:l===void 0?void 0:Ae(l)},firstLine:{key:"w:firstLine",value:d===void 0?void 0:Ae(d)}}))}}let xu=class extends le{constructor(){super("w:br")}};const Ei={BEGIN:"begin",END:"end",SEPARATE:"separate"};class Si extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class Wt extends le{constructor(e){super("w:fldChar"),this.root.push(new Si({type:Ei.BEGIN,dirty:e}))}}class Ht extends le{constructor(e){super("w:fldChar"),this.root.push(new Si({type:Ei.SEPARATE,dirty:e}))}}class qt extends le{constructor(e){super("w:fldChar"),this.root.push(new Si({type:Ei.END,dirty:e}))}}const wt={DEFAULT:"default",PRESERVE:"preserve"};class yt extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{space:"xml:space"})}}class _u extends le{constructor(){super("w:instrText"),this.root.push(new yt({space:wt.PRESERVE})),this.root.push("PAGE")}}class Eu extends le{constructor(){super("w:instrText"),this.root.push(new yt({space:wt.PRESERVE})),this.root.push("NUMPAGES")}}class Su extends le{constructor(){super("w:instrText"),this.root.push(new yt({space:wt.PRESERVE})),this.root.push("SECTIONPAGES")}}class Au extends le{constructor(){super("w:instrText"),this.root.push(new yt({space:wt.PRESERVE})),this.root.push("SECTION")}}class Tu extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class tr extends le{constructor({fill:e,color:t,type:a}){super("w:shd"),this.root.push(new Tu({fill:e===void 0?void 0:gt(e),color:t===void 0?void 0:gt(t),type:a}))}}class ku extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const Ru={DOT:"dot"};class Cu extends le{constructor(e){super("w:em"),this.root.push(new _e({val:e}))}}class Nu extends Cu{constructor(e=Ru.DOT){super(e)}}class Iu extends le{constructor(e){super("w:spacing"),this.root.push(new _e({val:qe(e)}))}}class Fu extends le{constructor(e){super("w:color"),this.root.push(new _e({val:gt(e)}))}}class Ou extends le{constructor(e){super("w:highlight"),this.root.push(new _e({val:e}))}}class Pu extends le{constructor(e){super("w:highlightCs"),this.root.push(new _e({val:e}))}}const Bu=i=>new Le({name:"w:lang",attributes:{value:{key:"w:val",value:i.value},eastAsia:{key:"w:eastAsia",value:i.eastAsia},bidirectional:{key:"w:bidi",value:i.bidirectional}}});class la extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class Pn extends le{constructor(e,t){if(super("w:rFonts"),typeof e=="string"){const a=e;this.root.push(new la({ascii:a,cs:a,eastAsia:a,hAnsi:a,hint:t}))}else{const a=e;this.root.push(new la(a))}}}let wo=class extends le{constructor(e){super("w:vertAlign"),this.root.push(new _e({val:e}))}};class Du extends wo{constructor(){super("superscript")}}class ju extends wo{constructor(){super("subscript")}}const yo={SINGLE:"single"};class Lu extends le{constructor(e=yo.SINGLE,t){super("w:u"),this.root.push(new _e({val:e,color:t===void 0?void 0:gt(t)}))}}class ot extends Ke{constructor(e){var t,a;if(super("w:rPr"),!e)return;e.style&&this.push(new st("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new Pn(e.font)):"name"in e.font?this.push(new Pn(e.font.name,e.font.hint)):this.push(new Pn(e.font))),e.bold!==void 0&&this.push(new he("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new he("w:bCs",(t=e.boldComplexScript)!=null?t:e.bold)),e.italics!==void 0&&this.push(new he("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new he("w:iCs",(a=e.italicsComplexScript)!=null?a:e.italics)),e.smallCaps!==void 0?this.push(new he("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new he("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new he("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new he("w:dstrike",e.doubleStrike)),e.emboss!==void 0&&this.push(new he("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new he("w:imprint",e.imprint)),e.noProof!==void 0&&this.push(new he("w:noProof",e.noProof)),e.snapToGrid!==void 0&&this.push(new he("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new he("w:vanish",e.vanish)),e.color&&this.push(new Fu(e.color)),e.characterSpacing&&this.push(new Iu(e.characterSpacing)),e.scale!==void 0&&this.push(new Ct("w:w",e.scale)),e.kern&&this.push(new On("w:kern",e.kern)),e.position&&this.push(new st("w:position",e.position)),e.size!==void 0&&this.push(new On("w:sz",e.size));const h=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;h&&this.push(new On("w:szCs",h)),e.highlight&&this.push(new Ou(e.highlight));const l=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;l&&this.push(new Pu(l)),e.underline&&this.push(new Lu(e.underline.type,e.underline.color)),e.effect&&this.push(new st("w:effect",e.effect)),e.border&&this.push(new ve("w:bdr",e.border)),e.shading&&this.push(new tr(e.shading)),e.subScript&&this.push(new ju),e.superScript&&this.push(new Du),e.rightToLeft!==void 0&&this.push(new he("w:rtl",e.rightToLeft)),e.emphasisMark&&this.push(new Nu(e.emphasisMark.type)),e.language&&this.push(Bu(e.language)),e.specVanish&&this.push(new he("w:specVanish",e.vanish)),e.math&&this.push(new he("w:oMath",e.math)),e.revision&&this.push(new Mu(e.revision))}push(e){this.root.push(e)}}class Mu extends le{constructor(e){super("w:rPrChange"),this.root.push(new ku({id:e.id,author:e.author,date:e.date})),this.addChildElement(new ot(e))}}class ua extends le{constructor(e){var t;super("w:t"),typeof e=="string"?(this.root.push(new yt({space:wt.PRESERVE})),this.root.push(e)):(this.root.push(new yt({space:(t=e.space)!=null?t:wt.DEFAULT})),this.root.push(e.text))}}const Kt={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class rr extends le{constructor(e){if(super("w:r"),ae(this,"properties"),this.properties=new ot(e),this.root.push(this.properties),e.break)for(let t=0;t<e.break;t++)this.root.push(new xu);if(e.children)for(const t of e.children){if(typeof t=="string"){switch(t){case Kt.CURRENT:this.root.push(new Wt),this.root.push(new _u),this.root.push(new Ht),this.root.push(new qt);break;case Kt.TOTAL_PAGES:this.root.push(new Wt),this.root.push(new Eu),this.root.push(new Ht),this.root.push(new qt);break;case Kt.TOTAL_PAGES_IN_SECTION:this.root.push(new Wt),this.root.push(new Su),this.root.push(new Ht),this.root.push(new qt);break;case Kt.CURRENT_SECTION:this.root.push(new Wt),this.root.push(new Au),this.root.push(new Ht),this.root.push(new qt);break;default:this.root.push(new ua(t));break}continue}this.root.push(t)}else e.text!==void 0&&this.root.push(new ua(e.text))}}class Be extends rr{constructor(e){super(typeof e=="string"?{text:e}:e)}}var Bn={},be={},Dn,ca;function Ft(){if(ca)return Dn;ca=1,Dn=i;function i(e,t){if(!e)throw new Error(t||"Assertion failed")}return i.equal=function(t,a,h){if(t!=a)throw new Error(h||"Assertion failed: "+t+" != "+a)},Dn}var ha;function Me(){if(ha)return be;ha=1;var i=Ft(),e=Ze();be.inherits=e;function t(I,U){return(I.charCodeAt(U)&64512)!==55296||U<0||U+1>=I.length?!1:(I.charCodeAt(U+1)&64512)===56320}function a(I,U){if(Array.isArray(I))return I.slice();if(!I)return[];var x=[];if(typeof I=="string")if(U){if(U==="hex")for(I=I.replace(/[^a-z0-9]+/ig,""),I.length%2!==0&&(I="0"+I),re=0;re<I.length;re+=2)x.push(parseInt(I[re]+I[re+1],16))}else for(var Z=0,re=0;re<I.length;re++){var H=I.charCodeAt(re);H<128?x[Z++]=H:H<2048?(x[Z++]=H>>6|192,x[Z++]=H&63|128):t(I,re)?(H=65536+((H&1023)<<10)+(I.charCodeAt(++re)&1023),x[Z++]=H>>18|240,x[Z++]=H>>12&63|128,x[Z++]=H>>6&63|128,x[Z++]=H&63|128):(x[Z++]=H>>12|224,x[Z++]=H>>6&63|128,x[Z++]=H&63|128)}else for(re=0;re<I.length;re++)x[re]=I[re]|0;return x}be.toArray=a;function h(I){for(var U="",x=0;x<I.length;x++)U+=n(I[x].toString(16));return U}be.toHex=h;function l(I){var U=I>>>24|I>>>8&65280|I<<8&16711680|(I&255)<<24;return U>>>0}be.htonl=l;function d(I,U){for(var x="",Z=0;Z<I.length;Z++){var re=I[Z];U==="little"&&(re=l(re)),x+=c(re.toString(16))}return x}be.toHex32=d;function n(I){return I.length===1?"0"+I:I}be.zero2=n;function c(I){return I.length===7?"0"+I:I.length===6?"00"+I:I.length===5?"000"+I:I.length===4?"0000"+I:I.length===3?"00000"+I:I.length===2?"000000"+I:I.length===1?"0000000"+I:I}be.zero8=c;function w(I,U,x,Z){var re=x-U;i(re%4===0);for(var H=new Array(re/4),ie=0,te=U;ie<H.length;ie++,te+=4){var ee;Z==="big"?ee=I[te]<<24|I[te+1]<<16|I[te+2]<<8|I[te+3]:ee=I[te+3]<<24|I[te+2]<<16|I[te+1]<<8|I[te],H[ie]=ee>>>0}return H}be.join32=w;function _(I,U){for(var x=new Array(I.length*4),Z=0,re=0;Z<I.length;Z++,re+=4){var H=I[Z];U==="big"?(x[re]=H>>>24,x[re+1]=H>>>16&255,x[re+2]=H>>>8&255,x[re+3]=H&255):(x[re+3]=H>>>24,x[re+2]=H>>>16&255,x[re+1]=H>>>8&255,x[re]=H&255)}return x}be.split32=_;function k(I,U){return I>>>U|I<<32-U}be.rotr32=k;function C(I,U){return I<<U|I>>>32-U}be.rotl32=C;function E(I,U){return I+U>>>0}be.sum32=E;function R(I,U,x){return I+U+x>>>0}be.sum32_3=R;function b(I,U,x,Z){return I+U+x+Z>>>0}be.sum32_4=b;function T(I,U,x,Z,re){return I+U+x+Z+re>>>0}be.sum32_5=T;function o(I,U,x,Z){var re=I[U],H=I[U+1],ie=Z+H>>>0,te=(ie<Z?1:0)+x+re;I[U]=te>>>0,I[U+1]=ie}be.sum64=o;function y(I,U,x,Z){var re=U+Z>>>0,H=(re<U?1:0)+I+x;return H>>>0}be.sum64_hi=y;function m(I,U,x,Z){var re=U+Z;return re>>>0}be.sum64_lo=m;function u(I,U,x,Z,re,H,ie,te){var ee=0,V=U;V=V+Z>>>0,ee+=V<U?1:0,V=V+H>>>0,ee+=V<H?1:0,V=V+te>>>0,ee+=V<te?1:0;var O=I+x+re+ie+ee;return O>>>0}be.sum64_4_hi=u;function A(I,U,x,Z,re,H,ie,te){var ee=U+Z+H+te;return ee>>>0}be.sum64_4_lo=A;function P(I,U,x,Z,re,H,ie,te,ee,V){var O=0,X=U;X=X+Z>>>0,O+=X<U?1:0,X=X+H>>>0,O+=X<H?1:0,X=X+te>>>0,O+=X<te?1:0,X=X+V>>>0,O+=X<V?1:0;var J=I+x+re+ie+ee+O;return J>>>0}be.sum64_5_hi=P;function j(I,U,x,Z,re,H,ie,te,ee,V){var O=U+Z+H+te+V;return O>>>0}be.sum64_5_lo=j;function q(I,U,x){var Z=U<<32-x|I>>>x;return Z>>>0}be.rotr64_hi=q;function N(I,U,x){var Z=I<<32-x|U>>>x;return Z>>>0}be.rotr64_lo=N;function Y(I,U,x){return I>>>x}be.shr64_hi=Y;function ue(I,U,x){var Z=I<<32-x|U>>>x;return Z>>>0}return be.shr64_lo=ue,be}var jn={},fa;function Ot(){if(fa)return jn;fa=1;var i=Me(),e=Ft();function t(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return jn.BlockHash=t,t.prototype.update=function(h,l){if(h=i.toArray(h,l),this.pending?this.pending=this.pending.concat(h):this.pending=h,this.pendingTotal+=h.length,this.pending.length>=this._delta8){h=this.pending;var d=h.length%this._delta8;this.pending=h.slice(h.length-d,h.length),this.pending.length===0&&(this.pending=null),h=i.join32(h,0,h.length-d,this.endian);for(var n=0;n<h.length;n+=this._delta32)this._update(h,n,n+this._delta32)}return this},t.prototype.digest=function(h){return this.update(this._pad()),e(this.pending===null),this._digest(h)},t.prototype._pad=function(){var h=this.pendingTotal,l=this._delta8,d=l-(h+this.padLength)%l,n=new Array(d+this.padLength);n[0]=128;for(var c=1;c<d;c++)n[c]=0;if(h<<=3,this.endian==="big"){for(var w=8;w<this.padLength;w++)n[c++]=0;n[c++]=0,n[c++]=0,n[c++]=0,n[c++]=0,n[c++]=h>>>24&255,n[c++]=h>>>16&255,n[c++]=h>>>8&255,n[c++]=h&255}else for(n[c++]=h&255,n[c++]=h>>>8&255,n[c++]=h>>>16&255,n[c++]=h>>>24&255,n[c++]=0,n[c++]=0,n[c++]=0,n[c++]=0,w=8;w<this.padLength;w++)n[c++]=0;return n},jn}var Qe={},Pe={},da;function vo(){if(da)return Pe;da=1;var i=Me(),e=i.rotr32;function t(_,k,C,E){if(_===0)return a(k,C,E);if(_===1||_===3)return l(k,C,E);if(_===2)return h(k,C,E)}Pe.ft_1=t;function a(_,k,C){return _&k^~_&C}Pe.ch32=a;function h(_,k,C){return _&k^_&C^k&C}Pe.maj32=h;function l(_,k,C){return _^k^C}Pe.p32=l;function d(_){return e(_,2)^e(_,13)^e(_,22)}Pe.s0_256=d;function n(_){return e(_,6)^e(_,11)^e(_,25)}Pe.s1_256=n;function c(_){return e(_,7)^e(_,18)^_>>>3}Pe.g0_256=c;function w(_){return e(_,17)^e(_,19)^_>>>10}return Pe.g1_256=w,Pe}var Ln,pa;function Uu(){if(pa)return Ln;pa=1;var i=Me(),e=Ot(),t=vo(),a=i.rotl32,h=i.sum32,l=i.sum32_5,d=t.ft_1,n=e.BlockHash,c=[1518500249,1859775393,2400959708,3395469782];function w(){if(!(this instanceof w))return new w;n.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return i.inherits(w,n),Ln=w,w.blockSize=512,w.outSize=160,w.hmacStrength=80,w.padLength=64,w.prototype._update=function(k,C){for(var E=this.W,R=0;R<16;R++)E[R]=k[C+R];for(;R<E.length;R++)E[R]=a(E[R-3]^E[R-8]^E[R-14]^E[R-16],1);var b=this.h[0],T=this.h[1],o=this.h[2],y=this.h[3],m=this.h[4];for(R=0;R<E.length;R++){var u=~~(R/20),A=l(a(b,5),d(u,T,o,y),m,E[R],c[u]);m=y,y=o,o=a(T,30),T=b,b=A}this.h[0]=h(this.h[0],b),this.h[1]=h(this.h[1],T),this.h[2]=h(this.h[2],o),this.h[3]=h(this.h[3],y),this.h[4]=h(this.h[4],m)},w.prototype._digest=function(k){return k==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")},Ln}var Mn,ma;function bo(){if(ma)return Mn;ma=1;var i=Me(),e=Ot(),t=vo(),a=Ft(),h=i.sum32,l=i.sum32_4,d=i.sum32_5,n=t.ch32,c=t.maj32,w=t.s0_256,_=t.s1_256,k=t.g0_256,C=t.g1_256,E=e.BlockHash,R=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;E.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=R,this.W=new Array(64)}return i.inherits(b,E),Mn=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(o,y){for(var m=this.W,u=0;u<16;u++)m[u]=o[y+u];for(;u<m.length;u++)m[u]=l(C(m[u-2]),m[u-7],k(m[u-15]),m[u-16]);var A=this.h[0],P=this.h[1],j=this.h[2],q=this.h[3],N=this.h[4],Y=this.h[5],ue=this.h[6],I=this.h[7];for(a(this.k.length===m.length),u=0;u<m.length;u++){var U=d(I,_(N),n(N,Y,ue),this.k[u],m[u]),x=h(w(A),c(A,P,j));I=ue,ue=Y,Y=N,N=h(q,U),q=j,j=P,P=A,A=h(U,x)}this.h[0]=h(this.h[0],A),this.h[1]=h(this.h[1],P),this.h[2]=h(this.h[2],j),this.h[3]=h(this.h[3],q),this.h[4]=h(this.h[4],N),this.h[5]=h(this.h[5],Y),this.h[6]=h(this.h[6],ue),this.h[7]=h(this.h[7],I)},b.prototype._digest=function(o){return o==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")},Mn}var Un,ga;function zu(){if(ga)return Un;ga=1;var i=Me(),e=bo();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return i.inherits(t,e),Un=t,t.blockSize=512,t.outSize=224,t.hmacStrength=192,t.padLength=64,t.prototype._digest=function(h){return h==="hex"?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")},Un}var zn,wa;function xo(){if(wa)return zn;wa=1;var i=Me(),e=Ot(),t=Ft(),a=i.rotr64_hi,h=i.rotr64_lo,l=i.shr64_hi,d=i.shr64_lo,n=i.sum64,c=i.sum64_hi,w=i.sum64_lo,_=i.sum64_4_hi,k=i.sum64_4_lo,C=i.sum64_5_hi,E=i.sum64_5_lo,R=e.BlockHash,b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function T(){if(!(this instanceof T))return new T;R.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=b,this.W=new Array(160)}i.inherits(T,R),zn=T,T.blockSize=1024,T.outSize=512,T.hmacStrength=192,T.padLength=128,T.prototype._prepareBlock=function(x,Z){for(var re=this.W,H=0;H<32;H++)re[H]=x[Z+H];for(;H<re.length;H+=2){var ie=ue(re[H-4],re[H-3]),te=I(re[H-4],re[H-3]),ee=re[H-14],V=re[H-13],O=N(re[H-30],re[H-29]),X=Y(re[H-30],re[H-29]),J=re[H-32],ne=re[H-31];re[H]=_(ie,te,ee,V,O,X,J,ne),re[H+1]=k(ie,te,ee,V,O,X,J,ne)}},T.prototype._update=function(x,Z){this._prepareBlock(x,Z);var re=this.W,H=this.h[0],ie=this.h[1],te=this.h[2],ee=this.h[3],V=this.h[4],O=this.h[5],X=this.h[6],J=this.h[7],ne=this.h[8],$=this.h[9],S=this.h[10],v=this.h[11],K=this.h[12],L=this.h[13],F=this.h[14],B=this.h[15];t(this.k.length===re.length);for(var Q=0;Q<re.length;Q+=2){var p=F,M=B,g=j(ne,$),r=q(ne,$),s=o(ne,$,S,v,K),f=y(ne,$,S,v,K,L),D=this.k[Q],G=this.k[Q+1],z=re[Q],se=re[Q+1],ce=C(p,M,g,r,s,f,D,G,z,se),oe=E(p,M,g,r,s,f,D,G,z,se);p=A(H,ie),M=P(H,ie),g=m(H,ie,te,ee,V),r=u(H,ie,te,ee,V,O);var fe=c(p,M,g,r),de=w(p,M,g,r);F=K,B=L,K=S,L=v,S=ne,v=$,ne=c(X,J,ce,oe),$=w(J,J,ce,oe),X=V,J=O,V=te,O=ee,te=H,ee=ie,H=c(ce,oe,fe,de),ie=w(ce,oe,fe,de)}n(this.h,0,H,ie),n(this.h,2,te,ee),n(this.h,4,V,O),n(this.h,6,X,J),n(this.h,8,ne,$),n(this.h,10,S,v),n(this.h,12,K,L),n(this.h,14,F,B)},T.prototype._digest=function(x){return x==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")};function o(U,x,Z,re,H){var ie=U&Z^~U&H;return ie<0&&(ie+=4294967296),ie}function y(U,x,Z,re,H,ie){var te=x&re^~x&ie;return te<0&&(te+=4294967296),te}function m(U,x,Z,re,H){var ie=U&Z^U&H^Z&H;return ie<0&&(ie+=4294967296),ie}function u(U,x,Z,re,H,ie){var te=x&re^x&ie^re&ie;return te<0&&(te+=4294967296),te}function A(U,x){var Z=a(U,x,28),re=a(x,U,2),H=a(x,U,7),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}function P(U,x){var Z=h(U,x,28),re=h(x,U,2),H=h(x,U,7),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}function j(U,x){var Z=a(U,x,14),re=a(U,x,18),H=a(x,U,9),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}function q(U,x){var Z=h(U,x,14),re=h(U,x,18),H=h(x,U,9),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}function N(U,x){var Z=a(U,x,1),re=a(U,x,8),H=l(U,x,7),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}function Y(U,x){var Z=h(U,x,1),re=h(U,x,8),H=d(U,x,7),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}function ue(U,x){var Z=a(U,x,19),re=a(x,U,29),H=l(U,x,6),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}function I(U,x){var Z=h(U,x,19),re=h(x,U,29),H=d(U,x,6),ie=Z^re^H;return ie<0&&(ie+=4294967296),ie}return zn}var Wn,ya;function Wu(){if(ya)return Wn;ya=1;var i=Me(),e=xo();function t(){if(!(this instanceof t))return new t;e.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return i.inherits(t,e),Wn=t,t.blockSize=1024,t.outSize=384,t.hmacStrength=192,t.padLength=128,t.prototype._digest=function(h){return h==="hex"?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")},Wn}var va;function Hu(){return va||(va=1,Qe.sha1=Uu(),Qe.sha224=zu(),Qe.sha256=bo(),Qe.sha384=Wu(),Qe.sha512=xo()),Qe}var Hn={},ba;function qu(){if(ba)return Hn;ba=1;var i=Me(),e=Ot(),t=i.rotl32,a=i.sum32,h=i.sum32_3,l=i.sum32_4,d=e.BlockHash;function n(){if(!(this instanceof n))return new n;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}i.inherits(n,d),Hn.ripemd160=n,n.blockSize=512,n.outSize=160,n.hmacStrength=192,n.padLength=64,n.prototype._update=function(T,o){for(var y=this.h[0],m=this.h[1],u=this.h[2],A=this.h[3],P=this.h[4],j=y,q=m,N=u,Y=A,ue=P,I=0;I<80;I++){var U=a(t(l(y,c(I,m,u,A),T[k[I]+o],w(I)),E[I]),P);y=P,P=A,A=t(u,10),u=m,m=U,U=a(t(l(j,c(79-I,q,N,Y),T[C[I]+o],_(I)),R[I]),ue),j=ue,ue=Y,Y=t(N,10),N=q,q=U}U=h(this.h[1],u,Y),this.h[1]=h(this.h[2],A,ue),this.h[2]=h(this.h[3],P,j),this.h[3]=h(this.h[4],y,q),this.h[4]=h(this.h[0],m,N),this.h[0]=U},n.prototype._digest=function(T){return T==="hex"?i.toHex32(this.h,"little"):i.split32(this.h,"little")};function c(b,T,o,y){return b<=15?T^o^y:b<=31?T&o|~T&y:b<=47?(T|~o)^y:b<=63?T&y|o&~y:T^(o|~y)}function w(b){return b<=15?0:b<=31?1518500249:b<=47?1859775393:b<=63?2400959708:2840853838}function _(b){return b<=15?1352829926:b<=31?1548603684:b<=47?1836072691:b<=63?2053994217:0}var k=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],C=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],E=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],R=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return Hn}var qn,xa;function Ku(){if(xa)return qn;xa=1;var i=Me(),e=Ft();function t(a,h,l){if(!(this instanceof t))return new t(a,h,l);this.Hash=a,this.blockSize=a.blockSize/8,this.outSize=a.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(h,l))}return qn=t,t.prototype._init=function(h){h.length>this.blockSize&&(h=new this.Hash().update(h).digest()),e(h.length<=this.blockSize);for(var l=h.length;l<this.blockSize;l++)h.push(0);for(l=0;l<h.length;l++)h[l]^=54;for(this.inner=new this.Hash().update(h),l=0;l<h.length;l++)h[l]^=106;this.outer=new this.Hash().update(h)},t.prototype.update=function(h,l){return this.inner.update(h,l),this},t.prototype.digest=function(h){return this.outer.update(this.inner.digest()),this.outer.digest(h)},qn}var _a;function Gu(){return _a||(_a=1,function(i){var e=i;e.utils=Me(),e.common=Ot(),e.sha=Hu(),e.ripemd=qu(),e.hmac=Ku(),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(Bn)),Bn}Gu();let Vu="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Xu=(i,e=21)=>(t=e)=>{let a="",h=t|0;for(;h--;)a+=i[Math.random()*i.length|0];return a},$u=(i=21)=>{let e="",t=i|0;for(;t--;)e+=Vu[Math.random()*64|0];return e};const Fe=i=>Math.floor(i*72*20),Ai=(i=0)=>{let e=i;return()=>++e},Zu=()=>Ai(),Yu=()=>Ai(1),Ju=()=>Ai(),Qu=()=>$u().toLowerCase(),Tt=i=>Xu("1234567890abcdef",i)(),ec=()=>`${Tt(8)}-${Tt(4)}-${Tt(4)}-${Tt(4)}-${Tt(12)}`;class tc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{xmlns:"xmlns"})}}class rc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const nc={EXTERNAL:"External"};class ic extends le{constructor(e,t,a,h){super("Relationship"),this.root.push(new rc({id:e,type:t,target:a,targetMode:h}))}}class lt extends le{constructor(){super("Relationships"),this.root.push(new tc({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,t,a,h){const l=new ic(`rId${e}`,t,a,h);return this.root.push(l),l}get RelationshipCount(){return this.root.length-1}}class sc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class ac extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class oc extends le{constructor({id:e,initials:t,author:a,date:h=new Date,children:l}){super("w:comment"),this.root.push(new sc({id:e,initials:t,author:a,date:h.toISOString()}));for(const d of l)this.root.push(d)}}class lc extends le{constructor({children:e}){super("w:comments"),ae(this,"relationships"),this.root.push(new ac({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const t of e)this.root.push(new oc(t));this.relationships=new lt}get Relationships(){return this.relationships}}class uc extends le{constructor(){super("w:pageBreakBefore")}}const oi={AUTO:"auto"};class cc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}}class hc extends le{constructor(e){super("w:spacing"),this.root.push(new cc(e))}}const Ea={HEADING_1:"Heading1",HEADING_2:"Heading2"};let Gt=class extends le{constructor(e){super("w:pStyle"),this.root.push(new _e({val:e}))}};class fc extends le{constructor(e){super("w:tabs");for(const t of e)this.root.push(new pc(t))}}const Sa={LEFT:"left",RIGHT:"right"};class dc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class pc extends le{constructor({type:e,position:t,leader:a}){super("w:tab"),this.root.push(new dc({val:e,pos:t,leader:a}))}}class Kn extends le{constructor(e,t){super("w:numPr"),this.root.push(new mc(t)),this.root.push(new gc(e))}}class mc extends le{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new _e({val:e}))}}class gc extends le{constructor(e){super("w:numId"),this.root.push(new _e({val:typeof e=="string"?`{${e}}`:e}))}}class _o extends le{constructor(){super(...arguments),ae(this,"fileChild",Symbol())}}class wc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class yc extends le{constructor(e,t,a){super("w:hyperlink"),ae(this,"linkId"),this.linkId=t;const h={history:1,anchor:a||void 0,id:a?void 0:`rId${this.linkId}`},l=new wc(h);this.root.push(l),e.forEach(d=>{this.root.push(d)})}}class vc extends le{constructor(e){super("w:externalHyperlink"),this.options=e}}class bc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class xc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{id:"w:id"})}}class _c{constructor(e){ae(this,"bookmarkUniqueNumericId",Ju()),ae(this,"start"),ae(this,"children"),ae(this,"end");const t=this.bookmarkUniqueNumericId();this.start=new Ec(e.id,t),this.children=e.children,this.end=new Sc(t)}}class Ec extends le{constructor(e,t){super("w:bookmarkStart");const a=new bc({name:e,id:t});this.root.push(a)}}class Sc extends le{constructor(e){super("w:bookmarkEnd");const t=new xc({id:e});this.root.push(t)}}class Ac extends le{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new _e({val:e}))}}const Tc={TOP:"top",CENTER:"center",BOTTOM:"bottom"};it(we({},Tc),{BOTH:"both"});class kc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{verticalAlign:"w:val"})}}class Eo extends le{constructor(e){super("w:vAlign"),this.root.push(new kc({verticalAlign:e}))}}class Rc extends le{constructor({space:e,count:t,separate:a,equalWidth:h,children:l}){super("w:cols"),this.root.push(new $e({space:{key:"w:space",value:e===void 0?void 0:Ae(e)},count:{key:"w:num",value:t===void 0?void 0:Te(t)},separate:{key:"w:sep",value:a},equalWidth:{key:"w:equalWidth",value:h}})),!h&&l&&l.forEach(d=>this.addChildElement(d))}}const Cc=({type:i,linePitch:e,charSpace:t})=>new Le({name:"w:docGrid",attributes:{type:{key:"w:type",value:i},linePitch:{key:"w:linePitch",value:Te(e)},charSpace:{key:"w:charSpace",value:t?Te(t):void 0}}}),pt={DEFAULT:"default",FIRST:"first",EVEN:"even"};class Nc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const Aa={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class Gn extends le{constructor(e,t){super(e),this.root.push(new Nc({type:t.type||pt.DEFAULT,id:`rId${t.id}`}))}}const Ic=({countBy:i,start:e,restart:t,distance:a})=>new Le({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:i===void 0?void 0:Te(i)},start:{key:"w:start",value:e===void 0?void 0:Te(e)},restart:{key:"w:restart",value:t},distance:{key:"w:distance",value:a===void 0?void 0:Ae(a)}}});class Ta extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class Fc extends Ke{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new Ta({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new Ta({})),e.pageBorderTop&&this.root.push(new ve("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new ve("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new ve("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new ve("w:right",e.pageBorderRight))}}class Oc extends le{constructor(e,t,a,h,l,d,n){super("w:pgMar"),this.root.push(new $e({top:{key:"w:top",value:qe(e)},right:{key:"w:right",value:Ae(t)},bottom:{key:"w:bottom",value:qe(a)},left:{key:"w:left",value:Ae(h)},header:{key:"w:header",value:Ae(l)},footer:{key:"w:footer",value:Ae(d)},gutter:{key:"w:gutter",value:Ae(n)}}))}}class Pc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class Bc extends le{constructor({start:e,formatType:t,separator:a}){super("w:pgNumType"),this.root.push(new Pc({start:e===void 0?void 0:Te(e),formatType:t,separator:a}))}}const li={PORTRAIT:"portrait",LANDSCAPE:"landscape"},Dc=({width:i,height:e,orientation:t,code:a})=>{const h=Ae(i),l=Ae(e);return new Le({name:"w:pgSz",attributes:{width:{key:"w:w",value:t===li.LANDSCAPE?l:h},height:{key:"w:h",value:t===li.LANDSCAPE?h:l},orientation:{key:"w:orient",value:t},code:{key:"w:code",value:a}}})};class jc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class Lc extends le{constructor(e){super("w:textDirection"),this.root.push(new jc({val:e}))}}class Mc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class Uc extends le{constructor(e){super("w:type"),this.root.push(new Mc({val:e}))}}const et={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},Vn={WIDTH:11906,HEIGHT:16838,ORIENTATION:li.PORTRAIT};class zc extends le{constructor({page:{size:{width:e=Vn.WIDTH,height:t=Vn.HEIGHT,orientation:a=Vn.ORIENTATION}={},margin:{top:h=et.TOP,right:l=et.RIGHT,bottom:d=et.BOTTOM,left:n=et.LEFT,header:c=et.HEADER,footer:w=et.FOOTER,gutter:_=et.GUTTER}={},pageNumbers:k={},borders:C,textDirection:E}={},grid:{linePitch:R=360,charSpace:b,type:T}={},headerWrapperGroup:o={},footerWrapperGroup:y={},lineNumbers:m,titlePage:u,verticalAlign:A,column:P,type:j}={}){super("w:sectPr"),this.addHeaderFooterGroup(Aa.HEADER,o),this.addHeaderFooterGroup(Aa.FOOTER,y),j&&this.root.push(new Uc(j)),this.root.push(Dc({width:e,height:t,orientation:a})),this.root.push(new Oc(h,l,d,n,c,w,_)),C&&this.root.push(new Fc(C)),m&&this.root.push(Ic(m)),this.root.push(new Bc(k)),P&&this.root.push(new Rc(P)),A&&this.root.push(new Eo(A)),u!==void 0&&this.root.push(new he("w:titlePg",u)),E&&this.root.push(new Lc(E)),this.root.push(Cc({linePitch:R,charSpace:b,type:T}))}addHeaderFooterGroup(e,t){t.default&&this.root.push(new Gn(e,{type:pt.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new Gn(e,{type:pt.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new Gn(e,{type:pt.EVEN,id:t.even.View.ReferenceId}))}}class Wc extends le{constructor(){super("w:body"),ae(this,"sections",[])}addSection(e){const t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new zc(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){const t=new Re({}),a=new vt({});return a.push(e),t.addChildElement(a),t}}const ka={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"};class nr extends pe{constructor(e,t){super(we({Ignorable:t},Object.fromEntries(e.map(a=>[a,ka[a]])))),ae(this,"xmlKeys",we({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(ka).map(a=>[a,`xmlns:${a}`]))))}}class Hc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class qc extends le{constructor(e){super("w:background"),this.root.push(new Hc({color:e.color===void 0?void 0:gt(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:oa(e.themeShade),themeTint:e.themeTint===void 0?void 0:oa(e.themeTint)}))}}class Kc extends le{constructor(e){super("w:document"),ae(this,"body"),this.root.push(new nr(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new Wc,e.background&&this.root.push(new qc(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}}class So{constructor(e){ae(this,"document"),ae(this,"relationships"),this.document=new Kc(e),this.relationships=new lt}get View(){return this.document}get Relationships(){return this.relationships}}class Gc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class Vc extends le{constructor(){super("w:wordWrap"),this.root.push(new Gc({val:0}))}}const Xc=i=>{var e,t;return new Le({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:i.anchorLock},dropCap:{key:"w:dropCap",value:i.dropCap},width:{key:"w:w",value:i.width},height:{key:"w:h",value:i.height},x:{key:"w:x",value:i.position?i.position.x:void 0},y:{key:"w:y",value:i.position?i.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:i.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:i.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=i.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(t=i.space)==null?void 0:t.vertical},rule:{key:"w:hRule",value:i.rule},alignmentX:{key:"w:xAlign",value:i.alignment?i.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:i.alignment?i.alignment.y:void 0},lines:{key:"w:lines",value:i.lines},wrap:{key:"w:wrap",value:i.wrap}}})};class vt extends Ke{constructor(e){var t,a;if(super("w:pPr"),ae(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new Gt(e.heading)),e.bullet&&this.push(new Gt("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new Gt("ListParagraph"))),e.style&&this.push(new Gt(e.style)),e.keepNext!==void 0&&this.push(new he("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new he("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new uc),e.frame&&this.push(Xc(e.frame)),e.widowControl!==void 0&&this.push(new he("w:widowControl",e.widowControl)),e.bullet&&this.push(new Kn(1,e.bullet.level)),e.numbering?(this.numberingReferences.push({reference:e.numbering.reference,instance:(t=e.numbering.instance)!=null?t:0}),this.push(new Kn(`${e.numbering.reference}-${(a=e.numbering.instance)!=null?a:0}`,e.numbering.level))):e.numbering===!1&&this.push(new Kn(0,0)),e.border&&this.push(new yu(e.border)),e.thematicBreak&&this.push(new vu),e.shading&&this.push(new tr(e.shading)),e.wordWrap&&this.push(new Vc),e.overflowPunctuation&&this.push(new he("w:overflowPunct",e.overflowPunctuation));const h=[...e.rightTabStop!==void 0?[{type:Sa.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:Sa.LEFT,position:e.leftTabStop}]:[]];h.length>0&&this.push(new fc(h)),e.bidirectional!==void 0&&this.push(new he("w:bidi",e.bidirectional)),e.spacing&&this.push(new hc(e.spacing)),e.indent&&this.push(new bu(e.indent)),e.contextualSpacing!==void 0&&this.push(new he("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new go(e.alignment)),e.outlineLevel!==void 0&&this.push(new Ac(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new he("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new he("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new ot(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof So)for(const t of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(t.reference,t.instance);return super.prepForXml(e)}}class Re extends _o{constructor(e){if(super("w:p"),ae(this,"properties"),typeof e=="string")return this.properties=new vt({}),this.root.push(this.properties),this.root.push(new Be(e)),this;if(this.properties=new vt(e),this.root.push(this.properties),e.text&&this.root.push(new Be(e.text)),e.children)for(const t of e.children){if(t instanceof _c){this.root.push(t.start);for(const a of t.children)this.root.push(a);this.root.push(t.end);continue}this.root.push(t)}}prepForXml(e){for(const t of this.root)if(t instanceof vc){const a=this.root.indexOf(t),h=new yc(t.options.children,Qu());e.viewWrapper.Relationships.createRelationship(h.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.options.link,nc.EXTERNAL),this.root[a]=h}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}}class $c extends le{constructor(e){super("w:tblGrid");for(const t of e)this.root.push(new Zc(t))}}class Zc extends le{constructor(e){super("w:gridCol"),e!==void 0&&this.root.push(new $e({width:{key:"w:w",value:Ae(e)}}))}}const Ao={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"};class To extends Ke{constructor(e,{marginUnitType:t=Xe.DXA,top:a,left:h,bottom:l,right:d}){super(e),a!==void 0&&this.root.push(new nt("w:top",{type:t,size:a})),h!==void 0&&this.root.push(new nt("w:left",{type:t,size:h})),l!==void 0&&this.root.push(new nt("w:bottom",{type:t,size:l})),d!==void 0&&this.root.push(new nt("w:right",{type:t,size:d}))}}const Xe={AUTO:"auto",DXA:"dxa",PERCENTAGE:"pct"};class nt extends le{constructor(e,{type:t=Xe.AUTO,size:a}){super(e);let h=a;t===Xe.PERCENTAGE&&typeof a=="number"&&(h=`${a}%`),this.root.push(new $e({type:{key:"w:type",value:t},size:{key:"w:w",value:mo(h)}}))}}class Yc extends Ke{constructor(e){super("w:tcBorders"),e.top&&this.root.push(new ve("w:top",e.top)),e.start&&this.root.push(new ve("w:start",e.start)),e.left&&this.root.push(new ve("w:left",e.left)),e.bottom&&this.root.push(new ve("w:bottom",e.bottom)),e.end&&this.root.push(new ve("w:end",e.end)),e.right&&this.root.push(new ve("w:right",e.right))}}class Jc extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class Qc extends le{constructor(e){super("w:gridSpan"),this.root.push(new Jc({val:Te(e)}))}}const ko={CONTINUE:"continue",RESTART:"restart"};class eh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class Ra extends le{constructor(e){super("w:vMerge"),this.root.push(new eh({val:e}))}}class th extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class rh extends le{constructor(e){super("w:textDirection"),this.root.push(new th({val:e}))}}class nh extends Ke{constructor(e){super("w:tcPr"),e.width&&this.root.push(new nt("w:tcW",e.width)),e.columnSpan&&this.root.push(new Qc(e.columnSpan)),e.verticalMerge?this.root.push(new Ra(e.verticalMerge)):e.rowSpan&&e.rowSpan>1&&this.root.push(new Ra(ko.RESTART)),e.borders&&this.root.push(new Yc(e.borders)),e.shading&&this.root.push(new tr(e.shading)),e.margins&&this.root.push(new To(Ao.TABLE_CELL,e.margins)),e.textDirection&&this.root.push(new rh(e.textDirection)),e.verticalAlign&&this.root.push(new Eo(e.verticalAlign))}}class ft extends le{constructor(e){super("w:tc"),this.options=e,this.root.push(new nh(e));for(const t of e.children)this.root.push(t)}prepForXml(e){return this.root[this.root.length-1]instanceof Re||this.root.push(new Re({})),super.prepForXml(e)}}const ut={style:_i.NONE,size:0,color:"auto"},ct={style:_i.SINGLE,size:4,color:"auto"};class Ro extends le{constructor(e){super("w:tblBorders"),e.top?this.root.push(new ve("w:top",e.top)):this.root.push(new ve("w:top",ct)),e.left?this.root.push(new ve("w:left",e.left)):this.root.push(new ve("w:left",ct)),e.bottom?this.root.push(new ve("w:bottom",e.bottom)):this.root.push(new ve("w:bottom",ct)),e.right?this.root.push(new ve("w:right",e.right)):this.root.push(new ve("w:right",ct)),e.insideHorizontal?this.root.push(new ve("w:insideH",e.insideHorizontal)):this.root.push(new ve("w:insideH",ct)),e.insideVertical?this.root.push(new ve("w:insideV",e.insideVertical)):this.root.push(new ve("w:insideV",ct))}}ae(Ro,"NONE",{top:ut,bottom:ut,left:ut,right:ut,insideHorizontal:ut,insideVertical:ut});class ih extends le{constructor({horizontalAnchor:e,verticalAnchor:t,absoluteHorizontalPosition:a,relativeHorizontalPosition:h,absoluteVerticalPosition:l,relativeVerticalPosition:d,bottomFromText:n,topFromText:c,leftFromText:w,rightFromText:_,overlap:k}){super("w:tblpPr"),this.root.push(new $e({leftFromText:{key:"w:leftFromText",value:w===void 0?void 0:Ae(w)},rightFromText:{key:"w:rightFromText",value:_===void 0?void 0:Ae(_)},topFromText:{key:"w:topFromText",value:c===void 0?void 0:Ae(c)},bottomFromText:{key:"w:bottomFromText",value:n===void 0?void 0:Ae(n)},absoluteHorizontalPosition:{key:"w:tblpX",value:a===void 0?void 0:qe(a)},absoluteVerticalPosition:{key:"w:tblpY",value:l===void 0?void 0:qe(l)},horizontalAnchor:{key:"w:horzAnchor",value:e===void 0?void 0:e},relativeHorizontalPosition:{key:"w:tblpXSpec",value:h},relativeVerticalPosition:{key:"w:tblpYSpec",value:d},verticalAnchor:{key:"w:vertAnchor",value:t}})),k&&this.root.push(new mu("w:tblOverlap",k))}}class sh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{type:"w:type"})}}class ah extends le{constructor(e){super("w:tblLayout"),this.root.push(new sh({type:e}))}}const oh={DXA:"dxa"};class Co extends le{constructor({type:e=oh.DXA,value:t}){super("w:tblCellSpacing"),this.root.push(new $e({type:{key:"w:type",value:e},value:{key:"w:w",value:mo(t)}}))}}class lh extends Ke{constructor(e){super("w:tblPr"),e.style&&this.root.push(new st("w:tblStyle",e.style)),e.float&&this.root.push(new ih(e.float)),e.visuallyRightToLeft!==void 0&&this.root.push(new he("w:bidiVisual",e.visuallyRightToLeft)),e.width&&this.root.push(new nt("w:tblW",e.width)),e.alignment&&this.root.push(new go(e.alignment)),e.indent&&this.root.push(new nt("w:tblInd",e.indent)),e.borders&&this.root.push(new Ro(e.borders)),e.shading&&this.root.push(new tr(e.shading)),e.layout&&this.root.push(new ah(e.layout)),e.cellMargin&&this.root.push(new To(Ao.TABLE,e.cellMargin)),e.cellSpacing&&this.root.push(new Co(e.cellSpacing))}}class uh extends _o{constructor({rows:e,width:t,columnWidths:a=Array(Math.max(...e.map(E=>E.CellCount))).fill(100),margins:h,indent:l,float:d,layout:n,style:c,borders:w,alignment:_,visuallyRightToLeft:k,cellSpacing:C}){super("w:tbl"),this.root.push(new lh({borders:w??{},width:t??{size:100},indent:l,float:d,layout:n,style:c,alignment:_,cellMargin:h,visuallyRightToLeft:k,cellSpacing:C})),this.root.push(new $c(a));for(const E of e)this.root.push(E);e.forEach((E,R)=>{if(R===e.length-1)return;let b=0;E.cells.forEach(T=>{if(T.options.rowSpan&&T.options.rowSpan>1){const o=new ft({rowSpan:T.options.rowSpan-1,columnSpan:T.options.columnSpan,borders:T.options.borders,children:[],verticalMerge:ko.CONTINUE});e[R+1].addCellToColumnIndex(o,b)}b+=T.options.columnSpan||1})})}}class ch extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}}class hh extends le{constructor(e,t){super("w:trHeight"),this.root.push(new ch({value:Ae(e),rule:t}))}}class fh extends Ke{constructor(e){super("w:trPr"),e.cantSplit!==void 0&&this.root.push(new he("w:cantSplit",e.cantSplit)),e.tableHeader!==void 0&&this.root.push(new he("w:tblHeader",e.tableHeader)),e.height&&this.root.push(new hh(e.height.value,e.height.rule)),e.cellSpacing&&this.root.push(new Co(e.cellSpacing))}}class Ca extends le{constructor(e){super("w:tr"),this.options=e,this.root.push(new fh(e));for(const t of e.children)this.root.push(t)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(e=>e instanceof ft)}addCellToIndex(e,t){this.root.splice(t+1,0,e)}addCellToColumnIndex(e,t){const a=this.columnIndexToRootIndex(t,!0);this.addCellToIndex(e,a-1)}rootIndexToColumnIndex(e){if(e<1||e>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let t=0;for(let a=1;a<e;a++){const h=this.root[a];t+=h.options.columnSpan||1}return t}columnIndexToRootIndex(e,t=!1){if(e<0)throw new Error("cell 'columnIndex' should not less than zero");let a=0,h=1;for(;a<=e;){if(h>=this.root.length){if(t)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${a-1}`)}const l=this.root[h];h+=1,a+=l&&l.options.columnSpan||1}return h-1}}class dh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class ph extends le{constructor(){super("Properties"),this.root.push(new dh({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class mh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{xmlns:"xmlns"})}}class gh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class ze extends le{constructor(e,t){super("Default"),this.root.push(new gh({contentType:e,extension:t}))}}class wh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class Ne extends le{constructor(e,t){super("Override"),this.root.push(new wh({contentType:e,partName:t}))}}class yh extends le{constructor(){super("Types"),this.root.push(new mh({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new ze("image/png","png")),this.root.push(new ze("image/jpeg","jpeg")),this.root.push(new ze("image/jpeg","jpg")),this.root.push(new ze("image/bmp","bmp")),this.root.push(new ze("image/gif","gif")),this.root.push(new ze("image/svg+xml","svg")),this.root.push(new ze("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new ze("application/xml","xml")),this.root.push(new ze("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new Ne("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new Ne("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}class vh extends le{constructor(e){super("cp:coreProperties"),this.root.push(new nr(["cp","dc","dcterms","dcmitype","xsi"])),e.title&&this.root.push(new Je("dc:title",e.title)),e.subject&&this.root.push(new Je("dc:subject",e.subject)),e.creator&&this.root.push(new Je("dc:creator",e.creator)),e.keywords&&this.root.push(new Je("cp:keywords",e.keywords)),e.description&&this.root.push(new Je("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new Je("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new Je("cp:revision",String(e.revision))),this.root.push(new Na("dcterms:created")),this.root.push(new Na("dcterms:modified"))}}class bh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{type:"xsi:type"})}}class Na extends le{constructor(e){super(e),this.root.push(new bh({type:"dcterms:W3CDTF"})),this.root.push(pu(new Date))}}class xh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class _h extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{formatId:"fmtid",pid:"pid",name:"name"})}}class Eh extends le{constructor(e,t){super("property"),this.root.push(new _h({formatId:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:t.name})),this.root.push(new Sh(t.value))}}class Sh extends le{constructor(e){super("vt:lpwstr"),this.root.push(e)}}class Ah extends le{constructor(e){super("Properties"),ae(this,"nextId"),ae(this,"properties",[]),this.root.push(new xh({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const t of e)this.addCustomProperty(t)}prepForXml(e){return this.properties.forEach(t=>this.root.push(t)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new Eh(this.nextId++,e))}}const Vt=({id:i,fontKey:e,subsetted:t},a)=>new Le({name:a,attributes:we({id:{key:"r:id",value:i}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...t?[new he("w:subsetted",t)]:[]]}),Th=({name:i,altName:e,panose1:t,charset:a,family:h,notTrueType:l,pitch:d,sig:n,embedRegular:c,embedBold:w,embedItalic:_,embedBoldItalic:k})=>new Le({name:"w:font",attributes:{name:{key:"w:name",value:i}},children:[...e?[At("w:altName",e)]:[],...t?[At("w:panose1",t)]:[],...a?[At("w:charset",a)]:[],At("w:family",h),...l?[new he("w:notTrueType",l)]:[],At("w:pitch",d),...n?[new Le({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:n.usb0},usb1:{key:"w:usb1",value:n.usb1},usb2:{key:"w:usb2",value:n.usb2},usb3:{key:"w:usb3",value:n.usb3},csb0:{key:"w:csb0",value:n.csb0},csb1:{key:"w:csb1",value:n.csb1}}})]:[],...c?[Vt(c,"w:embedRegular")]:[],...w?[Vt(w,"w:embedBold")]:[],..._?[Vt(_,"w:embedItalic")]:[],...k?[Vt(k,"w:embedBoldItalic")]:[]]}),kh=({name:i,index:e,fontKey:t,characterSet:a})=>Th({name:i,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:a,family:"auto",pitch:"variable",embedRegular:{fontKey:t,id:`rId${e}`}}),Rh=i=>new Le({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:i.map((e,t)=>kh({name:e.name,index:t+1,fontKey:e.fontKey}))});class Ch{constructor(e){ae(this,"fontTable"),ae(this,"relationships"),ae(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(t=>it(we({},t),{fontKey:ec()})),this.fontTable=Rh(this.fontOptionsWithKey),this.relationships=new lt;for(let t=0;t<e.length;t++)this.relationships.createRelationship(t+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[t].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class Nh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let Ih=class extends ho{constructor(e,t){super("w:ftr",t),ae(this,"refId"),this.refId=e,t||this.root.push(new Nh({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Fh{constructor(e,t,a){ae(this,"footer"),ae(this,"relationships"),this.media=e,this.footer=new Ih(t,a),this.relationships=new lt}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Oh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class Ph extends le{constructor(){super("w:footnoteRef")}}class Bh extends rr{constructor(){super({style:"FootnoteReference"}),this.root.push(new Ph)}}const Ia={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class Xn extends le{constructor(e){super("w:footnote"),this.root.push(new Oh({type:e.type,id:e.id}));for(let t=0;t<e.children.length;t++){const a=e.children[t];t===0&&a.addRunToFront(new Bh),this.root.push(a)}}}class Dh extends le{constructor(){super("w:continuationSeparator")}}class jh extends rr{constructor(){super({}),this.root.push(new Dh)}}class Lh extends le{constructor(){super("w:separator")}}class Mh extends rr{constructor(){super({}),this.root.push(new Lh)}}class Uh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class zh extends le{constructor(){super("w:footnotes"),this.root.push(new Uh({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new Xn({id:-1,type:Ia.SEPERATOR,children:[new Re({spacing:{after:0,line:240,lineRule:oi.AUTO},children:[new Mh]})]});this.root.push(e);const t=new Xn({id:0,type:Ia.CONTINUATION_SEPERATOR,children:[new Re({spacing:{after:0,line:240,lineRule:oi.AUTO},children:[new jh]})]});this.root.push(t)}createFootNote(e,t){const a=new Xn({id:e,children:t});this.root.push(a)}}class Wh{constructor(){ae(this,"footnotess"),ae(this,"relationships"),this.footnotess=new zh,this.relationships=new lt}get View(){return this.footnotess}get Relationships(){return this.relationships}}class Hh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let qh=class extends ho{constructor(e,t){super("w:hdr",t),ae(this,"refId"),this.refId=e,t||this.root.push(new Hh({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Kh{constructor(e,t,a){ae(this,"header"),ae(this,"relationships"),this.media=e,this.header=new qh(t,a),this.relationships=new lt}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class Gh{constructor(){ae(this,"map"),this.map=new Map}addImage(e,t){this.map.set(e,t)}get Array(){return Array.from(this.map.values())}}const We={BULLET:"bullet"};class Vh extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class Xh extends le{constructor(e){super("w:numFmt"),this.root.push(new _e({val:e}))}}class $h extends le{constructor(e){super("w:lvlText"),this.root.push(new _e({val:e}))}}class Zh extends le{constructor(e){super("w:lvlJc"),this.root.push(new _e({val:e}))}}class Yh extends le{constructor(e){super("w:suff"),this.root.push(new _e({val:e}))}}class Jh extends le{constructor(){super("w:isLgl")}}class Qh extends le{constructor({level:e,format:t,text:a,alignment:h=Ce.START,start:l=1,style:d,suffix:n,isLegalNumberingStyle:c}){if(super("w:lvl"),ae(this,"paragraphProperties"),ae(this,"runProperties"),this.root.push(new Ct("w:start",Te(l))),t&&this.root.push(new Xh(t)),n&&this.root.push(new Yh(n)),c&&this.root.push(new Jh),a&&this.root.push(new $h(a)),this.root.push(new Zh(h)),this.paragraphProperties=new vt(d&&d.paragraph),this.runProperties=new ot(d&&d.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Vh({ilvl:Te(e),tentative:1}))}}class ef extends Qh{}class tf extends le{constructor(e){super("w:multiLevelType"),this.root.push(new _e({val:e}))}}class rf extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class Fa extends le{constructor(e,t){super("w:abstractNum"),ae(this,"id"),this.root.push(new rf({abstractNumId:Te(e),restartNumberingAfterBreak:0})),this.root.push(new tf("hybridMultilevel")),this.id=e;for(const a of t)this.root.push(new ef(a))}}class nf extends le{constructor(e){super("w:abstractNumId"),this.root.push(new _e({val:e}))}}class sf extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{numId:"w:numId"})}}class Oa extends le{constructor(e){if(super("w:num"),ae(this,"numId"),ae(this,"reference"),ae(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new sf({numId:Te(e.numId)})),this.root.push(new nf(Te(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(const t of e.overrideLevels)this.root.push(new of(t.num,t.start))}}class af extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{ilvl:"w:ilvl"})}}class of extends le{constructor(e,t){super("w:lvlOverride"),this.root.push(new af({ilvl:e})),t!==void 0&&this.root.push(new uf(t))}}class lf extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class uf extends le{constructor(e){super("w:startOverride"),this.root.push(new lf({val:e}))}}class cf extends le{constructor(e){super("w:numbering"),ae(this,"abstractNumberingMap",new Map),ae(this,"concreteNumberingMap",new Map),ae(this,"referenceConfigMap",new Map),ae(this,"abstractNumUniqueNumericId",Zu()),ae(this,"concreteNumUniqueNumericId",Yu()),this.root.push(new nr(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));const t=new Fa(this.abstractNumUniqueNumericId(),[{level:0,format:We.BULLET,text:"●",alignment:Ce.LEFT,style:{paragraph:{indent:{left:Fe(.5),hanging:Fe(.25)}}}},{level:1,format:We.BULLET,text:"○",alignment:Ce.LEFT,style:{paragraph:{indent:{left:Fe(1),hanging:Fe(.25)}}}},{level:2,format:We.BULLET,text:"■",alignment:Ce.LEFT,style:{paragraph:{indent:{left:2160,hanging:Fe(.25)}}}},{level:3,format:We.BULLET,text:"●",alignment:Ce.LEFT,style:{paragraph:{indent:{left:2880,hanging:Fe(.25)}}}},{level:4,format:We.BULLET,text:"○",alignment:Ce.LEFT,style:{paragraph:{indent:{left:3600,hanging:Fe(.25)}}}},{level:5,format:We.BULLET,text:"■",alignment:Ce.LEFT,style:{paragraph:{indent:{left:4320,hanging:Fe(.25)}}}},{level:6,format:We.BULLET,text:"●",alignment:Ce.LEFT,style:{paragraph:{indent:{left:5040,hanging:Fe(.25)}}}},{level:7,format:We.BULLET,text:"●",alignment:Ce.LEFT,style:{paragraph:{indent:{left:5760,hanging:Fe(.25)}}}},{level:8,format:We.BULLET,text:"●",alignment:Ce.LEFT,style:{paragraph:{indent:{left:6480,hanging:Fe(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new Oa({numId:1,abstractNumId:t.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",t);for(const a of e.config)this.abstractNumberingMap.set(a.reference,new Fa(this.abstractNumUniqueNumericId(),a.levels)),this.referenceConfigMap.set(a.reference,a.levels)}prepForXml(e){for(const t of this.abstractNumberingMap.values())this.root.push(t);for(const t of this.concreteNumberingMap.values())this.root.push(t);return super.prepForXml(e)}createConcreteNumberingInstance(e,t){const a=this.abstractNumberingMap.get(e);if(!a)return;const h=`${e}-${t}`;if(this.concreteNumberingMap.has(h))return;const l=this.referenceConfigMap.get(e),d=l&&l[0].start,n={numId:this.concreteNumUniqueNumericId(),abstractNumId:a.id,reference:e,instance:t,overrideLevels:[d&&Number.isInteger(d)?{num:0,start:d}:{num:0,start:1}]};this.concreteNumberingMap.set(h,new Oa(n))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class hf extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class ff extends le{constructor(e){super("w:compatSetting"),this.root.push(new hf({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class df extends le{constructor(e){super("w:compat"),e.version&&this.root.push(new ff(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new he("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new he("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new he("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new he("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new he("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new he("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new he("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new he("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new he("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new he("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new he("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new he("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new he("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new he("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new he("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new he("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new he("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new he("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new he("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new he("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new he("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new he("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new he("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new he("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new he("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new he("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new he("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new he("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new he("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new he("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new he("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new he("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new he("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new he("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new he("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new he("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new he("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new he("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new he("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new he("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new he("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new he("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new he("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new he("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new he("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new he("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new he("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new he("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new he("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new he("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new he("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new he("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new he("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new he("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new he("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new he("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new he("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new he("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new he("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new he("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new he("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new he("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new he("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new he("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new he("w:cachedColBalance",e.cachedColumnBalance))}}class pf extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class mf extends le{constructor(e){var t,a,h,l,d,n,c,w;super("w:settings"),this.root.push(new pf({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new he("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new he("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new he("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new he("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Ct("w:defaultTabStop",e.defaultTabStop)),((t=e.hyphenation)==null?void 0:t.autoHyphenation)!==void 0&&this.root.push(new he("w:autoHyphenation",e.hyphenation.autoHyphenation)),((a=e.hyphenation)==null?void 0:a.hyphenationZone)!==void 0&&this.root.push(new Ct("w:hyphenationZone",e.hyphenation.hyphenationZone)),((h=e.hyphenation)==null?void 0:h.consecutiveHyphenLimit)!==void 0&&this.root.push(new Ct("w:consecutiveHyphenLimit",e.hyphenation.consecutiveHyphenLimit)),((l=e.hyphenation)==null?void 0:l.doNotHyphenateCaps)!==void 0&&this.root.push(new he("w:doNotHyphenateCaps",e.hyphenation.doNotHyphenateCaps)),this.root.push(new df(it(we({},(d=e.compatibility)!=null?d:{}),{version:(w=(c=(n=e.compatibility)==null?void 0:n.version)!=null?c:e.compatibilityModeVersion)!=null?w:15})))}}class No extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{val:"w:val"})}}class gf extends le{constructor(e){super("w:name"),this.root.push(new No({val:e}))}}class wf extends le{constructor(e){super("w:uiPriority"),this.root.push(new No({val:Te(e)}))}}class yf extends pe{constructor(){super(...arguments),ae(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class Io extends le{constructor(e,t){super("w:style"),this.root.push(new yf(e)),t.name&&this.root.push(new gf(t.name)),t.basedOn&&this.root.push(new st("w:basedOn",t.basedOn)),t.next&&this.root.push(new st("w:next",t.next)),t.link&&this.root.push(new st("w:link",t.link)),t.uiPriority!==void 0&&this.root.push(new wf(t.uiPriority)),t.semiHidden!==void 0&&this.root.push(new he("w:semiHidden",t.semiHidden)),t.unhideWhenUsed!==void 0&&this.root.push(new he("w:unhideWhenUsed",t.unhideWhenUsed)),t.quickFormat!==void 0&&this.root.push(new he("w:qFormat",t.quickFormat))}}class ir extends Io{constructor(e){super({type:"paragraph",styleId:e.id},e),ae(this,"paragraphProperties"),ae(this,"runProperties"),this.paragraphProperties=new vt(e.paragraph),this.runProperties=new ot(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class sr extends Io{constructor(e){super({type:"character",styleId:e.id},we({uiPriority:99,unhideWhenUsed:!0},e)),ae(this,"runProperties"),this.runProperties=new ot(e.run),this.root.push(this.runProperties)}}class Ye extends ir{constructor(e){super(we({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}}class vf extends Ye{constructor(e){super(we({id:"Title",name:"Title"},e))}}class bf extends Ye{constructor(e){super(we({id:"Heading1",name:"Heading 1"},e))}}class xf extends Ye{constructor(e){super(we({id:"Heading2",name:"Heading 2"},e))}}class _f extends Ye{constructor(e){super(we({id:"Heading3",name:"Heading 3"},e))}}class Ef extends Ye{constructor(e){super(we({id:"Heading4",name:"Heading 4"},e))}}class Sf extends Ye{constructor(e){super(we({id:"Heading5",name:"Heading 5"},e))}}class Af extends Ye{constructor(e){super(we({id:"Heading6",name:"Heading 6"},e))}}class Tf extends Ye{constructor(e){super(we({id:"Strong",name:"Strong"},e))}}class kf extends ir{constructor(e){super(we({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}}class Rf extends ir{constructor(e){super(we({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:oi.AUTO}},run:{size:20}},e))}}class Cf extends sr{constructor(e){super(we({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}}class Nf extends sr{constructor(e){super(we({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}}class If extends sr{constructor(e){super(we({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:yo.SINGLE}}},e))}}class $n extends le{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(const t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(const t of e.paragraphStyles)this.root.push(new ir(t));if(e.characterStyles)for(const t of e.characterStyles)this.root.push(new sr(t))}}class Ff extends le{constructor(e){super("w:pPrDefault"),this.root.push(new vt(e))}}class Of extends le{constructor(e){super("w:rPrDefault"),this.root.push(new ot(e))}}class Pf extends le{constructor(e){super("w:docDefaults"),ae(this,"runPropertiesDefaults"),ae(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Of(e.run),this.paragraphPropertiesDefaults=new Ff(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class Bf{newInstance(e){const t=co.xml2js(e,{compact:!1});let a;for(const l of t.elements||[])l.name==="w:styles"&&(a=l);if(a===void 0)throw new Error("can not find styles element");const h=a.elements||[];return{initialStyles:new uu(a.attributes),importedStyles:h.map(l=>bi(l))}}}class Zn{newInstance(e={}){var t;return{initialStyles:new nr(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new Pf((t=e.document)!=null?t:{}),new vf(we({run:{size:56}},e.title)),new bf(we({run:{color:"2E74B5",size:32}},e.heading1)),new xf(we({run:{color:"2E74B5",size:26}},e.heading2)),new _f(we({run:{color:"1F4D78",size:24}},e.heading3)),new Ef(we({run:{color:"2E74B5",italics:!0}},e.heading4)),new Sf(we({run:{color:"2E74B5"}},e.heading5)),new Af(we({run:{color:"1F4D78"}},e.heading6)),new Tf(we({run:{bold:!0}},e.strong)),new kf(e.listParagraph||{}),new If(e.hyperlink||{}),new Cf(e.footnoteReference||{}),new Rf(e.footnoteText||{}),new Nf(e.footnoteTextChar||{})]}}}class Df{constructor(e){ae(this,"currentRelationshipId",1),ae(this,"documentWrapper"),ae(this,"headers",[]),ae(this,"footers",[]),ae(this,"coreProperties"),ae(this,"numbering"),ae(this,"media"),ae(this,"fileRelationships"),ae(this,"footnotesWrapper"),ae(this,"settings"),ae(this,"contentTypes"),ae(this,"customProperties"),ae(this,"appProperties"),ae(this,"styles"),ae(this,"comments"),ae(this,"fontWrapper");var t,a,h,l,d,n,c,w,_,k,C,E,R;if(this.coreProperties=new vh(it(we({},e),{creator:(t=e.creator)!=null?t:"Un-named",revision:(a=e.revision)!=null?a:1,lastModifiedBy:(h=e.lastModifiedBy)!=null?h:"Un-named"})),this.numbering=new cf(e.numbering?e.numbering:{config:[]}),this.comments=new lc((l=e.comments)!=null?l:{children:[]}),this.fileRelationships=new lt,this.customProperties=new Ah((d=e.customProperties)!=null?d:[]),this.appProperties=new ph,this.footnotesWrapper=new Wh,this.contentTypes=new yh,this.documentWrapper=new So({background:e.background}),this.settings=new mf({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(n=e.features)==null?void 0:n.trackRevisions,updateFields:(c=e.features)==null?void 0:c.updateFields,defaultTabStop:e.defaultTabStop,hyphenation:{autoHyphenation:(w=e.hyphenation)==null?void 0:w.autoHyphenation,hyphenationZone:(_=e.hyphenation)==null?void 0:_.hyphenationZone,consecutiveHyphenLimit:(k=e.hyphenation)==null?void 0:k.consecutiveHyphenLimit,doNotHyphenateCaps:(C=e.hyphenation)==null?void 0:C.doNotHyphenateCaps}}),this.media=new Gh,e.externalStyles!==void 0){const T=new Zn().newInstance((E=e.styles)==null?void 0:E.default),y=new Bf().newInstance(e.externalStyles);this.styles=new $n(it(we({},y),{importedStyles:[...T.importedStyles,...y.importedStyles]}))}else if(e.styles){const T=new Zn().newInstance(e.styles.default);this.styles=new $n(we(we({},T),e.styles))}else{const b=new Zn;this.styles=new $n(b.newInstance())}this.addDefaultRelationships();for(const b of e.sections)this.addSection(b);if(e.footnotes)for(const b in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(b),e.footnotes[b].children);this.fontWrapper=new Ch((R=e.fonts)!=null?R:[])}addSection({headers:e={},footers:t={},children:a,properties:h}){this.documentWrapper.View.Body.addSection(it(we({},h),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:t.default?this.createFooter(t.default):void 0,first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}}));for(const l of a)this.documentWrapper.View.add(l)}createHeader(e){const t=new Kh(this.media,this.currentRelationshipId++);for(const a of e.options.children)t.add(a);return this.addHeaderToDocument(t),t}createFooter(e){const t=new Fh(this.media,this.currentRelationshipId++);for(const a of e.options.children)t.add(a);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=pt.DEFAULT){this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=pt.DEFAULT){this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}}var jf=wi();function Xt(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yn={exports:{}},Pa;function Lf(){return Pa||(Pa=1,function(i,e){(function(t){i.exports=t()})(function(){return function t(a,h,l){function d(w,_){if(!h[w]){if(!a[w]){var k=typeof Xt=="function"&&Xt;if(!_&&k)return k(w,!0);if(n)return n(w,!0);var C=new Error("Cannot find module '"+w+"'");throw C.code="MODULE_NOT_FOUND",C}var E=h[w]={exports:{}};a[w][0].call(E.exports,function(R){var b=a[w][1][R];return d(b||R)},E,E.exports,t,a,h,l)}return h[w].exports}for(var n=typeof Xt=="function"&&Xt,c=0;c<l.length;c++)d(l[c]);return d}({1:[function(t,a,h){var l=t("./utils"),d=t("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";h.encode=function(c){for(var w,_,k,C,E,R,b,T=[],o=0,y=c.length,m=y,u=l.getTypeOf(c)!=="string";o<c.length;)m=y-o,k=u?(w=c[o++],_=o<y?c[o++]:0,o<y?c[o++]:0):(w=c.charCodeAt(o++),_=o<y?c.charCodeAt(o++):0,o<y?c.charCodeAt(o++):0),C=w>>2,E=(3&w)<<4|_>>4,R=1<m?(15&_)<<2|k>>6:64,b=2<m?63&k:64,T.push(n.charAt(C)+n.charAt(E)+n.charAt(R)+n.charAt(b));return T.join("")},h.decode=function(c){var w,_,k,C,E,R,b=0,T=0,o="data:";if(c.substr(0,o.length)===o)throw new Error("Invalid base64 input, it looks like a data url.");var y,m=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===n.charAt(64)&&m--,c.charAt(c.length-2)===n.charAt(64)&&m--,m%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=d.uint8array?new Uint8Array(0|m):new Array(0|m);b<c.length;)w=n.indexOf(c.charAt(b++))<<2|(C=n.indexOf(c.charAt(b++)))>>4,_=(15&C)<<4|(E=n.indexOf(c.charAt(b++)))>>2,k=(3&E)<<6|(R=n.indexOf(c.charAt(b++))),y[T++]=w,E!==64&&(y[T++]=_),R!==64&&(y[T++]=k);return y}},{"./support":30,"./utils":32}],2:[function(t,a,h){var l=t("./external"),d=t("./stream/DataWorker"),n=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function w(_,k,C,E,R){this.compressedSize=_,this.uncompressedSize=k,this.crc32=C,this.compression=E,this.compressedContent=R}w.prototype={getContentWorker:function(){var _=new d(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),k=this;return _.on("end",function(){if(this.streamInfo.data_length!==k.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new d(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},w.createWorkerFrom=function(_,k,C){return _.pipe(new n).pipe(new c("uncompressedSize")).pipe(k.compressWorker(C)).pipe(new c("compressedSize")).withStreamInfo("compression",k)},a.exports=w},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,a,h){var l=t("./stream/GenericWorker");h.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},h.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,a,h){var l=t("./utils"),d=function(){for(var n,c=[],w=0;w<256;w++){n=w;for(var _=0;_<8;_++)n=1&n?3988292384^n>>>1:n>>>1;c[w]=n}return c}();a.exports=function(n,c){return n!==void 0&&n.length?l.getTypeOf(n)!=="string"?function(w,_,k,C){var E=d,R=C+k;w^=-1;for(var b=C;b<R;b++)w=w>>>8^E[255&(w^_[b])];return-1^w}(0|c,n,n.length,0):function(w,_,k,C){var E=d,R=C+k;w^=-1;for(var b=C;b<R;b++)w=w>>>8^E[255&(w^_.charCodeAt(b))];return-1^w}(0|c,n,n.length,0):0}},{"./utils":32}],5:[function(t,a,h){h.base64=!1,h.binary=!1,h.dir=!1,h.createFolders=!0,h.date=null,h.compression=null,h.compressionOptions=null,h.comment=null,h.unixPermissions=null,h.dosPermissions=null},{}],6:[function(t,a,h){var l=null;l=typeof Promise<"u"?Promise:t("lie"),a.exports={Promise:l}},{lie:37}],7:[function(t,a,h){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",d=t("pako"),n=t("./utils"),c=t("./stream/GenericWorker"),w=l?"uint8array":"array";function _(k,C){c.call(this,"FlateWorker/"+k),this._pako=null,this._pakoAction=k,this._pakoOptions=C,this.meta={}}h.magic="\b\0",n.inherits(_,c),_.prototype.processChunk=function(k){this.meta=k.meta,this._pako===null&&this._createPako(),this._pako.push(n.transformTo(w,k.data),!1)},_.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var k=this;this._pako.onData=function(C){k.push({data:C,meta:k.meta})}},h.compressWorker=function(k){return new _("Deflate",k)},h.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,a,h){function l(E,R){var b,T="";for(b=0;b<R;b++)T+=String.fromCharCode(255&E),E>>>=8;return T}function d(E,R,b,T,o,y){var m,u,A=E.file,P=E.compression,j=y!==w.utf8encode,q=n.transformTo("string",y(A.name)),N=n.transformTo("string",w.utf8encode(A.name)),Y=A.comment,ue=n.transformTo("string",y(Y)),I=n.transformTo("string",w.utf8encode(Y)),U=N.length!==A.name.length,x=I.length!==Y.length,Z="",re="",H="",ie=A.dir,te=A.date,ee={crc32:0,compressedSize:0,uncompressedSize:0};R&&!b||(ee.crc32=E.crc32,ee.compressedSize=E.compressedSize,ee.uncompressedSize=E.uncompressedSize);var V=0;R&&(V|=8),j||!U&&!x||(V|=2048);var O=0,X=0;ie&&(O|=16),o==="UNIX"?(X=798,O|=function(ne,$){var S=ne;return ne||(S=$?16893:33204),(65535&S)<<16}(A.unixPermissions,ie)):(X=20,O|=function(ne){return 63&(ne||0)}(A.dosPermissions)),m=te.getUTCHours(),m<<=6,m|=te.getUTCMinutes(),m<<=5,m|=te.getUTCSeconds()/2,u=te.getUTCFullYear()-1980,u<<=4,u|=te.getUTCMonth()+1,u<<=5,u|=te.getUTCDate(),U&&(re=l(1,1)+l(_(q),4)+N,Z+="up"+l(re.length,2)+re),x&&(H=l(1,1)+l(_(ue),4)+I,Z+="uc"+l(H.length,2)+H);var J="";return J+=`
\0`,J+=l(V,2),J+=P.magic,J+=l(m,2),J+=l(u,2),J+=l(ee.crc32,4),J+=l(ee.compressedSize,4),J+=l(ee.uncompressedSize,4),J+=l(q.length,2),J+=l(Z.length,2),{fileRecord:k.LOCAL_FILE_HEADER+J+q+Z,dirRecord:k.CENTRAL_FILE_HEADER+l(X,2)+J+l(ue.length,2)+"\0\0\0\0"+l(O,4)+l(T,4)+q+Z+ue}}var n=t("../utils"),c=t("../stream/GenericWorker"),w=t("../utf8"),_=t("../crc32"),k=t("../signature");function C(E,R,b,T){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=R,this.zipPlatform=b,this.encodeFileName=T,this.streamFiles=E,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(C,c),C.prototype.push=function(E){var R=E.meta.percent||0,b=this.entriesCount,T=this._sources.length;this.accumulate?this.contentBuffer.push(E):(this.bytesWritten+=E.data.length,c.prototype.push.call(this,{data:E.data,meta:{currentFile:this.currentFile,percent:b?(R+100*(b-T-1))/b:100}}))},C.prototype.openedSource=function(E){this.currentSourceOffset=this.bytesWritten,this.currentFile=E.file.name;var R=this.streamFiles&&!E.file.dir;if(R){var b=d(E,R,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},C.prototype.closedSource=function(E){this.accumulate=!1;var R=this.streamFiles&&!E.file.dir,b=d(E,R,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),R)this.push({data:function(T){return k.DATA_DESCRIPTOR+l(T.crc32,4)+l(T.compressedSize,4)+l(T.uncompressedSize,4)}(E),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},C.prototype.flush=function(){for(var E=this.bytesWritten,R=0;R<this.dirRecords.length;R++)this.push({data:this.dirRecords[R],meta:{percent:100}});var b=this.bytesWritten-E,T=function(o,y,m,u,A){var P=n.transformTo("string",A(u));return k.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(o,2)+l(o,2)+l(y,4)+l(m,4)+l(P.length,2)+P}(this.dirRecords.length,b,E,this.zipComment,this.encodeFileName);this.push({data:T,meta:{percent:100}})},C.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},C.prototype.registerPrevious=function(E){this._sources.push(E);var R=this;return E.on("data",function(b){R.processChunk(b)}),E.on("end",function(){R.closedSource(R.previous.streamInfo),R._sources.length?R.prepareNextSource():R.end()}),E.on("error",function(b){R.error(b)}),this},C.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},C.prototype.error=function(E){var R=this._sources;if(!c.prototype.error.call(this,E))return!1;for(var b=0;b<R.length;b++)try{R[b].error(E)}catch{}return!0},C.prototype.lock=function(){c.prototype.lock.call(this);for(var E=this._sources,R=0;R<E.length;R++)E[R].lock()},a.exports=C},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,a,h){var l=t("../compressions"),d=t("./ZipFileWorker");h.generateWorker=function(n,c,w){var _=new d(c.streamFiles,w,c.platform,c.encodeFileName),k=0;try{n.forEach(function(C,E){k++;var R=function(y,m){var u=y||m,A=l[u];if(!A)throw new Error(u+" is not a valid compression method !");return A}(E.options.compression,c.compression),b=E.options.compressionOptions||c.compressionOptions||{},T=E.dir,o=E.date;E._compressWorker(R,b).withStreamInfo("file",{name:C,dir:T,date:o,comment:E.comment||"",unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions}).pipe(_)}),_.entriesCount=k}catch(C){_.error(C)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,a,h){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new l;for(var n in this)typeof this[n]!="function"&&(d[n]=this[n]);return d}}(l.prototype=t("./object")).loadAsync=t("./load"),l.support=t("./support"),l.defaults=t("./defaults"),l.version="3.10.1",l.loadAsync=function(d,n){return new l().loadAsync(d,n)},l.external=t("./external"),a.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,a,h){var l=t("./utils"),d=t("./external"),n=t("./utf8"),c=t("./zipEntries"),w=t("./stream/Crc32Probe"),_=t("./nodejsUtils");function k(C){return new d.Promise(function(E,R){var b=C.decompressed.getContentWorker().pipe(new w);b.on("error",function(T){R(T)}).on("end",function(){b.streamInfo.crc32!==C.decompressed.crc32?R(new Error("Corrupted zip : CRC32 mismatch")):E()}).resume()})}a.exports=function(C,E){var R=this;return E=l.extend(E||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),_.isNode&&_.isStream(C)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",C,!0,E.optimizedBinaryString,E.base64).then(function(b){var T=new c(E);return T.load(b),T}).then(function(b){var T=[d.Promise.resolve(b)],o=b.files;if(E.checkCRC32)for(var y=0;y<o.length;y++)T.push(k(o[y]));return d.Promise.all(T)}).then(function(b){for(var T=b.shift(),o=T.files,y=0;y<o.length;y++){var m=o[y],u=m.fileNameStr,A=l.resolve(m.fileNameStr);R.file(A,m.decompressed,{binary:!0,optimizedBinaryString:!0,date:m.date,dir:m.dir,comment:m.fileCommentStr.length?m.fileCommentStr:null,unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions,createFolders:E.createFolders}),m.dir||(R.file(A).unsafeOriginalName=u)}return T.zipComment.length&&(R.comment=T.zipComment),R})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,a,h){var l=t("../utils"),d=t("../stream/GenericWorker");function n(c,w){d.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(w)}l.inherits(n,d),n.prototype._bindStream=function(c){var w=this;(this._stream=c).pause(),c.on("data",function(_){w.push({data:_,meta:{percent:0}})}).on("error",function(_){w.isPaused?this.generatedError=_:w.error(_)}).on("end",function(){w.isPaused?w._upstreamEnded=!0:w.end()})},n.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},a.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,a,h){var l=t("readable-stream").Readable;function d(n,c,w){l.call(this,c),this._helper=n;var _=this;n.on("data",function(k,C){_.push(k)||_._helper.pause(),w&&w(C)}).on("error",function(k){_.emit("error",k)}).on("end",function(){_.push(null)})}t("../utils").inherits(d,l),d.prototype._read=function(){this._helper.resume()},a.exports=d},{"../utils":32,"readable-stream":16}],14:[function(t,a,h){a.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,d);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,d)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var d=new Buffer(l);return d.fill(0),d},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(t,a,h){function l(A,P,j){var q,N=n.getTypeOf(P),Y=n.extend(j||{},_);Y.date=Y.date||new Date,Y.compression!==null&&(Y.compression=Y.compression.toUpperCase()),typeof Y.unixPermissions=="string"&&(Y.unixPermissions=parseInt(Y.unixPermissions,8)),Y.unixPermissions&&16384&Y.unixPermissions&&(Y.dir=!0),Y.dosPermissions&&16&Y.dosPermissions&&(Y.dir=!0),Y.dir&&(A=o(A)),Y.createFolders&&(q=T(A))&&y.call(this,q,!0);var ue=N==="string"&&Y.binary===!1&&Y.base64===!1;j&&j.binary!==void 0||(Y.binary=!ue),(P instanceof k&&P.uncompressedSize===0||Y.dir||!P||P.length===0)&&(Y.base64=!1,Y.binary=!0,P="",Y.compression="STORE",N="string");var I=null;I=P instanceof k||P instanceof c?P:R.isNode&&R.isStream(P)?new b(A,P):n.prepareContent(A,P,Y.binary,Y.optimizedBinaryString,Y.base64);var U=new C(A,I,Y);this.files[A]=U}var d=t("./utf8"),n=t("./utils"),c=t("./stream/GenericWorker"),w=t("./stream/StreamHelper"),_=t("./defaults"),k=t("./compressedObject"),C=t("./zipObject"),E=t("./generate"),R=t("./nodejsUtils"),b=t("./nodejs/NodejsStreamInputAdapter"),T=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var P=A.lastIndexOf("/");return 0<P?A.substring(0,P):""},o=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},y=function(A,P){return P=P!==void 0?P:_.createFolders,A=o(A),this.files[A]||l.call(this,A,null,{dir:!0,createFolders:P}),this.files[A]};function m(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var u={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var P,j,q;for(P in this.files)q=this.files[P],(j=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&A(j,q)},filter:function(A){var P=[];return this.forEach(function(j,q){A(j,q)&&P.push(q)}),P},file:function(A,P,j){if(arguments.length!==1)return A=this.root+A,l.call(this,A,P,j),this;if(m(A)){var q=A;return this.filter(function(Y,ue){return!ue.dir&&q.test(Y)})}var N=this.files[this.root+A];return N&&!N.dir?N:null},folder:function(A){if(!A)return this;if(m(A))return this.filter(function(N,Y){return Y.dir&&A.test(N)});var P=this.root+A,j=y.call(this,P),q=this.clone();return q.root=j.name,q},remove:function(A){A=this.root+A;var P=this.files[A];if(P||(A.slice(-1)!=="/"&&(A+="/"),P=this.files[A]),P&&!P.dir)delete this.files[A];else for(var j=this.filter(function(N,Y){return Y.name.slice(0,A.length)===A}),q=0;q<j.length;q++)delete this.files[j[q].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var P,j={};try{if((j=n.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=j.type.toLowerCase(),j.compression=j.compression.toUpperCase(),j.type==="binarystring"&&(j.type="string"),!j.type)throw new Error("No output type specified.");n.checkSupport(j.type),j.platform!=="darwin"&&j.platform!=="freebsd"&&j.platform!=="linux"&&j.platform!=="sunos"||(j.platform="UNIX"),j.platform==="win32"&&(j.platform="DOS");var q=j.comment||this.comment||"";P=E.generateWorker(this,j,q)}catch(N){(P=new c("error")).error(N)}return new w(P,j.type||"string",j.mimeType)},generateAsync:function(A,P){return this.generateInternalStream(A).accumulate(P)},generateNodeStream:function(A,P){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(P)}};a.exports=u},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,a,h){a.exports=t("stream")},{stream:void 0}],17:[function(t,a,h){var l=t("./DataReader");function d(n){l.call(this,n);for(var c=0;c<this.data.length;c++)n[c]=255&n[c]}t("../utils").inherits(d,l),d.prototype.byteAt=function(n){return this.data[this.zero+n]},d.prototype.lastIndexOfSignature=function(n){for(var c=n.charCodeAt(0),w=n.charCodeAt(1),_=n.charCodeAt(2),k=n.charCodeAt(3),C=this.length-4;0<=C;--C)if(this.data[C]===c&&this.data[C+1]===w&&this.data[C+2]===_&&this.data[C+3]===k)return C-this.zero;return-1},d.prototype.readAndCheckSignature=function(n){var c=n.charCodeAt(0),w=n.charCodeAt(1),_=n.charCodeAt(2),k=n.charCodeAt(3),C=this.readData(4);return c===C[0]&&w===C[1]&&_===C[2]&&k===C[3]},d.prototype.readData=function(n){if(this.checkOffset(n),n===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,c},a.exports=d},{"../utils":32,"./DataReader":18}],18:[function(t,a,h){var l=t("../utils");function d(n){this.data=n,this.length=n.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(n){this.checkIndex(this.index+n)},checkIndex:function(n){if(this.length<this.zero+n||n<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+n+"). Corrupted zip ?")},setIndex:function(n){this.checkIndex(n),this.index=n},skip:function(n){this.setIndex(this.index+n)},byteAt:function(){},readInt:function(n){var c,w=0;for(this.checkOffset(n),c=this.index+n-1;c>=this.index;c--)w=(w<<8)+this.byteAt(c);return this.index+=n,w},readString:function(n){return l.transformTo("string",this.readData(n))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var n=this.readInt(4);return new Date(Date.UTC(1980+(n>>25&127),(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(31&n)<<1))}},a.exports=d},{"../utils":32}],19:[function(t,a,h){var l=t("./Uint8ArrayReader");function d(n){l.call(this,n)}t("../utils").inherits(d,l),d.prototype.readData=function(n){this.checkOffset(n);var c=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,c},a.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,a,h){var l=t("./DataReader");function d(n){l.call(this,n)}t("../utils").inherits(d,l),d.prototype.byteAt=function(n){return this.data.charCodeAt(this.zero+n)},d.prototype.lastIndexOfSignature=function(n){return this.data.lastIndexOf(n)-this.zero},d.prototype.readAndCheckSignature=function(n){return n===this.readData(4)},d.prototype.readData=function(n){this.checkOffset(n);var c=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,c},a.exports=d},{"../utils":32,"./DataReader":18}],21:[function(t,a,h){var l=t("./ArrayReader");function d(n){l.call(this,n)}t("../utils").inherits(d,l),d.prototype.readData=function(n){if(this.checkOffset(n),n===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+n);return this.index+=n,c},a.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(t,a,h){var l=t("../utils"),d=t("../support"),n=t("./ArrayReader"),c=t("./StringReader"),w=t("./NodeBufferReader"),_=t("./Uint8ArrayReader");a.exports=function(k){var C=l.getTypeOf(k);return l.checkSupport(C),C!=="string"||d.uint8array?C==="nodebuffer"?new w(k):d.uint8array?new _(l.transformTo("uint8array",k)):new n(l.transformTo("array",k)):new c(k)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,a,h){h.LOCAL_FILE_HEADER="PK",h.CENTRAL_FILE_HEADER="PK",h.CENTRAL_DIRECTORY_END="PK",h.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",h.ZIP64_CENTRAL_DIRECTORY_END="PK",h.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,a,h){var l=t("./GenericWorker"),d=t("../utils");function n(c){l.call(this,"ConvertWorker to "+c),this.destType=c}d.inherits(n,l),n.prototype.processChunk=function(c){this.push({data:d.transformTo(this.destType,c.data),meta:c.meta})},a.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(t,a,h){var l=t("./GenericWorker"),d=t("../crc32");function n(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(n,l),n.prototype.processChunk=function(c){this.streamInfo.crc32=d(c.data,this.streamInfo.crc32||0),this.push(c)},a.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,a,h){var l=t("../utils"),d=t("./GenericWorker");function n(c){d.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}l.inherits(n,d),n.prototype.processChunk=function(c){if(c){var w=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=w+c.data.length}d.prototype.processChunk.call(this,c)},a.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(t,a,h){var l=t("../utils"),d=t("./GenericWorker");function n(c){d.call(this,"DataWorker");var w=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(_){w.dataIsReady=!0,w.data=_,w.max=_&&_.length||0,w.type=l.getTypeOf(_),w.isPaused||w._tickAndRepeat()},function(_){w.error(_)})}l.inherits(n,d),n.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,w=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,w);break;case"uint8array":c=this.data.subarray(this.index,w);break;case"array":case"nodebuffer":c=this.data.slice(this.index,w)}return this.index=w,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},a.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(t,a,h){function l(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,n){return this._listeners[d].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,n){if(this._listeners[d])for(var c=0;c<this._listeners[d].length;c++)this._listeners[d][c].call(this,n)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var n=this;return d.on("data",function(c){n.processChunk(c)}),d.on("end",function(){n.end()}),d.on("error",function(c){n.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,n){return this.extraStreamInfo[d]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},a.exports=l},{}],29:[function(t,a,h){var l=t("../utils"),d=t("./ConvertWorker"),n=t("./GenericWorker"),c=t("../base64"),w=t("../support"),_=t("../external"),k=null;if(w.nodestream)try{k=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function C(R,b){return new _.Promise(function(T,o){var y=[],m=R._internalType,u=R._outputType,A=R._mimeType;R.on("data",function(P,j){y.push(P),b&&b(j)}).on("error",function(P){y=[],o(P)}).on("end",function(){try{var P=function(j,q,N){switch(j){case"blob":return l.newBlob(l.transformTo("arraybuffer",q),N);case"base64":return c.encode(q);default:return l.transformTo(j,q)}}(u,function(j,q){var N,Y=0,ue=null,I=0;for(N=0;N<q.length;N++)I+=q[N].length;switch(j){case"string":return q.join("");case"array":return Array.prototype.concat.apply([],q);case"uint8array":for(ue=new Uint8Array(I),N=0;N<q.length;N++)ue.set(q[N],Y),Y+=q[N].length;return ue;case"nodebuffer":return Buffer.concat(q);default:throw new Error("concat : unsupported type '"+j+"'")}}(m,y),A);T(P)}catch(j){o(j)}y=[]}).resume()})}function E(R,b,T){var o=b;switch(b){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=b,this._mimeType=T,l.checkSupport(o),this._worker=R.pipe(new d(o)),R.lock()}catch(y){this._worker=new n("error"),this._worker.error(y)}}E.prototype={accumulate:function(R){return C(this,R)},on:function(R,b){var T=this;return R==="data"?this._worker.on(R,function(o){b.call(T,o.data,o.meta)}):this._worker.on(R,function(){l.delay(b,arguments,T)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(R){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new k(this,{objectMode:this._outputType!=="nodebuffer"},R)}},a.exports=E},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,a,h){if(h.base64=!0,h.array=!0,h.string=!0,h.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",h.nodebuffer=typeof Buffer<"u",h.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")h.blob=!1;else{var l=new ArrayBuffer(0);try{h.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(l),h.blob=d.getBlob("application/zip").size===0}catch{h.blob=!1}}}try{h.nodestream=!!t("readable-stream").Readable}catch{h.nodestream=!1}},{"readable-stream":16}],31:[function(t,a,h){for(var l=t("./utils"),d=t("./support"),n=t("./nodejsUtils"),c=t("./stream/GenericWorker"),w=new Array(256),_=0;_<256;_++)w[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;w[254]=w[254]=1;function k(){c.call(this,"utf-8 decode"),this.leftOver=null}function C(){c.call(this,"utf-8 encode")}h.utf8encode=function(E){return d.nodebuffer?n.newBufferFrom(E,"utf-8"):function(R){var b,T,o,y,m,u=R.length,A=0;for(y=0;y<u;y++)(64512&(T=R.charCodeAt(y)))==55296&&y+1<u&&(64512&(o=R.charCodeAt(y+1)))==56320&&(T=65536+(T-55296<<10)+(o-56320),y++),A+=T<128?1:T<2048?2:T<65536?3:4;for(b=d.uint8array?new Uint8Array(A):new Array(A),y=m=0;m<A;y++)(64512&(T=R.charCodeAt(y)))==55296&&y+1<u&&(64512&(o=R.charCodeAt(y+1)))==56320&&(T=65536+(T-55296<<10)+(o-56320),y++),T<128?b[m++]=T:(T<2048?b[m++]=192|T>>>6:(T<65536?b[m++]=224|T>>>12:(b[m++]=240|T>>>18,b[m++]=128|T>>>12&63),b[m++]=128|T>>>6&63),b[m++]=128|63&T);return b}(E)},h.utf8decode=function(E){return d.nodebuffer?l.transformTo("nodebuffer",E).toString("utf-8"):function(R){var b,T,o,y,m=R.length,u=new Array(2*m);for(b=T=0;b<m;)if((o=R[b++])<128)u[T++]=o;else if(4<(y=w[o]))u[T++]=65533,b+=y-1;else{for(o&=y===2?31:y===3?15:7;1<y&&b<m;)o=o<<6|63&R[b++],y--;1<y?u[T++]=65533:o<65536?u[T++]=o:(o-=65536,u[T++]=55296|o>>10&1023,u[T++]=56320|1023&o)}return u.length!==T&&(u.subarray?u=u.subarray(0,T):u.length=T),l.applyFromCharCode(u)}(E=l.transformTo(d.uint8array?"uint8array":"array",E))},l.inherits(k,c),k.prototype.processChunk=function(E){var R=l.transformTo(d.uint8array?"uint8array":"array",E.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var b=R;(R=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),R.set(b,this.leftOver.length)}else R=this.leftOver.concat(R);this.leftOver=null}var T=function(y,m){var u;for((m=m||y.length)>y.length&&(m=y.length),u=m-1;0<=u&&(192&y[u])==128;)u--;return u<0||u===0?m:u+w[y[u]]>m?u:m}(R),o=R;T!==R.length&&(d.uint8array?(o=R.subarray(0,T),this.leftOver=R.subarray(T,R.length)):(o=R.slice(0,T),this.leftOver=R.slice(T,R.length))),this.push({data:h.utf8decode(o),meta:E.meta})},k.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:h.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},h.Utf8DecodeWorker=k,l.inherits(C,c),C.prototype.processChunk=function(E){this.push({data:h.utf8encode(E.data),meta:E.meta})},h.Utf8EncodeWorker=C},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,a,h){var l=t("./support"),d=t("./base64"),n=t("./nodejsUtils"),c=t("./external");function w(b){return b}function _(b,T){for(var o=0;o<b.length;++o)T[o]=255&b.charCodeAt(o);return T}t("setimmediate"),h.newBlob=function(b,T){h.checkSupport("blob");try{return new Blob([b],{type:T})}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return o.append(b),o.getBlob(T)}catch{throw new Error("Bug : can't construct the Blob.")}}};var k={stringifyByChunk:function(b,T,o){var y=[],m=0,u=b.length;if(u<=o)return String.fromCharCode.apply(null,b);for(;m<u;)T==="array"||T==="nodebuffer"?y.push(String.fromCharCode.apply(null,b.slice(m,Math.min(m+o,u)))):y.push(String.fromCharCode.apply(null,b.subarray(m,Math.min(m+o,u)))),m+=o;return y.join("")},stringifyByChar:function(b){for(var T="",o=0;o<b.length;o++)T+=String.fromCharCode(b[o]);return T},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch{return!1}}()}};function C(b){var T=65536,o=h.getTypeOf(b),y=!0;if(o==="uint8array"?y=k.applyCanBeUsed.uint8array:o==="nodebuffer"&&(y=k.applyCanBeUsed.nodebuffer),y)for(;1<T;)try{return k.stringifyByChunk(b,o,T)}catch{T=Math.floor(T/2)}return k.stringifyByChar(b)}function E(b,T){for(var o=0;o<b.length;o++)T[o]=b[o];return T}h.applyFromCharCode=C;var R={};R.string={string:w,array:function(b){return _(b,new Array(b.length))},arraybuffer:function(b){return R.string.uint8array(b).buffer},uint8array:function(b){return _(b,new Uint8Array(b.length))},nodebuffer:function(b){return _(b,n.allocBuffer(b.length))}},R.array={string:C,array:w,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return n.newBufferFrom(b)}},R.arraybuffer={string:function(b){return C(new Uint8Array(b))},array:function(b){return E(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:w,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return n.newBufferFrom(new Uint8Array(b))}},R.uint8array={string:C,array:function(b){return E(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:w,nodebuffer:function(b){return n.newBufferFrom(b)}},R.nodebuffer={string:C,array:function(b){return E(b,new Array(b.length))},arraybuffer:function(b){return R.nodebuffer.uint8array(b).buffer},uint8array:function(b){return E(b,new Uint8Array(b.length))},nodebuffer:w},h.transformTo=function(b,T){if(T=T||"",!b)return T;h.checkSupport(b);var o=h.getTypeOf(T);return R[o][b](T)},h.resolve=function(b){for(var T=b.split("/"),o=[],y=0;y<T.length;y++){var m=T[y];m==="."||m===""&&y!==0&&y!==T.length-1||(m===".."?o.pop():o.push(m))}return o.join("/")},h.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":l.nodebuffer&&n.isBuffer(b)?"nodebuffer":l.uint8array&&b instanceof Uint8Array?"uint8array":l.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},h.checkSupport=function(b){if(!l[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},h.MAX_VALUE_16BITS=65535,h.MAX_VALUE_32BITS=-1,h.pretty=function(b){var T,o,y="";for(o=0;o<(b||"").length;o++)y+="\\x"+((T=b.charCodeAt(o))<16?"0":"")+T.toString(16).toUpperCase();return y},h.delay=function(b,T,o){setImmediate(function(){b.apply(o||null,T||[])})},h.inherits=function(b,T){function o(){}o.prototype=T.prototype,b.prototype=new o},h.extend=function(){var b,T,o={};for(b=0;b<arguments.length;b++)for(T in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],T)&&o[T]===void 0&&(o[T]=arguments[b][T]);return o},h.prepareContent=function(b,T,o,y,m){return c.Promise.resolve(T).then(function(u){return l.blob&&(u instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(u))!==-1)&&typeof FileReader<"u"?new c.Promise(function(A,P){var j=new FileReader;j.onload=function(q){A(q.target.result)},j.onerror=function(q){P(q.target.error)},j.readAsArrayBuffer(u)}):u}).then(function(u){var A=h.getTypeOf(u);return A?(A==="arraybuffer"?u=h.transformTo("uint8array",u):A==="string"&&(m?u=d.decode(u):o&&y!==!0&&(u=function(P){return _(P,l.uint8array?new Uint8Array(P.length):new Array(P.length))}(u))),u):c.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,a,h){var l=t("./reader/readerFor"),d=t("./utils"),n=t("./signature"),c=t("./zipEntry"),w=t("./support");function _(k){this.files=[],this.loadOptions=k}_.prototype={checkSignature:function(k){if(!this.reader.readAndCheckSignature(k)){this.reader.index-=4;var C=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(C)+", expected "+d.pretty(k)+")")}},isSignature:function(k,C){var E=this.reader.index;this.reader.setIndex(k);var R=this.reader.readString(4)===C;return this.reader.setIndex(E),R},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var k=this.reader.readData(this.zipCommentLength),C=w.uint8array?"uint8array":"array",E=d.transformTo(C,k);this.zipComment=this.loadOptions.decodeFileName(E)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var k,C,E,R=this.zip64EndOfCentralSize-44;0<R;)k=this.reader.readInt(2),C=this.reader.readInt(4),E=this.reader.readData(C),this.zip64ExtensibleData[k]={id:k,length:C,value:E}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var k,C;for(k=0;k<this.files.length;k++)C=this.files[k],this.reader.setIndex(C.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),C.readLocalPart(this.reader),C.handleUTF8(),C.processAttributes()},readCentralDir:function(){var k;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(k=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(k);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var k=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(k<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(k);var C=k;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(k=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(k),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var E=this.centralDirOffset+this.centralDirSize;this.zip64&&(E+=20,E+=12+this.zip64EndOfCentralSize);var R=C-E;if(0<R)this.isSignature(C,n.CENTRAL_FILE_HEADER)||(this.reader.zero=R);else if(R<0)throw new Error("Corrupted zip: missing "+Math.abs(R)+" bytes.")},prepareReader:function(k){this.reader=l(k)},load:function(k){this.prepareReader(k),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},a.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,a,h){var l=t("./reader/readerFor"),d=t("./utils"),n=t("./compressedObject"),c=t("./crc32"),w=t("./utf8"),_=t("./compressions"),k=t("./support");function C(E,R){this.options=E,this.loadOptions=R}C.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(E){var R,b;if(E.skip(22),this.fileNameLength=E.readInt(2),b=E.readInt(2),this.fileName=E.readData(this.fileNameLength),E.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((R=function(T){for(var o in _)if(Object.prototype.hasOwnProperty.call(_,o)&&_[o].magic===T)return _[o];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,R,E.readData(this.compressedSize))},readCentralPart:function(E){this.versionMadeBy=E.readInt(2),E.skip(2),this.bitFlag=E.readInt(2),this.compressionMethod=E.readString(2),this.date=E.readDate(),this.crc32=E.readInt(4),this.compressedSize=E.readInt(4),this.uncompressedSize=E.readInt(4);var R=E.readInt(2);if(this.extraFieldsLength=E.readInt(2),this.fileCommentLength=E.readInt(2),this.diskNumberStart=E.readInt(2),this.internalFileAttributes=E.readInt(2),this.externalFileAttributes=E.readInt(4),this.localHeaderOffset=E.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");E.skip(R),this.readExtraFields(E),this.parseZIP64ExtraField(E),this.fileComment=E.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var E=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),E==0&&(this.dosPermissions=63&this.externalFileAttributes),E==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var E=l(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=E.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=E.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=E.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=E.readInt(4))}},readExtraFields:function(E){var R,b,T,o=E.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});E.index+4<o;)R=E.readInt(2),b=E.readInt(2),T=E.readData(b),this.extraFields[R]={id:R,length:b,value:T};E.setIndex(o)},handleUTF8:function(){var E=k.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=w.utf8decode(this.fileName),this.fileCommentStr=w.utf8decode(this.fileComment);else{var R=this.findExtraFieldUnicodePath();if(R!==null)this.fileNameStr=R;else{var b=d.transformTo(E,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var T=this.findExtraFieldUnicodeComment();if(T!==null)this.fileCommentStr=T;else{var o=d.transformTo(E,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var E=this.extraFields[28789];if(E){var R=l(E.value);return R.readInt(1)!==1||c(this.fileName)!==R.readInt(4)?null:w.utf8decode(R.readData(E.length-5))}return null},findExtraFieldUnicodeComment:function(){var E=this.extraFields[25461];if(E){var R=l(E.value);return R.readInt(1)!==1||c(this.fileComment)!==R.readInt(4)?null:w.utf8decode(R.readData(E.length-5))}return null}},a.exports=C},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,a,h){function l(R,b,T){this.name=R,this.dir=T.dir,this.date=T.date,this.comment=T.comment,this.unixPermissions=T.unixPermissions,this.dosPermissions=T.dosPermissions,this._data=b,this._dataBinary=T.binary,this.options={compression:T.compression,compressionOptions:T.compressionOptions}}var d=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),c=t("./utf8"),w=t("./compressedObject"),_=t("./stream/GenericWorker");l.prototype={internalStream:function(R){var b=null,T="string";try{if(!R)throw new Error("No output type specified.");var o=(T=R.toLowerCase())==="string"||T==="text";T!=="binarystring"&&T!=="text"||(T="string"),b=this._decompressWorker();var y=!this._dataBinary;y&&!o&&(b=b.pipe(new c.Utf8EncodeWorker)),!y&&o&&(b=b.pipe(new c.Utf8DecodeWorker))}catch(m){(b=new _("error")).error(m)}return new d(b,T,"")},async:function(R,b){return this.internalStream(R).accumulate(b)},nodeStream:function(R,b){return this.internalStream(R||"nodebuffer").toNodejsStream(b)},_compressWorker:function(R,b){if(this._data instanceof w&&this._data.compression.magic===R.magic)return this._data.getCompressedWorker();var T=this._decompressWorker();return this._dataBinary||(T=T.pipe(new c.Utf8EncodeWorker)),w.createWorkerFrom(T,R,b)},_decompressWorker:function(){return this._data instanceof w?this._data.getContentWorker():this._data instanceof _?this._data:new n(this._data)}};for(var k=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],C=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},E=0;E<k.length;E++)l.prototype[k[E]]=C;a.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,a,h){(function(l){var d,n,c=l.MutationObserver||l.WebKitMutationObserver;if(c){var w=0,_=new c(R),k=l.document.createTextNode("");_.observe(k,{characterData:!0}),d=function(){k.data=w=++w%2}}else if(l.setImmediate||l.MessageChannel===void 0)d="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var b=l.document.createElement("script");b.onreadystatechange=function(){R(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},l.document.documentElement.appendChild(b)}:function(){setTimeout(R,0)};else{var C=new l.MessageChannel;C.port1.onmessage=R,d=function(){C.port2.postMessage(0)}}var E=[];function R(){var b,T;n=!0;for(var o=E.length;o;){for(T=E,E=[],b=-1;++b<o;)T[b]();o=E.length}n=!1}a.exports=function(b){E.push(b)!==1||n||d()}}).call(this,typeof Ie<"u"?Ie:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,a,h){var l=t("immediate");function d(){}var n={},c=["REJECTED"],w=["FULFILLED"],_=["PENDING"];function k(o){if(typeof o!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,o!==d&&b(this,o)}function C(o,y,m){this.promise=o,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof m=="function"&&(this.onRejected=m,this.callRejected=this.otherCallRejected)}function E(o,y,m){l(function(){var u;try{u=y(m)}catch(A){return n.reject(o,A)}u===o?n.reject(o,new TypeError("Cannot resolve promise with itself")):n.resolve(o,u)})}function R(o){var y=o&&o.then;if(o&&(typeof o=="object"||typeof o=="function")&&typeof y=="function")return function(){y.apply(o,arguments)}}function b(o,y){var m=!1;function u(j){m||(m=!0,n.reject(o,j))}function A(j){m||(m=!0,n.resolve(o,j))}var P=T(function(){y(A,u)});P.status==="error"&&u(P.value)}function T(o,y){var m={};try{m.value=o(y),m.status="success"}catch(u){m.status="error",m.value=u}return m}(a.exports=k).prototype.finally=function(o){if(typeof o!="function")return this;var y=this.constructor;return this.then(function(m){return y.resolve(o()).then(function(){return m})},function(m){return y.resolve(o()).then(function(){throw m})})},k.prototype.catch=function(o){return this.then(null,o)},k.prototype.then=function(o,y){if(typeof o!="function"&&this.state===w||typeof y!="function"&&this.state===c)return this;var m=new this.constructor(d);return this.state!==_?E(m,this.state===w?o:y,this.outcome):this.queue.push(new C(m,o,y)),m},C.prototype.callFulfilled=function(o){n.resolve(this.promise,o)},C.prototype.otherCallFulfilled=function(o){E(this.promise,this.onFulfilled,o)},C.prototype.callRejected=function(o){n.reject(this.promise,o)},C.prototype.otherCallRejected=function(o){E(this.promise,this.onRejected,o)},n.resolve=function(o,y){var m=T(R,y);if(m.status==="error")return n.reject(o,m.value);var u=m.value;if(u)b(o,u);else{o.state=w,o.outcome=y;for(var A=-1,P=o.queue.length;++A<P;)o.queue[A].callFulfilled(y)}return o},n.reject=function(o,y){o.state=c,o.outcome=y;for(var m=-1,u=o.queue.length;++m<u;)o.queue[m].callRejected(y);return o},k.resolve=function(o){return o instanceof this?o:n.resolve(new this(d),o)},k.reject=function(o){var y=new this(d);return n.reject(y,o)},k.all=function(o){var y=this;if(Object.prototype.toString.call(o)!=="[object Array]")return this.reject(new TypeError("must be an array"));var m=o.length,u=!1;if(!m)return this.resolve([]);for(var A=new Array(m),P=0,j=-1,q=new this(d);++j<m;)N(o[j],j);return q;function N(Y,ue){y.resolve(Y).then(function(I){A[ue]=I,++P!==m||u||(u=!0,n.resolve(q,A))},function(I){u||(u=!0,n.reject(q,I))})}},k.race=function(o){var y=this;if(Object.prototype.toString.call(o)!=="[object Array]")return this.reject(new TypeError("must be an array"));var m=o.length,u=!1;if(!m)return this.resolve([]);for(var A=-1,P=new this(d);++A<m;)j=o[A],y.resolve(j).then(function(q){u||(u=!0,n.resolve(P,q))},function(q){u||(u=!0,n.reject(P,q))});var j;return P}},{immediate:36}],38:[function(t,a,h){var l={};(0,t("./lib/utils/common").assign)(l,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),a.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,a,h){var l=t("./zlib/deflate"),d=t("./utils/common"),n=t("./utils/strings"),c=t("./zlib/messages"),w=t("./zlib/zstream"),_=Object.prototype.toString,k=0,C=-1,E=0,R=8;function b(o){if(!(this instanceof b))return new b(o);this.options=d.assign({level:C,method:R,chunkSize:16384,windowBits:15,memLevel:8,strategy:E,to:""},o||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var m=l.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(m!==k)throw new Error(c[m]);if(y.header&&l.deflateSetHeader(this.strm,y.header),y.dictionary){var u;if(u=typeof y.dictionary=="string"?n.string2buf(y.dictionary):_.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(m=l.deflateSetDictionary(this.strm,u))!==k)throw new Error(c[m]);this._dict_set=!0}}function T(o,y){var m=new b(y);if(m.push(o,!0),m.err)throw m.msg||c[m.err];return m.result}b.prototype.push=function(o,y){var m,u,A=this.strm,P=this.options.chunkSize;if(this.ended)return!1;u=y===~~y?y:y===!0?4:0,typeof o=="string"?A.input=n.string2buf(o):_.call(o)==="[object ArrayBuffer]"?A.input=new Uint8Array(o):A.input=o,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new d.Buf8(P),A.next_out=0,A.avail_out=P),(m=l.deflate(A,u))!==1&&m!==k)return this.onEnd(m),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||u!==4&&u!==2)||(this.options.to==="string"?this.onData(n.buf2binstring(d.shrinkBuf(A.output,A.next_out))):this.onData(d.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&m!==1);return u===4?(m=l.deflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===k):u!==2||(this.onEnd(k),!(A.avail_out=0))},b.prototype.onData=function(o){this.chunks.push(o)},b.prototype.onEnd=function(o){o===k&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg},h.Deflate=b,h.deflate=T,h.deflateRaw=function(o,y){return(y=y||{}).raw=!0,T(o,y)},h.gzip=function(o,y){return(y=y||{}).gzip=!0,T(o,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,a,h){var l=t("./zlib/inflate"),d=t("./utils/common"),n=t("./utils/strings"),c=t("./zlib/constants"),w=t("./zlib/messages"),_=t("./zlib/zstream"),k=t("./zlib/gzheader"),C=Object.prototype.toString;function E(b){if(!(this instanceof E))return new E(b);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},b||{});var T=this.options;T.raw&&0<=T.windowBits&&T.windowBits<16&&(T.windowBits=-T.windowBits,T.windowBits===0&&(T.windowBits=-15)),!(0<=T.windowBits&&T.windowBits<16)||b&&b.windowBits||(T.windowBits+=32),15<T.windowBits&&T.windowBits<48&&!(15&T.windowBits)&&(T.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var o=l.inflateInit2(this.strm,T.windowBits);if(o!==c.Z_OK)throw new Error(w[o]);this.header=new k,l.inflateGetHeader(this.strm,this.header)}function R(b,T){var o=new E(T);if(o.push(b,!0),o.err)throw o.msg||w[o.err];return o.result}E.prototype.push=function(b,T){var o,y,m,u,A,P,j=this.strm,q=this.options.chunkSize,N=this.options.dictionary,Y=!1;if(this.ended)return!1;y=T===~~T?T:T===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof b=="string"?j.input=n.binstring2buf(b):C.call(b)==="[object ArrayBuffer]"?j.input=new Uint8Array(b):j.input=b,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new d.Buf8(q),j.next_out=0,j.avail_out=q),(o=l.inflate(j,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&N&&(P=typeof N=="string"?n.string2buf(N):C.call(N)==="[object ArrayBuffer]"?new Uint8Array(N):N,o=l.inflateSetDictionary(this.strm,P)),o===c.Z_BUF_ERROR&&Y===!0&&(o=c.Z_OK,Y=!1),o!==c.Z_STREAM_END&&o!==c.Z_OK)return this.onEnd(o),!(this.ended=!0);j.next_out&&(j.avail_out!==0&&o!==c.Z_STREAM_END&&(j.avail_in!==0||y!==c.Z_FINISH&&y!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(m=n.utf8border(j.output,j.next_out),u=j.next_out-m,A=n.buf2string(j.output,m),j.next_out=u,j.avail_out=q-u,u&&d.arraySet(j.output,j.output,m,u,0),this.onData(A)):this.onData(d.shrinkBuf(j.output,j.next_out)))),j.avail_in===0&&j.avail_out===0&&(Y=!0)}while((0<j.avail_in||j.avail_out===0)&&o!==c.Z_STREAM_END);return o===c.Z_STREAM_END&&(y=c.Z_FINISH),y===c.Z_FINISH?(o=l.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===c.Z_OK):y!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(j.avail_out=0))},E.prototype.onData=function(b){this.chunks.push(b)},E.prototype.onEnd=function(b){b===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},h.Inflate=E,h.inflate=R,h.inflateRaw=function(b,T){return(T=T||{}).raw=!0,R(b,T)},h.ungzip=R},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,a,h){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";h.assign=function(c){for(var w=Array.prototype.slice.call(arguments,1);w.length;){var _=w.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var k in _)_.hasOwnProperty(k)&&(c[k]=_[k])}}return c},h.shrinkBuf=function(c,w){return c.length===w?c:c.subarray?c.subarray(0,w):(c.length=w,c)};var d={arraySet:function(c,w,_,k,C){if(w.subarray&&c.subarray)c.set(w.subarray(_,_+k),C);else for(var E=0;E<k;E++)c[C+E]=w[_+E]},flattenChunks:function(c){var w,_,k,C,E,R;for(w=k=0,_=c.length;w<_;w++)k+=c[w].length;for(R=new Uint8Array(k),w=C=0,_=c.length;w<_;w++)E=c[w],R.set(E,C),C+=E.length;return R}},n={arraySet:function(c,w,_,k,C){for(var E=0;E<k;E++)c[C+E]=w[_+E]},flattenChunks:function(c){return[].concat.apply([],c)}};h.setTyped=function(c){c?(h.Buf8=Uint8Array,h.Buf16=Uint16Array,h.Buf32=Int32Array,h.assign(h,d)):(h.Buf8=Array,h.Buf16=Array,h.Buf32=Array,h.assign(h,n))},h.setTyped(l)},{}],42:[function(t,a,h){var l=t("./common"),d=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var c=new l.Buf8(256),w=0;w<256;w++)c[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;function _(k,C){if(C<65537&&(k.subarray&&n||!k.subarray&&d))return String.fromCharCode.apply(null,l.shrinkBuf(k,C));for(var E="",R=0;R<C;R++)E+=String.fromCharCode(k[R]);return E}c[254]=c[254]=1,h.string2buf=function(k){var C,E,R,b,T,o=k.length,y=0;for(b=0;b<o;b++)(64512&(E=k.charCodeAt(b)))==55296&&b+1<o&&(64512&(R=k.charCodeAt(b+1)))==56320&&(E=65536+(E-55296<<10)+(R-56320),b++),y+=E<128?1:E<2048?2:E<65536?3:4;for(C=new l.Buf8(y),b=T=0;T<y;b++)(64512&(E=k.charCodeAt(b)))==55296&&b+1<o&&(64512&(R=k.charCodeAt(b+1)))==56320&&(E=65536+(E-55296<<10)+(R-56320),b++),E<128?C[T++]=E:(E<2048?C[T++]=192|E>>>6:(E<65536?C[T++]=224|E>>>12:(C[T++]=240|E>>>18,C[T++]=128|E>>>12&63),C[T++]=128|E>>>6&63),C[T++]=128|63&E);return C},h.buf2binstring=function(k){return _(k,k.length)},h.binstring2buf=function(k){for(var C=new l.Buf8(k.length),E=0,R=C.length;E<R;E++)C[E]=k.charCodeAt(E);return C},h.buf2string=function(k,C){var E,R,b,T,o=C||k.length,y=new Array(2*o);for(E=R=0;E<o;)if((b=k[E++])<128)y[R++]=b;else if(4<(T=c[b]))y[R++]=65533,E+=T-1;else{for(b&=T===2?31:T===3?15:7;1<T&&E<o;)b=b<<6|63&k[E++],T--;1<T?y[R++]=65533:b<65536?y[R++]=b:(b-=65536,y[R++]=55296|b>>10&1023,y[R++]=56320|1023&b)}return _(y,R)},h.utf8border=function(k,C){var E;for((C=C||k.length)>k.length&&(C=k.length),E=C-1;0<=E&&(192&k[E])==128;)E--;return E<0||E===0?C:E+c[k[E]]>C?E:C}},{"./common":41}],43:[function(t,a,h){a.exports=function(l,d,n,c){for(var w=65535&l|0,_=l>>>16&65535|0,k=0;n!==0;){for(n-=k=2e3<n?2e3:n;_=_+(w=w+d[c++]|0)|0,--k;);w%=65521,_%=65521}return w|_<<16|0}},{}],44:[function(t,a,h){a.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,a,h){var l=function(){for(var d,n=[],c=0;c<256;c++){d=c;for(var w=0;w<8;w++)d=1&d?3988292384^d>>>1:d>>>1;n[c]=d}return n}();a.exports=function(d,n,c,w){var _=l,k=w+c;d^=-1;for(var C=w;C<k;C++)d=d>>>8^_[255&(d^n[C])];return-1^d}},{}],46:[function(t,a,h){var l,d=t("../utils/common"),n=t("./trees"),c=t("./adler32"),w=t("./crc32"),_=t("./messages"),k=0,C=4,E=0,R=-2,b=-1,T=4,o=2,y=8,m=9,u=286,A=30,P=19,j=2*u+1,q=15,N=3,Y=258,ue=Y+N+1,I=42,U=113,x=1,Z=2,re=3,H=4;function ie(p,M){return p.msg=_[M],M}function te(p){return(p<<1)-(4<p?9:0)}function ee(p){for(var M=p.length;0<=--M;)p[M]=0}function V(p){var M=p.state,g=M.pending;g>p.avail_out&&(g=p.avail_out),g!==0&&(d.arraySet(p.output,M.pending_buf,M.pending_out,g,p.next_out),p.next_out+=g,M.pending_out+=g,p.total_out+=g,p.avail_out-=g,M.pending-=g,M.pending===0&&(M.pending_out=0))}function O(p,M){n._tr_flush_block(p,0<=p.block_start?p.block_start:-1,p.strstart-p.block_start,M),p.block_start=p.strstart,V(p.strm)}function X(p,M){p.pending_buf[p.pending++]=M}function J(p,M){p.pending_buf[p.pending++]=M>>>8&255,p.pending_buf[p.pending++]=255&M}function ne(p,M){var g,r,s=p.max_chain_length,f=p.strstart,D=p.prev_length,G=p.nice_match,z=p.strstart>p.w_size-ue?p.strstart-(p.w_size-ue):0,se=p.window,ce=p.w_mask,oe=p.prev,fe=p.strstart+Y,de=se[f+D-1],me=se[f+D];p.prev_length>=p.good_match&&(s>>=2),G>p.lookahead&&(G=p.lookahead);do if(se[(g=M)+D]===me&&se[g+D-1]===de&&se[g]===se[f]&&se[++g]===se[f+1]){f+=2,g++;do;while(se[++f]===se[++g]&&se[++f]===se[++g]&&se[++f]===se[++g]&&se[++f]===se[++g]&&se[++f]===se[++g]&&se[++f]===se[++g]&&se[++f]===se[++g]&&se[++f]===se[++g]&&f<fe);if(r=Y-(fe-f),f=fe-Y,D<r){if(p.match_start=M,G<=(D=r))break;de=se[f+D-1],me=se[f+D]}}while((M=oe[M&ce])>z&&--s!=0);return D<=p.lookahead?D:p.lookahead}function $(p){var M,g,r,s,f,D,G,z,se,ce,oe=p.w_size;do{if(s=p.window_size-p.lookahead-p.strstart,p.strstart>=oe+(oe-ue)){for(d.arraySet(p.window,p.window,oe,oe,0),p.match_start-=oe,p.strstart-=oe,p.block_start-=oe,M=g=p.hash_size;r=p.head[--M],p.head[M]=oe<=r?r-oe:0,--g;);for(M=g=oe;r=p.prev[--M],p.prev[M]=oe<=r?r-oe:0,--g;);s+=oe}if(p.strm.avail_in===0)break;if(D=p.strm,G=p.window,z=p.strstart+p.lookahead,se=s,ce=void 0,ce=D.avail_in,se<ce&&(ce=se),g=ce===0?0:(D.avail_in-=ce,d.arraySet(G,D.input,D.next_in,ce,z),D.state.wrap===1?D.adler=c(D.adler,G,ce,z):D.state.wrap===2&&(D.adler=w(D.adler,G,ce,z)),D.next_in+=ce,D.total_in+=ce,ce),p.lookahead+=g,p.lookahead+p.insert>=N)for(f=p.strstart-p.insert,p.ins_h=p.window[f],p.ins_h=(p.ins_h<<p.hash_shift^p.window[f+1])&p.hash_mask;p.insert&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[f+N-1])&p.hash_mask,p.prev[f&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=f,f++,p.insert--,!(p.lookahead+p.insert<N)););}while(p.lookahead<ue&&p.strm.avail_in!==0)}function S(p,M){for(var g,r;;){if(p.lookahead<ue){if($(p),p.lookahead<ue&&M===k)return x;if(p.lookahead===0)break}if(g=0,p.lookahead>=N&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+N-1])&p.hash_mask,g=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),g!==0&&p.strstart-g<=p.w_size-ue&&(p.match_length=ne(p,g)),p.match_length>=N)if(r=n._tr_tally(p,p.strstart-p.match_start,p.match_length-N),p.lookahead-=p.match_length,p.match_length<=p.max_lazy_match&&p.lookahead>=N){for(p.match_length--;p.strstart++,p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+N-1])&p.hash_mask,g=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart,--p.match_length!=0;);p.strstart++}else p.strstart+=p.match_length,p.match_length=0,p.ins_h=p.window[p.strstart],p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+1])&p.hash_mask;else r=n._tr_tally(p,0,p.window[p.strstart]),p.lookahead--,p.strstart++;if(r&&(O(p,!1),p.strm.avail_out===0))return x}return p.insert=p.strstart<N-1?p.strstart:N-1,M===C?(O(p,!0),p.strm.avail_out===0?re:H):p.last_lit&&(O(p,!1),p.strm.avail_out===0)?x:Z}function v(p,M){for(var g,r,s;;){if(p.lookahead<ue){if($(p),p.lookahead<ue&&M===k)return x;if(p.lookahead===0)break}if(g=0,p.lookahead>=N&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+N-1])&p.hash_mask,g=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),p.prev_length=p.match_length,p.prev_match=p.match_start,p.match_length=N-1,g!==0&&p.prev_length<p.max_lazy_match&&p.strstart-g<=p.w_size-ue&&(p.match_length=ne(p,g),p.match_length<=5&&(p.strategy===1||p.match_length===N&&4096<p.strstart-p.match_start)&&(p.match_length=N-1)),p.prev_length>=N&&p.match_length<=p.prev_length){for(s=p.strstart+p.lookahead-N,r=n._tr_tally(p,p.strstart-1-p.prev_match,p.prev_length-N),p.lookahead-=p.prev_length-1,p.prev_length-=2;++p.strstart<=s&&(p.ins_h=(p.ins_h<<p.hash_shift^p.window[p.strstart+N-1])&p.hash_mask,g=p.prev[p.strstart&p.w_mask]=p.head[p.ins_h],p.head[p.ins_h]=p.strstart),--p.prev_length!=0;);if(p.match_available=0,p.match_length=N-1,p.strstart++,r&&(O(p,!1),p.strm.avail_out===0))return x}else if(p.match_available){if((r=n._tr_tally(p,0,p.window[p.strstart-1]))&&O(p,!1),p.strstart++,p.lookahead--,p.strm.avail_out===0)return x}else p.match_available=1,p.strstart++,p.lookahead--}return p.match_available&&(r=n._tr_tally(p,0,p.window[p.strstart-1]),p.match_available=0),p.insert=p.strstart<N-1?p.strstart:N-1,M===C?(O(p,!0),p.strm.avail_out===0?re:H):p.last_lit&&(O(p,!1),p.strm.avail_out===0)?x:Z}function K(p,M,g,r,s){this.good_length=p,this.max_lazy=M,this.nice_length=g,this.max_chain=r,this.func=s}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*j),this.dyn_dtree=new d.Buf16(2*(2*A+1)),this.bl_tree=new d.Buf16(2*(2*P+1)),ee(this.dyn_ltree),ee(this.dyn_dtree),ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(q+1),this.heap=new d.Buf16(2*u+1),ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*u+1),ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function F(p){var M;return p&&p.state?(p.total_in=p.total_out=0,p.data_type=o,(M=p.state).pending=0,M.pending_out=0,M.wrap<0&&(M.wrap=-M.wrap),M.status=M.wrap?I:U,p.adler=M.wrap===2?0:1,M.last_flush=k,n._tr_init(M),E):ie(p,R)}function B(p){var M=F(p);return M===E&&function(g){g.window_size=2*g.w_size,ee(g.head),g.max_lazy_match=l[g.level].max_lazy,g.good_match=l[g.level].good_length,g.nice_match=l[g.level].nice_length,g.max_chain_length=l[g.level].max_chain,g.strstart=0,g.block_start=0,g.lookahead=0,g.insert=0,g.match_length=g.prev_length=N-1,g.match_available=0,g.ins_h=0}(p.state),M}function Q(p,M,g,r,s,f){if(!p)return R;var D=1;if(M===b&&(M=6),r<0?(D=0,r=-r):15<r&&(D=2,r-=16),s<1||m<s||g!==y||r<8||15<r||M<0||9<M||f<0||T<f)return ie(p,R);r===8&&(r=9);var G=new L;return(p.state=G).strm=p,G.wrap=D,G.gzhead=null,G.w_bits=r,G.w_size=1<<G.w_bits,G.w_mask=G.w_size-1,G.hash_bits=s+7,G.hash_size=1<<G.hash_bits,G.hash_mask=G.hash_size-1,G.hash_shift=~~((G.hash_bits+N-1)/N),G.window=new d.Buf8(2*G.w_size),G.head=new d.Buf16(G.hash_size),G.prev=new d.Buf16(G.w_size),G.lit_bufsize=1<<s+6,G.pending_buf_size=4*G.lit_bufsize,G.pending_buf=new d.Buf8(G.pending_buf_size),G.d_buf=1*G.lit_bufsize,G.l_buf=3*G.lit_bufsize,G.level=M,G.strategy=f,G.method=g,B(p)}l=[new K(0,0,0,0,function(p,M){var g=65535;for(g>p.pending_buf_size-5&&(g=p.pending_buf_size-5);;){if(p.lookahead<=1){if($(p),p.lookahead===0&&M===k)return x;if(p.lookahead===0)break}p.strstart+=p.lookahead,p.lookahead=0;var r=p.block_start+g;if((p.strstart===0||p.strstart>=r)&&(p.lookahead=p.strstart-r,p.strstart=r,O(p,!1),p.strm.avail_out===0)||p.strstart-p.block_start>=p.w_size-ue&&(O(p,!1),p.strm.avail_out===0))return x}return p.insert=0,M===C?(O(p,!0),p.strm.avail_out===0?re:H):(p.strstart>p.block_start&&(O(p,!1),p.strm.avail_out),x)}),new K(4,4,8,4,S),new K(4,5,16,8,S),new K(4,6,32,32,S),new K(4,4,16,16,v),new K(8,16,32,32,v),new K(8,16,128,128,v),new K(8,32,128,256,v),new K(32,128,258,1024,v),new K(32,258,258,4096,v)],h.deflateInit=function(p,M){return Q(p,M,y,15,8,0)},h.deflateInit2=Q,h.deflateReset=B,h.deflateResetKeep=F,h.deflateSetHeader=function(p,M){return p&&p.state?p.state.wrap!==2?R:(p.state.gzhead=M,E):R},h.deflate=function(p,M){var g,r,s,f;if(!p||!p.state||5<M||M<0)return p?ie(p,R):R;if(r=p.state,!p.output||!p.input&&p.avail_in!==0||r.status===666&&M!==C)return ie(p,p.avail_out===0?-5:R);if(r.strm=p,g=r.last_flush,r.last_flush=M,r.status===I)if(r.wrap===2)p.adler=0,X(r,31),X(r,139),X(r,8),r.gzhead?(X(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),X(r,255&r.gzhead.time),X(r,r.gzhead.time>>8&255),X(r,r.gzhead.time>>16&255),X(r,r.gzhead.time>>24&255),X(r,r.level===9?2:2<=r.strategy||r.level<2?4:0),X(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(X(r,255&r.gzhead.extra.length),X(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(p.adler=w(p.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(X(r,0),X(r,0),X(r,0),X(r,0),X(r,0),X(r,r.level===9?2:2<=r.strategy||r.level<2?4:0),X(r,3),r.status=U);else{var D=y+(r.w_bits-8<<4)<<8;D|=(2<=r.strategy||r.level<2?0:r.level<6?1:r.level===6?2:3)<<6,r.strstart!==0&&(D|=32),D+=31-D%31,r.status=U,J(r,D),r.strstart!==0&&(J(r,p.adler>>>16),J(r,65535&p.adler)),p.adler=1}if(r.status===69)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(p.adler=w(p.adler,r.pending_buf,r.pending-s,s)),V(p),s=r.pending,r.pending!==r.pending_buf_size));)X(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(p.adler=w(p.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(r.status===73)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(p.adler=w(p.adler,r.pending_buf,r.pending-s,s)),V(p),s=r.pending,r.pending===r.pending_buf_size)){f=1;break}f=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,X(r,f)}while(f!==0);r.gzhead.hcrc&&r.pending>s&&(p.adler=w(p.adler,r.pending_buf,r.pending-s,s)),f===0&&(r.gzindex=0,r.status=91)}else r.status=91;if(r.status===91)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(p.adler=w(p.adler,r.pending_buf,r.pending-s,s)),V(p),s=r.pending,r.pending===r.pending_buf_size)){f=1;break}f=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,X(r,f)}while(f!==0);r.gzhead.hcrc&&r.pending>s&&(p.adler=w(p.adler,r.pending_buf,r.pending-s,s)),f===0&&(r.status=103)}else r.status=103;if(r.status===103&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&V(p),r.pending+2<=r.pending_buf_size&&(X(r,255&p.adler),X(r,p.adler>>8&255),p.adler=0,r.status=U)):r.status=U),r.pending!==0){if(V(p),p.avail_out===0)return r.last_flush=-1,E}else if(p.avail_in===0&&te(M)<=te(g)&&M!==C)return ie(p,-5);if(r.status===666&&p.avail_in!==0)return ie(p,-5);if(p.avail_in!==0||r.lookahead!==0||M!==k&&r.status!==666){var G=r.strategy===2?function(z,se){for(var ce;;){if(z.lookahead===0&&($(z),z.lookahead===0)){if(se===k)return x;break}if(z.match_length=0,ce=n._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,ce&&(O(z,!1),z.strm.avail_out===0))return x}return z.insert=0,se===C?(O(z,!0),z.strm.avail_out===0?re:H):z.last_lit&&(O(z,!1),z.strm.avail_out===0)?x:Z}(r,M):r.strategy===3?function(z,se){for(var ce,oe,fe,de,me=z.window;;){if(z.lookahead<=Y){if($(z),z.lookahead<=Y&&se===k)return x;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=N&&0<z.strstart&&(oe=me[fe=z.strstart-1])===me[++fe]&&oe===me[++fe]&&oe===me[++fe]){de=z.strstart+Y;do;while(oe===me[++fe]&&oe===me[++fe]&&oe===me[++fe]&&oe===me[++fe]&&oe===me[++fe]&&oe===me[++fe]&&oe===me[++fe]&&oe===me[++fe]&&fe<de);z.match_length=Y-(de-fe),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=N?(ce=n._tr_tally(z,1,z.match_length-N),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(ce=n._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),ce&&(O(z,!1),z.strm.avail_out===0))return x}return z.insert=0,se===C?(O(z,!0),z.strm.avail_out===0?re:H):z.last_lit&&(O(z,!1),z.strm.avail_out===0)?x:Z}(r,M):l[r.level].func(r,M);if(G!==re&&G!==H||(r.status=666),G===x||G===re)return p.avail_out===0&&(r.last_flush=-1),E;if(G===Z&&(M===1?n._tr_align(r):M!==5&&(n._tr_stored_block(r,0,0,!1),M===3&&(ee(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),V(p),p.avail_out===0))return r.last_flush=-1,E}return M!==C?E:r.wrap<=0?1:(r.wrap===2?(X(r,255&p.adler),X(r,p.adler>>8&255),X(r,p.adler>>16&255),X(r,p.adler>>24&255),X(r,255&p.total_in),X(r,p.total_in>>8&255),X(r,p.total_in>>16&255),X(r,p.total_in>>24&255)):(J(r,p.adler>>>16),J(r,65535&p.adler)),V(p),0<r.wrap&&(r.wrap=-r.wrap),r.pending!==0?E:1)},h.deflateEnd=function(p){var M;return p&&p.state?(M=p.state.status)!==I&&M!==69&&M!==73&&M!==91&&M!==103&&M!==U&&M!==666?ie(p,R):(p.state=null,M===U?ie(p,-3):E):R},h.deflateSetDictionary=function(p,M){var g,r,s,f,D,G,z,se,ce=M.length;if(!p||!p.state||(f=(g=p.state).wrap)===2||f===1&&g.status!==I||g.lookahead)return R;for(f===1&&(p.adler=c(p.adler,M,ce,0)),g.wrap=0,ce>=g.w_size&&(f===0&&(ee(g.head),g.strstart=0,g.block_start=0,g.insert=0),se=new d.Buf8(g.w_size),d.arraySet(se,M,ce-g.w_size,g.w_size,0),M=se,ce=g.w_size),D=p.avail_in,G=p.next_in,z=p.input,p.avail_in=ce,p.next_in=0,p.input=M,$(g);g.lookahead>=N;){for(r=g.strstart,s=g.lookahead-(N-1);g.ins_h=(g.ins_h<<g.hash_shift^g.window[r+N-1])&g.hash_mask,g.prev[r&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=r,r++,--s;);g.strstart=r,g.lookahead=N-1,$(g)}return g.strstart+=g.lookahead,g.block_start=g.strstart,g.insert=g.lookahead,g.lookahead=0,g.match_length=g.prev_length=N-1,g.match_available=0,p.next_in=G,p.input=z,p.avail_in=D,g.wrap=f,E},h.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,a,h){a.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,a,h){a.exports=function(l,d){var n,c,w,_,k,C,E,R,b,T,o,y,m,u,A,P,j,q,N,Y,ue,I,U,x,Z;n=l.state,c=l.next_in,x=l.input,w=c+(l.avail_in-5),_=l.next_out,Z=l.output,k=_-(d-l.avail_out),C=_+(l.avail_out-257),E=n.dmax,R=n.wsize,b=n.whave,T=n.wnext,o=n.window,y=n.hold,m=n.bits,u=n.lencode,A=n.distcode,P=(1<<n.lenbits)-1,j=(1<<n.distbits)-1;e:do{m<15&&(y+=x[c++]<<m,m+=8,y+=x[c++]<<m,m+=8),q=u[y&P];t:for(;;){if(y>>>=N=q>>>24,m-=N,(N=q>>>16&255)===0)Z[_++]=65535&q;else{if(!(16&N)){if(!(64&N)){q=u[(65535&q)+(y&(1<<N)-1)];continue t}if(32&N){n.mode=12;break e}l.msg="invalid literal/length code",n.mode=30;break e}Y=65535&q,(N&=15)&&(m<N&&(y+=x[c++]<<m,m+=8),Y+=y&(1<<N)-1,y>>>=N,m-=N),m<15&&(y+=x[c++]<<m,m+=8,y+=x[c++]<<m,m+=8),q=A[y&j];r:for(;;){if(y>>>=N=q>>>24,m-=N,!(16&(N=q>>>16&255))){if(!(64&N)){q=A[(65535&q)+(y&(1<<N)-1)];continue r}l.msg="invalid distance code",n.mode=30;break e}if(ue=65535&q,m<(N&=15)&&(y+=x[c++]<<m,(m+=8)<N&&(y+=x[c++]<<m,m+=8)),E<(ue+=y&(1<<N)-1)){l.msg="invalid distance too far back",n.mode=30;break e}if(y>>>=N,m-=N,(N=_-k)<ue){if(b<(N=ue-N)&&n.sane){l.msg="invalid distance too far back",n.mode=30;break e}if(U=o,(I=0)===T){if(I+=R-N,N<Y){for(Y-=N;Z[_++]=o[I++],--N;);I=_-ue,U=Z}}else if(T<N){if(I+=R+T-N,(N-=T)<Y){for(Y-=N;Z[_++]=o[I++],--N;);if(I=0,T<Y){for(Y-=N=T;Z[_++]=o[I++],--N;);I=_-ue,U=Z}}}else if(I+=T-N,N<Y){for(Y-=N;Z[_++]=o[I++],--N;);I=_-ue,U=Z}for(;2<Y;)Z[_++]=U[I++],Z[_++]=U[I++],Z[_++]=U[I++],Y-=3;Y&&(Z[_++]=U[I++],1<Y&&(Z[_++]=U[I++]))}else{for(I=_-ue;Z[_++]=Z[I++],Z[_++]=Z[I++],Z[_++]=Z[I++],2<(Y-=3););Y&&(Z[_++]=Z[I++],1<Y&&(Z[_++]=Z[I++]))}break}}break}}while(c<w&&_<C);c-=Y=m>>3,y&=(1<<(m-=Y<<3))-1,l.next_in=c,l.next_out=_,l.avail_in=c<w?w-c+5:5-(c-w),l.avail_out=_<C?C-_+257:257-(_-C),n.hold=y,n.bits=m}},{}],49:[function(t,a,h){var l=t("../utils/common"),d=t("./adler32"),n=t("./crc32"),c=t("./inffast"),w=t("./inftrees"),_=1,k=2,C=0,E=-2,R=1,b=852,T=592;function o(I){return(I>>>24&255)+(I>>>8&65280)+((65280&I)<<8)+((255&I)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function m(I){var U;return I&&I.state?(U=I.state,I.total_in=I.total_out=U.total=0,I.msg="",U.wrap&&(I.adler=1&U.wrap),U.mode=R,U.last=0,U.havedict=0,U.dmax=32768,U.head=null,U.hold=0,U.bits=0,U.lencode=U.lendyn=new l.Buf32(b),U.distcode=U.distdyn=new l.Buf32(T),U.sane=1,U.back=-1,C):E}function u(I){var U;return I&&I.state?((U=I.state).wsize=0,U.whave=0,U.wnext=0,m(I)):E}function A(I,U){var x,Z;return I&&I.state?(Z=I.state,U<0?(x=0,U=-U):(x=1+(U>>4),U<48&&(U&=15)),U&&(U<8||15<U)?E:(Z.window!==null&&Z.wbits!==U&&(Z.window=null),Z.wrap=x,Z.wbits=U,u(I))):E}function P(I,U){var x,Z;return I?(Z=new y,(I.state=Z).window=null,(x=A(I,U))!==C&&(I.state=null),x):E}var j,q,N=!0;function Y(I){if(N){var U;for(j=new l.Buf32(512),q=new l.Buf32(32),U=0;U<144;)I.lens[U++]=8;for(;U<256;)I.lens[U++]=9;for(;U<280;)I.lens[U++]=7;for(;U<288;)I.lens[U++]=8;for(w(_,I.lens,0,288,j,0,I.work,{bits:9}),U=0;U<32;)I.lens[U++]=5;w(k,I.lens,0,32,q,0,I.work,{bits:5}),N=!1}I.lencode=j,I.lenbits=9,I.distcode=q,I.distbits=5}function ue(I,U,x,Z){var re,H=I.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new l.Buf8(H.wsize)),Z>=H.wsize?(l.arraySet(H.window,U,x-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(Z<(re=H.wsize-H.wnext)&&(re=Z),l.arraySet(H.window,U,x-Z,re,H.wnext),(Z-=re)?(l.arraySet(H.window,U,x-Z,Z,0),H.wnext=Z,H.whave=H.wsize):(H.wnext+=re,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=re))),0}h.inflateReset=u,h.inflateReset2=A,h.inflateResetKeep=m,h.inflateInit=function(I){return P(I,15)},h.inflateInit2=P,h.inflate=function(I,U){var x,Z,re,H,ie,te,ee,V,O,X,J,ne,$,S,v,K,L,F,B,Q,p,M,g,r,s=0,f=new l.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!I||!I.state||!I.output||!I.input&&I.avail_in!==0)return E;(x=I.state).mode===12&&(x.mode=13),ie=I.next_out,re=I.output,ee=I.avail_out,H=I.next_in,Z=I.input,te=I.avail_in,V=x.hold,O=x.bits,X=te,J=ee,M=C;e:for(;;)switch(x.mode){case R:if(x.wrap===0){x.mode=13;break}for(;O<16;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(2&x.wrap&&V===35615){f[x.check=0]=255&V,f[1]=V>>>8&255,x.check=n(x.check,f,2,0),O=V=0,x.mode=2;break}if(x.flags=0,x.head&&(x.head.done=!1),!(1&x.wrap)||(((255&V)<<8)+(V>>8))%31){I.msg="incorrect header check",x.mode=30;break}if((15&V)!=8){I.msg="unknown compression method",x.mode=30;break}if(O-=4,p=8+(15&(V>>>=4)),x.wbits===0)x.wbits=p;else if(p>x.wbits){I.msg="invalid window size",x.mode=30;break}x.dmax=1<<p,I.adler=x.check=1,x.mode=512&V?10:12,O=V=0;break;case 2:for(;O<16;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(x.flags=V,(255&x.flags)!=8){I.msg="unknown compression method",x.mode=30;break}if(57344&x.flags){I.msg="unknown header flags set",x.mode=30;break}x.head&&(x.head.text=V>>8&1),512&x.flags&&(f[0]=255&V,f[1]=V>>>8&255,x.check=n(x.check,f,2,0)),O=V=0,x.mode=3;case 3:for(;O<32;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}x.head&&(x.head.time=V),512&x.flags&&(f[0]=255&V,f[1]=V>>>8&255,f[2]=V>>>16&255,f[3]=V>>>24&255,x.check=n(x.check,f,4,0)),O=V=0,x.mode=4;case 4:for(;O<16;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}x.head&&(x.head.xflags=255&V,x.head.os=V>>8),512&x.flags&&(f[0]=255&V,f[1]=V>>>8&255,x.check=n(x.check,f,2,0)),O=V=0,x.mode=5;case 5:if(1024&x.flags){for(;O<16;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}x.length=V,x.head&&(x.head.extra_len=V),512&x.flags&&(f[0]=255&V,f[1]=V>>>8&255,x.check=n(x.check,f,2,0)),O=V=0}else x.head&&(x.head.extra=null);x.mode=6;case 6:if(1024&x.flags&&(te<(ne=x.length)&&(ne=te),ne&&(x.head&&(p=x.head.extra_len-x.length,x.head.extra||(x.head.extra=new Array(x.head.extra_len)),l.arraySet(x.head.extra,Z,H,ne,p)),512&x.flags&&(x.check=n(x.check,Z,ne,H)),te-=ne,H+=ne,x.length-=ne),x.length))break e;x.length=0,x.mode=7;case 7:if(2048&x.flags){if(te===0)break e;for(ne=0;p=Z[H+ne++],x.head&&p&&x.length<65536&&(x.head.name+=String.fromCharCode(p)),p&&ne<te;);if(512&x.flags&&(x.check=n(x.check,Z,ne,H)),te-=ne,H+=ne,p)break e}else x.head&&(x.head.name=null);x.length=0,x.mode=8;case 8:if(4096&x.flags){if(te===0)break e;for(ne=0;p=Z[H+ne++],x.head&&p&&x.length<65536&&(x.head.comment+=String.fromCharCode(p)),p&&ne<te;);if(512&x.flags&&(x.check=n(x.check,Z,ne,H)),te-=ne,H+=ne,p)break e}else x.head&&(x.head.comment=null);x.mode=9;case 9:if(512&x.flags){for(;O<16;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(V!==(65535&x.check)){I.msg="header crc mismatch",x.mode=30;break}O=V=0}x.head&&(x.head.hcrc=x.flags>>9&1,x.head.done=!0),I.adler=x.check=0,x.mode=12;break;case 10:for(;O<32;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}I.adler=x.check=o(V),O=V=0,x.mode=11;case 11:if(x.havedict===0)return I.next_out=ie,I.avail_out=ee,I.next_in=H,I.avail_in=te,x.hold=V,x.bits=O,2;I.adler=x.check=1,x.mode=12;case 12:if(U===5||U===6)break e;case 13:if(x.last){V>>>=7&O,O-=7&O,x.mode=27;break}for(;O<3;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}switch(x.last=1&V,O-=1,3&(V>>>=1)){case 0:x.mode=14;break;case 1:if(Y(x),x.mode=20,U!==6)break;V>>>=2,O-=2;break e;case 2:x.mode=17;break;case 3:I.msg="invalid block type",x.mode=30}V>>>=2,O-=2;break;case 14:for(V>>>=7&O,O-=7&O;O<32;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if((65535&V)!=(V>>>16^65535)){I.msg="invalid stored block lengths",x.mode=30;break}if(x.length=65535&V,O=V=0,x.mode=15,U===6)break e;case 15:x.mode=16;case 16:if(ne=x.length){if(te<ne&&(ne=te),ee<ne&&(ne=ee),ne===0)break e;l.arraySet(re,Z,H,ne,ie),te-=ne,H+=ne,ee-=ne,ie+=ne,x.length-=ne;break}x.mode=12;break;case 17:for(;O<14;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(x.nlen=257+(31&V),V>>>=5,O-=5,x.ndist=1+(31&V),V>>>=5,O-=5,x.ncode=4+(15&V),V>>>=4,O-=4,286<x.nlen||30<x.ndist){I.msg="too many length or distance symbols",x.mode=30;break}x.have=0,x.mode=18;case 18:for(;x.have<x.ncode;){for(;O<3;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}x.lens[D[x.have++]]=7&V,V>>>=3,O-=3}for(;x.have<19;)x.lens[D[x.have++]]=0;if(x.lencode=x.lendyn,x.lenbits=7,g={bits:x.lenbits},M=w(0,x.lens,0,19,x.lencode,0,x.work,g),x.lenbits=g.bits,M){I.msg="invalid code lengths set",x.mode=30;break}x.have=0,x.mode=19;case 19:for(;x.have<x.nlen+x.ndist;){for(;K=(s=x.lencode[V&(1<<x.lenbits)-1])>>>16&255,L=65535&s,!((v=s>>>24)<=O);){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(L<16)V>>>=v,O-=v,x.lens[x.have++]=L;else{if(L===16){for(r=v+2;O<r;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(V>>>=v,O-=v,x.have===0){I.msg="invalid bit length repeat",x.mode=30;break}p=x.lens[x.have-1],ne=3+(3&V),V>>>=2,O-=2}else if(L===17){for(r=v+3;O<r;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}O-=v,p=0,ne=3+(7&(V>>>=v)),V>>>=3,O-=3}else{for(r=v+7;O<r;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}O-=v,p=0,ne=11+(127&(V>>>=v)),V>>>=7,O-=7}if(x.have+ne>x.nlen+x.ndist){I.msg="invalid bit length repeat",x.mode=30;break}for(;ne--;)x.lens[x.have++]=p}}if(x.mode===30)break;if(x.lens[256]===0){I.msg="invalid code -- missing end-of-block",x.mode=30;break}if(x.lenbits=9,g={bits:x.lenbits},M=w(_,x.lens,0,x.nlen,x.lencode,0,x.work,g),x.lenbits=g.bits,M){I.msg="invalid literal/lengths set",x.mode=30;break}if(x.distbits=6,x.distcode=x.distdyn,g={bits:x.distbits},M=w(k,x.lens,x.nlen,x.ndist,x.distcode,0,x.work,g),x.distbits=g.bits,M){I.msg="invalid distances set",x.mode=30;break}if(x.mode=20,U===6)break e;case 20:x.mode=21;case 21:if(6<=te&&258<=ee){I.next_out=ie,I.avail_out=ee,I.next_in=H,I.avail_in=te,x.hold=V,x.bits=O,c(I,J),ie=I.next_out,re=I.output,ee=I.avail_out,H=I.next_in,Z=I.input,te=I.avail_in,V=x.hold,O=x.bits,x.mode===12&&(x.back=-1);break}for(x.back=0;K=(s=x.lencode[V&(1<<x.lenbits)-1])>>>16&255,L=65535&s,!((v=s>>>24)<=O);){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(K&&!(240&K)){for(F=v,B=K,Q=L;K=(s=x.lencode[Q+((V&(1<<F+B)-1)>>F)])>>>16&255,L=65535&s,!(F+(v=s>>>24)<=O);){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}V>>>=F,O-=F,x.back+=F}if(V>>>=v,O-=v,x.back+=v,x.length=L,K===0){x.mode=26;break}if(32&K){x.back=-1,x.mode=12;break}if(64&K){I.msg="invalid literal/length code",x.mode=30;break}x.extra=15&K,x.mode=22;case 22:if(x.extra){for(r=x.extra;O<r;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}x.length+=V&(1<<x.extra)-1,V>>>=x.extra,O-=x.extra,x.back+=x.extra}x.was=x.length,x.mode=23;case 23:for(;K=(s=x.distcode[V&(1<<x.distbits)-1])>>>16&255,L=65535&s,!((v=s>>>24)<=O);){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(!(240&K)){for(F=v,B=K,Q=L;K=(s=x.distcode[Q+((V&(1<<F+B)-1)>>F)])>>>16&255,L=65535&s,!(F+(v=s>>>24)<=O);){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}V>>>=F,O-=F,x.back+=F}if(V>>>=v,O-=v,x.back+=v,64&K){I.msg="invalid distance code",x.mode=30;break}x.offset=L,x.extra=15&K,x.mode=24;case 24:if(x.extra){for(r=x.extra;O<r;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}x.offset+=V&(1<<x.extra)-1,V>>>=x.extra,O-=x.extra,x.back+=x.extra}if(x.offset>x.dmax){I.msg="invalid distance too far back",x.mode=30;break}x.mode=25;case 25:if(ee===0)break e;if(ne=J-ee,x.offset>ne){if((ne=x.offset-ne)>x.whave&&x.sane){I.msg="invalid distance too far back",x.mode=30;break}$=ne>x.wnext?(ne-=x.wnext,x.wsize-ne):x.wnext-ne,ne>x.length&&(ne=x.length),S=x.window}else S=re,$=ie-x.offset,ne=x.length;for(ee<ne&&(ne=ee),ee-=ne,x.length-=ne;re[ie++]=S[$++],--ne;);x.length===0&&(x.mode=21);break;case 26:if(ee===0)break e;re[ie++]=x.length,ee--,x.mode=21;break;case 27:if(x.wrap){for(;O<32;){if(te===0)break e;te--,V|=Z[H++]<<O,O+=8}if(J-=ee,I.total_out+=J,x.total+=J,J&&(I.adler=x.check=x.flags?n(x.check,re,J,ie-J):d(x.check,re,J,ie-J)),J=ee,(x.flags?V:o(V))!==x.check){I.msg="incorrect data check",x.mode=30;break}O=V=0}x.mode=28;case 28:if(x.wrap&&x.flags){for(;O<32;){if(te===0)break e;te--,V+=Z[H++]<<O,O+=8}if(V!==(4294967295&x.total)){I.msg="incorrect length check",x.mode=30;break}O=V=0}x.mode=29;case 29:M=1;break e;case 30:M=-3;break e;case 31:return-4;case 32:default:return E}return I.next_out=ie,I.avail_out=ee,I.next_in=H,I.avail_in=te,x.hold=V,x.bits=O,(x.wsize||J!==I.avail_out&&x.mode<30&&(x.mode<27||U!==4))&&ue(I,I.output,I.next_out,J-I.avail_out)?(x.mode=31,-4):(X-=I.avail_in,J-=I.avail_out,I.total_in+=X,I.total_out+=J,x.total+=J,x.wrap&&J&&(I.adler=x.check=x.flags?n(x.check,re,J,I.next_out-J):d(x.check,re,J,I.next_out-J)),I.data_type=x.bits+(x.last?64:0)+(x.mode===12?128:0)+(x.mode===20||x.mode===15?256:0),(X==0&&J===0||U===4)&&M===C&&(M=-5),M)},h.inflateEnd=function(I){if(!I||!I.state)return E;var U=I.state;return U.window&&(U.window=null),I.state=null,C},h.inflateGetHeader=function(I,U){var x;return I&&I.state&&2&(x=I.state).wrap?((x.head=U).done=!1,C):E},h.inflateSetDictionary=function(I,U){var x,Z=U.length;return I&&I.state?(x=I.state).wrap!==0&&x.mode!==11?E:x.mode===11&&d(1,U,Z,0)!==x.check?-3:ue(I,U,Z,Z)?(x.mode=31,-4):(x.havedict=1,C):E},h.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,a,h){var l=t("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];a.exports=function(_,k,C,E,R,b,T,o){var y,m,u,A,P,j,q,N,Y,ue=o.bits,I=0,U=0,x=0,Z=0,re=0,H=0,ie=0,te=0,ee=0,V=0,O=null,X=0,J=new l.Buf16(16),ne=new l.Buf16(16),$=null,S=0;for(I=0;I<=15;I++)J[I]=0;for(U=0;U<E;U++)J[k[C+U]]++;for(re=ue,Z=15;1<=Z&&J[Z]===0;Z--);if(Z<re&&(re=Z),Z===0)return R[b++]=20971520,R[b++]=20971520,o.bits=1,0;for(x=1;x<Z&&J[x]===0;x++);for(re<x&&(re=x),I=te=1;I<=15;I++)if(te<<=1,(te-=J[I])<0)return-1;if(0<te&&(_===0||Z!==1))return-1;for(ne[1]=0,I=1;I<15;I++)ne[I+1]=ne[I]+J[I];for(U=0;U<E;U++)k[C+U]!==0&&(T[ne[k[C+U]]++]=U);if(j=_===0?(O=$=T,19):_===1?(O=d,X-=257,$=n,S-=257,256):(O=c,$=w,-1),I=x,P=b,ie=U=V=0,u=-1,A=(ee=1<<(H=re))-1,_===1&&852<ee||_===2&&592<ee)return 1;for(;;){for(q=I-ie,Y=T[U]<j?(N=0,T[U]):T[U]>j?(N=$[S+T[U]],O[X+T[U]]):(N=96,0),y=1<<I-ie,x=m=1<<H;R[P+(V>>ie)+(m-=y)]=q<<24|N<<16|Y|0,m!==0;);for(y=1<<I-1;V&y;)y>>=1;if(y!==0?(V&=y-1,V+=y):V=0,U++,--J[I]==0){if(I===Z)break;I=k[C+T[U]]}if(re<I&&(V&A)!==u){for(ie===0&&(ie=re),P+=x,te=1<<(H=I-ie);H+ie<Z&&!((te-=J[H+ie])<=0);)H++,te<<=1;if(ee+=1<<H,_===1&&852<ee||_===2&&592<ee)return 1;R[u=V&A]=re<<24|H<<16|P-b|0}}return V!==0&&(R[P+V]=I-ie<<24|64<<16|0),o.bits=re,0}},{"../utils/common":41}],51:[function(t,a,h){a.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,a,h){var l=t("../utils/common"),d=0,n=1;function c(s){for(var f=s.length;0<=--f;)s[f]=0}var w=0,_=29,k=256,C=k+1+_,E=30,R=19,b=2*C+1,T=15,o=16,y=7,m=256,u=16,A=17,P=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=new Array(2*(C+2));c(ue);var I=new Array(2*E);c(I);var U=new Array(512);c(U);var x=new Array(256);c(x);var Z=new Array(_);c(Z);var re,H,ie,te=new Array(E);function ee(s,f,D,G,z){this.static_tree=s,this.extra_bits=f,this.extra_base=D,this.elems=G,this.max_length=z,this.has_stree=s&&s.length}function V(s,f){this.dyn_tree=s,this.max_code=0,this.stat_desc=f}function O(s){return s<256?U[s]:U[256+(s>>>7)]}function X(s,f){s.pending_buf[s.pending++]=255&f,s.pending_buf[s.pending++]=f>>>8&255}function J(s,f,D){s.bi_valid>o-D?(s.bi_buf|=f<<s.bi_valid&65535,X(s,s.bi_buf),s.bi_buf=f>>o-s.bi_valid,s.bi_valid+=D-o):(s.bi_buf|=f<<s.bi_valid&65535,s.bi_valid+=D)}function ne(s,f,D){J(s,D[2*f],D[2*f+1])}function $(s,f){for(var D=0;D|=1&s,s>>>=1,D<<=1,0<--f;);return D>>>1}function S(s,f,D){var G,z,se=new Array(T+1),ce=0;for(G=1;G<=T;G++)se[G]=ce=ce+D[G-1]<<1;for(z=0;z<=f;z++){var oe=s[2*z+1];oe!==0&&(s[2*z]=$(se[oe]++,oe))}}function v(s){var f;for(f=0;f<C;f++)s.dyn_ltree[2*f]=0;for(f=0;f<E;f++)s.dyn_dtree[2*f]=0;for(f=0;f<R;f++)s.bl_tree[2*f]=0;s.dyn_ltree[2*m]=1,s.opt_len=s.static_len=0,s.last_lit=s.matches=0}function K(s){8<s.bi_valid?X(s,s.bi_buf):0<s.bi_valid&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0}function L(s,f,D,G){var z=2*f,se=2*D;return s[z]<s[se]||s[z]===s[se]&&G[f]<=G[D]}function F(s,f,D){for(var G=s.heap[D],z=D<<1;z<=s.heap_len&&(z<s.heap_len&&L(f,s.heap[z+1],s.heap[z],s.depth)&&z++,!L(f,G,s.heap[z],s.depth));)s.heap[D]=s.heap[z],D=z,z<<=1;s.heap[D]=G}function B(s,f,D){var G,z,se,ce,oe=0;if(s.last_lit!==0)for(;G=s.pending_buf[s.d_buf+2*oe]<<8|s.pending_buf[s.d_buf+2*oe+1],z=s.pending_buf[s.l_buf+oe],oe++,G===0?ne(s,z,f):(ne(s,(se=x[z])+k+1,f),(ce=j[se])!==0&&J(s,z-=Z[se],ce),ne(s,se=O(--G),D),(ce=q[se])!==0&&J(s,G-=te[se],ce)),oe<s.last_lit;);ne(s,m,f)}function Q(s,f){var D,G,z,se=f.dyn_tree,ce=f.stat_desc.static_tree,oe=f.stat_desc.has_stree,fe=f.stat_desc.elems,de=-1;for(s.heap_len=0,s.heap_max=b,D=0;D<fe;D++)se[2*D]!==0?(s.heap[++s.heap_len]=de=D,s.depth[D]=0):se[2*D+1]=0;for(;s.heap_len<2;)se[2*(z=s.heap[++s.heap_len]=de<2?++de:0)]=1,s.depth[z]=0,s.opt_len--,oe&&(s.static_len-=ce[2*z+1]);for(f.max_code=de,D=s.heap_len>>1;1<=D;D--)F(s,se,D);for(z=fe;D=s.heap[1],s.heap[1]=s.heap[s.heap_len--],F(s,se,1),G=s.heap[1],s.heap[--s.heap_max]=D,s.heap[--s.heap_max]=G,se[2*z]=se[2*D]+se[2*G],s.depth[z]=(s.depth[D]>=s.depth[G]?s.depth[D]:s.depth[G])+1,se[2*D+1]=se[2*G+1]=z,s.heap[1]=z++,F(s,se,1),2<=s.heap_len;);s.heap[--s.heap_max]=s.heap[1],function(me,ke){var Ve,Oe,xt,Ee,Pt,ar,Ue=ke.dyn_tree,Ti=ke.max_code,Po=ke.stat_desc.static_tree,Bo=ke.stat_desc.has_stree,Do=ke.stat_desc.extra_bits,ki=ke.stat_desc.extra_base,_t=ke.stat_desc.max_length,Bt=0;for(Ee=0;Ee<=T;Ee++)me.bl_count[Ee]=0;for(Ue[2*me.heap[me.heap_max]+1]=0,Ve=me.heap_max+1;Ve<b;Ve++)_t<(Ee=Ue[2*Ue[2*(Oe=me.heap[Ve])+1]+1]+1)&&(Ee=_t,Bt++),Ue[2*Oe+1]=Ee,Ti<Oe||(me.bl_count[Ee]++,Pt=0,ki<=Oe&&(Pt=Do[Oe-ki]),ar=Ue[2*Oe],me.opt_len+=ar*(Ee+Pt),Bo&&(me.static_len+=ar*(Po[2*Oe+1]+Pt)));if(Bt!==0){do{for(Ee=_t-1;me.bl_count[Ee]===0;)Ee--;me.bl_count[Ee]--,me.bl_count[Ee+1]+=2,me.bl_count[_t]--,Bt-=2}while(0<Bt);for(Ee=_t;Ee!==0;Ee--)for(Oe=me.bl_count[Ee];Oe!==0;)Ti<(xt=me.heap[--Ve])||(Ue[2*xt+1]!==Ee&&(me.opt_len+=(Ee-Ue[2*xt+1])*Ue[2*xt],Ue[2*xt+1]=Ee),Oe--)}}(s,f),S(se,de,s.bl_count)}function p(s,f,D){var G,z,se=-1,ce=f[1],oe=0,fe=7,de=4;for(ce===0&&(fe=138,de=3),f[2*(D+1)+1]=65535,G=0;G<=D;G++)z=ce,ce=f[2*(G+1)+1],++oe<fe&&z===ce||(oe<de?s.bl_tree[2*z]+=oe:z!==0?(z!==se&&s.bl_tree[2*z]++,s.bl_tree[2*u]++):oe<=10?s.bl_tree[2*A]++:s.bl_tree[2*P]++,se=z,de=(oe=0)===ce?(fe=138,3):z===ce?(fe=6,3):(fe=7,4))}function M(s,f,D){var G,z,se=-1,ce=f[1],oe=0,fe=7,de=4;for(ce===0&&(fe=138,de=3),G=0;G<=D;G++)if(z=ce,ce=f[2*(G+1)+1],!(++oe<fe&&z===ce)){if(oe<de)for(;ne(s,z,s.bl_tree),--oe!=0;);else z!==0?(z!==se&&(ne(s,z,s.bl_tree),oe--),ne(s,u,s.bl_tree),J(s,oe-3,2)):oe<=10?(ne(s,A,s.bl_tree),J(s,oe-3,3)):(ne(s,P,s.bl_tree),J(s,oe-11,7));se=z,de=(oe=0)===ce?(fe=138,3):z===ce?(fe=6,3):(fe=7,4)}}c(te);var g=!1;function r(s,f,D,G){J(s,(w<<1)+(G?1:0),3),function(z,se,ce,oe){K(z),X(z,ce),X(z,~ce),l.arraySet(z.pending_buf,z.window,se,ce,z.pending),z.pending+=ce}(s,f,D)}h._tr_init=function(s){g||(function(){var f,D,G,z,se,ce=new Array(T+1);for(z=G=0;z<_-1;z++)for(Z[z]=G,f=0;f<1<<j[z];f++)x[G++]=z;for(x[G-1]=z,z=se=0;z<16;z++)for(te[z]=se,f=0;f<1<<q[z];f++)U[se++]=z;for(se>>=7;z<E;z++)for(te[z]=se<<7,f=0;f<1<<q[z]-7;f++)U[256+se++]=z;for(D=0;D<=T;D++)ce[D]=0;for(f=0;f<=143;)ue[2*f+1]=8,f++,ce[8]++;for(;f<=255;)ue[2*f+1]=9,f++,ce[9]++;for(;f<=279;)ue[2*f+1]=7,f++,ce[7]++;for(;f<=287;)ue[2*f+1]=8,f++,ce[8]++;for(S(ue,C+1,ce),f=0;f<E;f++)I[2*f+1]=5,I[2*f]=$(f,5);re=new ee(ue,j,k+1,C,T),H=new ee(I,q,0,E,T),ie=new ee(new Array(0),N,0,R,y)}(),g=!0),s.l_desc=new V(s.dyn_ltree,re),s.d_desc=new V(s.dyn_dtree,H),s.bl_desc=new V(s.bl_tree,ie),s.bi_buf=0,s.bi_valid=0,v(s)},h._tr_stored_block=r,h._tr_flush_block=function(s,f,D,G){var z,se,ce=0;0<s.level?(s.strm.data_type===2&&(s.strm.data_type=function(oe){var fe,de=4093624447;for(fe=0;fe<=31;fe++,de>>>=1)if(1&de&&oe.dyn_ltree[2*fe]!==0)return d;if(oe.dyn_ltree[18]!==0||oe.dyn_ltree[20]!==0||oe.dyn_ltree[26]!==0)return n;for(fe=32;fe<k;fe++)if(oe.dyn_ltree[2*fe]!==0)return n;return d}(s)),Q(s,s.l_desc),Q(s,s.d_desc),ce=function(oe){var fe;for(p(oe,oe.dyn_ltree,oe.l_desc.max_code),p(oe,oe.dyn_dtree,oe.d_desc.max_code),Q(oe,oe.bl_desc),fe=R-1;3<=fe&&oe.bl_tree[2*Y[fe]+1]===0;fe--);return oe.opt_len+=3*(fe+1)+5+5+4,fe}(s),z=s.opt_len+3+7>>>3,(se=s.static_len+3+7>>>3)<=z&&(z=se)):z=se=D+5,D+4<=z&&f!==-1?r(s,f,D,G):s.strategy===4||se===z?(J(s,2+(G?1:0),3),B(s,ue,I)):(J(s,4+(G?1:0),3),function(oe,fe,de,me){var ke;for(J(oe,fe-257,5),J(oe,de-1,5),J(oe,me-4,4),ke=0;ke<me;ke++)J(oe,oe.bl_tree[2*Y[ke]+1],3);M(oe,oe.dyn_ltree,fe-1),M(oe,oe.dyn_dtree,de-1)}(s,s.l_desc.max_code+1,s.d_desc.max_code+1,ce+1),B(s,s.dyn_ltree,s.dyn_dtree)),v(s),G&&K(s)},h._tr_tally=function(s,f,D){return s.pending_buf[s.d_buf+2*s.last_lit]=f>>>8&255,s.pending_buf[s.d_buf+2*s.last_lit+1]=255&f,s.pending_buf[s.l_buf+s.last_lit]=255&D,s.last_lit++,f===0?s.dyn_ltree[2*D]++:(s.matches++,f--,s.dyn_ltree[2*(x[D]+k+1)]++,s.dyn_dtree[2*O(f)]++),s.last_lit===s.lit_bufsize-1},h._tr_align=function(s){J(s,2,3),ne(s,m,ue),function(f){f.bi_valid===16?(X(f,f.bi_buf),f.bi_buf=0,f.bi_valid=0):8<=f.bi_valid&&(f.pending_buf[f.pending++]=255&f.bi_buf,f.bi_buf>>=8,f.bi_valid-=8)}(s)}},{"../utils/common":41}],53:[function(t,a,h){a.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,a,h){(function(l){(function(d,n){if(!d.setImmediate){var c,w,_,k,C=1,E={},R=!1,b=d.document,T=Object.getPrototypeOf&&Object.getPrototypeOf(d);T=T&&T.setTimeout?T:d,c={}.toString.call(d.process)==="[object process]"?function(u){ge.nextTick(function(){y(u)})}:function(){if(d.postMessage&&!d.importScripts){var u=!0,A=d.onmessage;return d.onmessage=function(){u=!1},d.postMessage("","*"),d.onmessage=A,u}}()?(k="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",m,!1):d.attachEvent("onmessage",m),function(u){d.postMessage(k+u,"*")}):d.MessageChannel?((_=new MessageChannel).port1.onmessage=function(u){y(u.data)},function(u){_.port2.postMessage(u)}):b&&"onreadystatechange"in b.createElement("script")?(w=b.documentElement,function(u){var A=b.createElement("script");A.onreadystatechange=function(){y(u),A.onreadystatechange=null,w.removeChild(A),A=null},w.appendChild(A)}):function(u){setTimeout(y,0,u)},T.setImmediate=function(u){typeof u!="function"&&(u=new Function(""+u));for(var A=new Array(arguments.length-1),P=0;P<A.length;P++)A[P]=arguments[P+1];var j={callback:u,args:A};return E[C]=j,c(C),C++},T.clearImmediate=o}function o(u){delete E[u]}function y(u){if(R)setTimeout(y,0,u);else{var A=E[u];if(A){R=!0;try{(function(P){var j=P.callback,q=P.args;switch(q.length){case 0:j();break;case 1:j(q[0]);break;case 2:j(q[0],q[1]);break;case 3:j(q[0],q[1],q[2]);break;default:j.apply(n,q)}})(A)}finally{o(u),R=!1}}}}function m(u){u.source===d&&typeof u.data=="string"&&u.data.indexOf(k)===0&&y(+u.data.slice(k.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof Ie<"u"?Ie:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Yn)),Yn.exports}var Mf=Lf();const Uf=Ua(Mf);var kt={exports:{}},Jn,Ba;function zf(){if(Ba)return Jn;Ba=1;var i={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function e(t){return t&&t.replace?t.replace(/([&"<>'])/g,function(a,h){return i[h]}):t}return Jn=e,Jn}var Da;function Wf(){if(Da)return kt.exports;Da=1;var i=zf(),e=wi().Stream,t="    ";function a(w,_){typeof _!="object"&&(_={indent:_});var k=_.stream?new e:null,C="",E=!1,R=_.indent?_.indent===!0?t:_.indent:"",b=!0;function T(A){b?ge.nextTick(A):A()}function o(A,P){if(P!==void 0&&(C+=P),A&&!E&&(k=k||new e,E=!0),A&&E){var j=C;T(function(){k.emit("data",j)}),C=""}}function y(A,P){n(o,d(A,R,R?1:0),P)}function m(){if(k){var A=C;T(function(){k.emit("data",A),k.emit("end"),k.readable=!1,k.emit("close")})}}function u(A){var P=A.encoding||"UTF-8",j={version:"1.0",encoding:P};A.standalone&&(j.standalone=A.standalone),y({"?xml":{_attr:j}}),C=C.replace("/>","?>")}return T(function(){b=!1}),_.declaration&&u(_.declaration),w&&w.forEach?w.forEach(function(A,P){var j;P+1===w.length&&(j=m),y(A,j)}):y(w,m),k?(k.readable=!0,k):C}function h(){var w=Array.prototype.slice.call(arguments),_={_elem:d(w)};return _.push=function(k){if(!this.append)throw new Error("not assigned to a parent!");var C=this,E=this._elem.indent;n(this.append,d(k,E,this._elem.icount+(E?1:0)),function(){C.append(!0)})},_.close=function(k){k!==void 0&&this.push(k),this.end&&this.end()},_}function l(w,_){return new Array(_||0).join(w||"")}function d(w,_,k){k=k||0;var C=l(_,k),E,R=w,b=!1;if(typeof w=="object"){var T=Object.keys(w);if(E=T[0],R=w[E],R&&R._elem)return R._elem.name=E,R._elem.icount=k,R._elem.indent=_,R._elem.indents=C,R._elem.interrupt=R,R._elem}var o=[],y=[],m;function u(A){var P=Object.keys(A);P.forEach(function(j){o.push(c(j,A[j]))})}switch(typeof R){case"object":if(R===null)break;R._attr&&u(R._attr),R._cdata&&y.push(("<![CDATA["+R._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),R.forEach&&(m=!1,y.push(""),R.forEach(function(A){if(typeof A=="object"){var P=Object.keys(A)[0];P=="_attr"?u(A._attr):y.push(d(A,_,k+1))}else y.pop(),m=!0,y.push(i(A))}),m||y.push(""));break;default:y.push(i(R))}return{name:E,interrupt:b,attributes:o,content:y,icount:k,indents:C,indent:_}}function n(w,_,k){if(typeof _!="object")return w(!1,_);var C=_.interrupt?1:_.content.length;function E(){for(;_.content.length;){var b=_.content.shift();if(b!==void 0){if(R(b))return;n(w,b)}}w(!1,(C>1?_.indents:"")+(_.name?"</"+_.name+">":"")+(_.indent&&!k?`
`:"")),k&&k()}function R(b){return b.interrupt?(b.interrupt.append=w,b.interrupt.end=E,b.interrupt=!1,w(!0),!0):!1}if(w(!1,_.indents+(_.name?"<"+_.name:"")+(_.attributes.length?" "+_.attributes.join(" "):"")+(C?_.name?">":"":_.name?"/>":"")+(_.indent&&C>1?`
`:"")),!C)return w(!1,_.indent?`
`:"");R(_)||E()}function c(w,_){return w+'="'+i(_)+'"'}return kt.exports=a,kt.exports.element=kt.exports.Element=h,kt.exports}var Hf=Wf();const xe=Ua(Hf),Rt=0,Qn=32,qf=32,Kf=(i,e)=>{const t=e.replace(/-/g,"");if(t.length!==qf)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);const h=t.replace(/(..)/g,"$1 ").trim().split(" ").map(c=>parseInt(c,16));h.reverse();const d=i.slice(Rt,Qn).map((c,w)=>c^h[w%h.length]),n=new Uint8Array(Rt+d.length+Math.max(0,i.length-Qn));return n.set(i.slice(0,Rt)),n.set(d,Rt),n.set(i.slice(Qn),Rt+d.length),n};class Gf{format(e,t={stack:[]}){const a=e.prepForXml(t);if(a)return a;throw Error("XMLComponent did not format correctly")}}class Vf{replace(e,t,a){let h=e;return t.forEach((l,d)=>{h=h.replace(new RegExp(`{${l.fileName}}`,"g"),(a+d).toString())}),h}getMediaData(e,t){return t.Array.filter(a=>e.search(`{${a.fileName}}`)>0)}}class Xf{replace(e,t){let a=e;for(const h of t)a=a.replace(new RegExp(`{${h.reference}-${h.instance}}`,"g"),h.numId.toString());return a}}class $f{constructor(){ae(this,"formatter"),ae(this,"imageReplacer"),ae(this,"numberingReplacer"),this.formatter=new Gf,this.imageReplacer=new Vf,this.numberingReplacer=new Xf}compile(e,t,a=[]){const h=new Uf,l=this.xmlifyFile(e,t),d=new Map(Object.entries(l));for(const[,n]of d)if(Array.isArray(n))for(const c of n)h.file(c.path,c.data);else h.file(n.path,n.data);for(const n of a)h.file(n.path,n.data);for(const n of e.Media.Array)n.type!=="svg"?h.file(`word/media/${n.fileName}`,n.data):(h.file(`word/media/${n.fileName}`,n.data),h.file(`word/media/${n.fallback.fileName}`,n.fallback.data));for(const{data:n,name:c,fontKey:w}of e.FontTable.fontOptionsWithKey){const[_]=c.split(".");h.file(`word/fonts/${_}.odttf`,Kf(n,w))}return h}xmlifyFile(e,t){const a=e.Document.Relationships.RelationshipCount+1,h=xe(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),l=e.Comments.Relationships.RelationshipCount+1,d=xe(this.formatter.format(e.Comments,{viewWrapper:{View:e.Comments,Relationships:e.Comments.Relationships},file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),n=this.imageReplacer.getMediaData(h,e.Media),c=this.imageReplacer.getMediaData(d,e.Media);return{Relationships:{data:(n.forEach((w,_)=>{e.Document.Relationships.createRelationship(a+_,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${w.fileName}`)}),e.Document.Relationships.createRelationship(e.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),xe(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const w=this.imageReplacer.replace(h,n,a);return this.numberingReplacer.replace(w,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const w=xe(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(w,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:xe(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:xe(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:xe(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((w,_)=>{const k=xe(this.formatter.format(w.View,{viewWrapper:w,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(k,e.Media).forEach((E,R)=>{w.Relationships.createRelationship(R,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${E.fileName}`)}),{data:xe(this.formatter.format(w.Relationships,{viewWrapper:w,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${_+1}.xml.rels`}}),FooterRelationships:e.Footers.map((w,_)=>{const k=xe(this.formatter.format(w.View,{viewWrapper:w,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(k,e.Media).forEach((E,R)=>{w.Relationships.createRelationship(R,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${E.fileName}`)}),{data:xe(this.formatter.format(w.Relationships,{viewWrapper:w,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${_+1}.xml.rels`}}),Headers:e.Headers.map((w,_)=>{const k=xe(this.formatter.format(w.View,{viewWrapper:w,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),C=this.imageReplacer.getMediaData(k,e.Media),E=this.imageReplacer.replace(k,C,0);return{data:this.numberingReplacer.replace(E,e.Numbering.ConcreteNumbering),path:`word/header${_+1}.xml`}}),Footers:e.Footers.map((w,_)=>{const k=xe(this.formatter.format(w.View,{viewWrapper:w,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),C=this.imageReplacer.getMediaData(k,e.Media),E=this.imageReplacer.replace(k,C,0);return{data:this.numberingReplacer.replace(E,e.Numbering.ConcreteNumbering),path:`word/footer${_+1}.xml`}}),ContentTypes:{data:xe(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:xe(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:xe(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:xe(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:xe(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:xe(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{const w=this.imageReplacer.replace(d,c,l);return this.numberingReplacer.replace(w,e.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(c.forEach((w,_)=>{e.Comments.Relationships.createRelationship(l+_,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${w.fileName}`)}),xe(this.formatter.format(e.Comments.Relationships,{viewWrapper:{View:e.Comments,Relationships:e.Comments.Relationships},file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:xe(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:xe(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const Zf={WITH_2_BLANKS:"  "},ja=i=>i===!0?Zf.WITH_2_BLANKS:i===!1?void 0:i,Fo=class ht{static pack(e,t,a){return ul(this,arguments,function*(h,l,d,n=[]){return this.compiler.compile(h,ja(d),n).generateAsync({type:l,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(e,t,a=[]){return ht.pack(e,"string",t,a)}static toBuffer(e,t,a=[]){return ht.pack(e,"nodebuffer",t,a)}static toBase64String(e,t,a=[]){return ht.pack(e,"base64",t,a)}static toBlob(e,t,a=[]){return ht.pack(e,"blob",t,a)}static toArrayBuffer(e,t,a=[]){return ht.pack(e,"arraybuffer",t,a)}static toStream(e,t,a=[]){const h=new jf.Stream;return this.compiler.compile(e,ja(t),a).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(d=>{h.emit("data",d),h.emit("end")}),h}};ae(Fo,"compiler",new $f);let Yf=Fo;var Oo={exports:{}};(function(i,e){(function(t,a){a()})(Et,function(){function t(w,_){return typeof _>"u"?_={autoBom:!1}:typeof _!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),_={autoBom:!_}),_.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(w.type)?new Blob(["\uFEFF",w],{type:w.type}):w}function a(w,_,k){var C=new XMLHttpRequest;C.open("GET",w),C.responseType="blob",C.onload=function(){c(C.response,_,k)},C.onerror=function(){console.error("could not download file")},C.send()}function h(w){var _=new XMLHttpRequest;_.open("HEAD",w,!1);try{_.send()}catch{}return 200<=_.status&&299>=_.status}function l(w){try{w.dispatchEvent(new MouseEvent("click"))}catch{var _=document.createEvent("MouseEvents");_.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),w.dispatchEvent(_)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Et=="object"&&Et.global===Et?Et:void 0,n=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(w,_,k){var C=d.URL||d.webkitURL,E=document.createElement("a");_=_||w.name||"download",E.download=_,E.rel="noopener",typeof w=="string"?(E.href=w,E.origin===location.origin?l(E):h(E.href)?a(w,_,k):l(E,E.target="_blank")):(E.href=C.createObjectURL(w),setTimeout(function(){C.revokeObjectURL(E.href)},4e4),setTimeout(function(){l(E)},0))}:"msSaveOrOpenBlob"in navigator?function(w,_,k){if(_=_||w.name||"download",typeof w!="string")navigator.msSaveOrOpenBlob(t(w,k),_);else if(h(w))a(w,_,k);else{var C=document.createElement("a");C.href=w,C.target="_blank",setTimeout(function(){l(C)})}}:function(w,_,k,C){if(C=C||open("","_blank"),C&&(C.document.title=C.document.body.innerText="downloading..."),typeof w=="string")return a(w,_,k);var E=w.type==="application/octet-stream",R=/constructor/i.test(d.HTMLElement)||d.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||E&&R||n)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var m=T.result;m=b?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),C?C.location.href=m:location=m,C=null},T.readAsDataURL(w)}else{var o=d.URL||d.webkitURL,y=o.createObjectURL(w);C?C.location=y:location.href=y,C=null,setTimeout(function(){o.revokeObjectURL(y)},4e4)}});d.saveAs=c.saveAs=c,i.exports=c})})(Oo);var Jf=Oo.exports;async function Qf(i){const e=i.format,t=c=>e.levelOrder==="worst-first"?[...c.levels].reverse():c.levels,a=i.criteria[0]?t(i.criteria[0]):[],h=new Ca({tableHeader:!0,children:[new ft({width:{size:25,type:Xe.PERCENTAGE},children:[new Re({children:[new Be({text:"Criterion",bold:!0,color:"FFFFFF"})],alignment:Ce.LEFT})],shading:{fill:e.headerColor.replace("#","")}}),...a.map(c=>{const w=e.showPoints?` (${c.minPoints===c.maxPoints?c.maxPoints:`${c.minPoints}-${c.maxPoints}`} pts)`:"";return new ft({width:{size:75/a.length,type:Xe.PERCENTAGE},children:[new Re({children:[new Be({text:c.label,bold:!0,color:"FFFFFF"}),...w?[new Be({text:w,size:20,color:"FFFFFF"})]:[]],alignment:Ce.CENTER})],shading:{fill:e.headerColor.replace("#","")}})})]}),l=i.criteria.map(c=>{const w=t(c);return new Ca({children:[new ft({children:[new Re({children:[new Be({text:c.title,bold:!0})]}),...c.description?[new Re({children:[new Be({text:c.description,size:20,color:"666666"})]})]:[],...e.showWeights?[new Re({children:[new Be({text:`Weight: ${c.weight}%`,size:18,color:"666666"})],spacing:{before:100}})]:[]],width:{size:25,type:Xe.PERCENTAGE},shading:{fill:"F8F9FA"}}),...w.map(_=>new ft({children:[new Re({children:[new Be({text:_.description||"—"})]}),...e.showPoints?[new Re({children:[new Be({text:`${_.minPoints===_.maxPoints?_.maxPoints:`${_.minPoints}-${_.maxPoints}`} pts`,bold:!0})],alignment:Ce.RIGHT,spacing:{before:100}})]:[]],width:{size:75/w.length,type:Xe.PERCENTAGE}}))]})}),d=new Df({sections:[{children:[new Re({text:i.name,heading:Ea.HEADING_1,spacing:{after:200}}),...i.subject?[new Re({text:i.subject,heading:Ea.HEADING_2,spacing:{after:400}})]:[],new uh({rows:[h,...l],width:{size:100,type:Xe.PERCENTAGE}})]}]}),n=await Yf.toBlob(d);Jf.saveAs(n,`${i.name.replace(/[^a-z0-9]/gi,"_")}_rubric.docx`)}function ed(i=0,e=0,t=""){return{id:tt(),label:t,minPoints:i,maxPoints:e,description:"",subItems:[]}}function ei(){return{id:tt(),title:"New Criterion",description:"",weight:25,levels:[{id:tt(),label:"Excellent",minPoints:4,maxPoints:4,description:"",subItems:[]},{id:tt(),label:"Good",minPoints:3,maxPoints:3,description:"",subItems:[]},{id:tt(),label:"Adequate",minPoints:2,maxPoints:2,description:"",subItems:[]},{id:tt(),label:"Poor",minPoints:1,maxPoints:1,description:"",subItems:[]}]}}function yd(){const i=Lo(),{id:e}=Mo(),{rubrics:t,addRubric:a,updateRubric:h,gradeScales:l,settings:d}=La(),n=e?t.find(M=>M.id===e):void 0,[c,w]=ye.useState((n==null?void 0:n.name)??""),[_,k]=ye.useState((n==null?void 0:n.subject)??""),[C,E]=ye.useState((n==null?void 0:n.description)??""),[R,b]=ye.useState((n==null?void 0:n.criteria)??[ei()]),[T,o]=ye.useState((n==null?void 0:n.gradeScaleId)??d.defaultGradeScaleId),[y,m]=ye.useState((n==null?void 0:n.format)??Ri),[u,A]=ye.useState((n==null?void 0:n.scoringMode)??"weighted-percentage"),[P,j]=ye.useState((n==null?void 0:n.totalMaxPoints)??100),[q,N]=ye.useState(!1),[Y,ue]=ye.useState(!1),[I,U]=ye.useState(!1),[x,Z]=ye.useState(new Set),[re,H]=ye.useState(null),[ie,te]=ye.useState(!1),ee=ye.useCallback(()=>({id:(n==null?void 0:n.id)??"temp",name:c||"Untitled Rubric",subject:_,description:C,criteria:R,gradeScaleId:T,format:y,scoringMode:u,totalMaxPoints:P,attachmentIds:(n==null?void 0:n.attachmentIds)??[],createdAt:(n==null?void 0:n.createdAt)??new Date().toISOString(),updatedAt:new Date().toISOString()}),[n,c,_,C,R,T,y,u,P]),V=async M=>{te(!1);const g=ee();M==="pdf"?await Ko(g):await Qf(g)},O=ye.useCallback(()=>{const M={name:c||"Untitled Rubric",subject:_,description:C,criteria:R,gradeScaleId:T,format:y,scoringMode:u,totalMaxPoints:P,attachmentIds:(n==null?void 0:n.attachmentIds)??[]};if(n)h({...n,...M});else{const g=a(M);i(`/rubrics/${g.id}`,{replace:!0})}U(!0),setTimeout(()=>U(!1),2e3)},[c,_,C,R,T,y,u,P,n,a,h,i]);function X(M,g){const r=[...R],s=M+g;s<0||s>=r.length||([r[M],r[s]]=[r[s],r[M]],b(r))}function J(M){b(g=>g.filter(r=>r.id!==M))}function ne(M,g){b(r=>r.map(s=>s.id===M?{...s,...g}:s))}function $(M){b(g=>g.map(r=>r.id===M?{...r,levels:[...r.levels,ed(0,0,"New Level")]}:r))}function S(M,g){b(r=>r.map(s=>s.id===M?{...s,levels:s.levels.filter(f=>f.id!==g)}:s))}function v(M,g,r){b(s=>s.map(f=>f.id===M?{...f,levels:f.levels.map(D=>D.id===g?{...D,...r}:D)}:f))}function K(M,g){b(r=>r.map(s=>s.id===M?{...s,levels:s.levels.map(f=>f.id===g?{...f,subItems:[...f.subItems,{id:tt(),label:"",points:1}]}:f)}:s))}function L(M,g,r,s){b(f=>f.map(D=>D.id===M?{...D,levels:D.levels.map(G=>G.id===g?{...G,subItems:G.subItems.map(z=>z.id===r?{...z,...s}:z)}:G)}:D))}function F(M,g,r){b(s=>s.map(f=>f.id===M?{...f,levels:f.levels.map(D=>D.id===g?{...D,subItems:D.subItems.filter(G=>G.id!==r)}:D)}:f))}function B(M){Z(g=>{const r=new Set(g);return r.has(M)?r.delete(M):r.add(M),r})}function Q(M,g){ne(M,{linkedStandard:g})}function p(M){b(g=>g.map(r=>{if(r.id!==M)return r;const{linkedStandard:s,...f}=r;return f}))}return W.jsxs(W.Fragment,{children:[W.jsx(zo,{title:e?"Edit Rubric":"New Rubric",actions:W.jsxs(W.Fragment,{children:[W.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>i("/rubrics"),children:[W.jsx(Go,{size:15})," Back"]}),W.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>N(!q),children:[W.jsx(Uo,{size:15})," Format"]}),W.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>ue(!Y),children:[W.jsx(Yo,{size:15})," Preview"]}),W.jsxs("div",{style:{position:"relative"},children:[W.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>te(!ie),children:[W.jsx(Jo,{size:15})," Export"]}),ie&&W.jsxs(W.Fragment,{children:[W.jsx("div",{style:{position:"fixed",inset:0,zIndex:5},onClick:()=>te(!1)}),W.jsxs("div",{className:"card",style:{position:"absolute",top:"100%",right:0,marginTop:4,padding:4,minWidth:160,zIndex:10,display:"flex",flexDirection:"column",gap:2},children:[W.jsxs("button",{className:"btn btn-ghost btn-sm",style:{justifyContent:"flex-start"},onClick:()=>V("pdf"),children:[W.jsx(Ci,{size:14})," Export PDF"]}),W.jsxs("button",{className:"btn btn-ghost btn-sm",style:{justifyContent:"flex-start"},onClick:()=>V("docx"),children:[W.jsx(Ci,{size:14})," Export Word"]})]})]})]}),W.jsxs("button",{className:"btn btn-primary btn-sm",onClick:O,children:[W.jsx(Vo,{size:15})," ",I?"Saved!":"Save"]})]})}),W.jsxs("div",{className:"page-content fade-in",children:[W.jsxs("div",{style:{display:"grid",gridTemplateColumns:q?"1fr 300px":"1fr",gap:24},children:[W.jsxs("div",{children:[W.jsxs("div",{className:"card",style:{marginBottom:20},children:[W.jsx("h3",{style:{marginBottom:16},children:"Rubric Details"}),W.jsxs("div",{className:"grid-2",style:{gap:12},children:[W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:"Rubric Name *"}),W.jsx("input",{type:"text",value:c,onChange:M=>w(M.target.value),placeholder:"e.g. Essay Rubric"})]}),W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:"Subject"}),W.jsx("input",{type:"text",value:_,onChange:M=>k(M.target.value),placeholder:"e.g. English Literature"})]})]}),W.jsxs("div",{className:"form-group",style:{marginTop:12},children:[W.jsx("label",{children:"Description"}),W.jsx("textarea",{value:C,onChange:M=>E(M.target.value),placeholder:"Brief description…",rows:2})]}),W.jsx("div",{className:"grid-2",style:{gap:12,marginTop:12},children:W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:"Grade Scale"}),W.jsx("select",{value:T,onChange:M=>o(M.target.value),children:l.map(M=>W.jsx("option",{value:M.id,children:M.name},M.id))})]})}),W.jsxs("div",{style:{background:"var(--bg-elevated)",borderRadius:10,padding:16,marginTop:16,border:"1px solid var(--border)"},children:[W.jsx("h4",{style:{margin:"0 0 12px",fontSize:"0.9rem",color:"var(--text)"},children:"Scoring Mode"}),W.jsx("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:["weighted-percentage","total-points"].map(M=>W.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",textTransform:"none",letterSpacing:0,fontWeight:u===M?600:400},children:[W.jsx("input",{type:"radio",name:"scoringMode",value:M,checked:u===M,onChange:()=>A(M)}),M==="weighted-percentage"?"Weighted Percentage (auto)":"Fixed Total Points"]},M))}),u==="total-points"&&W.jsxs("div",{className:"form-group",style:{marginTop:12,maxWidth:200},children:[W.jsx("label",{children:"Total Max Points"}),W.jsx("input",{type:"number",min:1,value:P,onChange:M=>j(Number(M.target.value)),placeholder:"e.g. 100"}),W.jsxs("div",{className:"text-xs text-muted",style:{marginTop:4},children:["Grade = rawScore / ",P," × 100%"]})]})]})]}),W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[W.jsx("h2",{children:"Criteria"}),W.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>b(M=>[...M,ei()]),children:[W.jsx(Dt,{size:15})," Add Criterion"]})]}),R.map((M,g)=>W.jsxs("div",{className:"card",style:{marginBottom:16},children:[W.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-start",marginBottom:14},children:[W.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2,paddingTop:4},children:[W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",onClick:()=>X(g,-1),disabled:g===0,children:W.jsx(Zo,{size:14})}),W.jsx(Qo,{size:16,style:{color:"var(--text-dim)",alignSelf:"center"}}),W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",onClick:()=>X(g,1),disabled:g===R.length-1,children:W.jsx($o,{size:14})})]}),W.jsxs("div",{style:{flex:1},children:[W.jsxs("div",{className:"grid-2",style:{gap:10,gridTemplateColumns:"1fr 1fr auto"},children:[W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:"Criterion Title"}),W.jsx("input",{type:"text",value:M.title,onChange:r=>ne(M.id,{title:r.target.value}),placeholder:"e.g. Content Quality"})]}),W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:"Description (optional)"}),W.jsx("input",{type:"text",value:M.description,onChange:r=>ne(M.id,{description:r.target.value}),placeholder:"Additional details…"})]}),W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:"Weight %"}),W.jsx("input",{type:"number",value:M.weight,min:0,max:100,onChange:r=>ne(M.id,{weight:Number(r.target.value)}),style:{width:70}})]})]}),W.jsx("div",{style:{marginTop:8},children:M.linkedStandard?W.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,background:"var(--accent-soft)",border:"1px solid var(--accent)",borderRadius:8,padding:"6px 12px",fontSize:"0.8rem"},children:[W.jsx(ti,{size:13,style:{color:"var(--accent)"}}),W.jsx("span",{style:{color:"var(--accent)",fontWeight:600},children:M.linkedStandard.statementNotation??M.linkedStandard.guid}),W.jsx("span",{style:{color:"var(--text)",maxWidth:320,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:M.linkedStandard.description}),W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",style:{color:"var(--text-muted)",padding:2},onClick:()=>p(M.id),children:W.jsx(Xo,{size:12})})]}):W.jsxs("button",{className:"btn btn-ghost btn-sm",style:{color:"var(--accent)"},onClick:()=>H(M.id),children:[W.jsx(Ma,{size:13})," Link Standard"]})})]}),W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",style:{color:"var(--red)",marginTop:20},onClick:()=>J(M.id),children:W.jsx(or,{size:15})})]}),W.jsx("div",{style:{overflowX:"auto"},children:W.jsxs("div",{style:{display:"flex",gap:10,minWidth:"max-content",paddingBottom:4},children:[M.levels.map(r=>{const s=`${M.id}_${r.id}`,f=x.has(s);return W.jsxs("div",{style:{width:210,flexShrink:0,background:"var(--bg-elevated)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[W.jsxs("div",{style:{display:"flex",gap:6,marginBottom:8},children:[W.jsx("input",{type:"text",value:r.label,onChange:D=>v(M.id,r.id,{label:D.target.value}),style:{flex:1,fontWeight:600},placeholder:"Level name"}),M.levels.length>1&&W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",style:{color:"var(--red)"},onClick:()=>S(M.id,r.id),children:W.jsx(or,{size:13})})]}),W.jsxs("div",{style:{display:"flex",gap:6,marginBottom:8,alignItems:"center"},children:[W.jsxs("div",{style:{flex:1},children:[W.jsx("div",{className:"text-xs text-muted",style:{marginBottom:2},children:"Min pts"}),W.jsx("input",{type:"number",value:r.minPoints,min:0,onChange:D=>v(M.id,r.id,{minPoints:Number(D.target.value)})})]}),W.jsx("span",{style:{color:"var(--text-muted)",paddingTop:16},children:"–"}),W.jsxs("div",{style:{flex:1},children:[W.jsx("div",{className:"text-xs text-muted",style:{marginBottom:2},children:"Max pts"}),W.jsx("input",{type:"number",value:r.maxPoints,min:0,onChange:D=>v(M.id,r.id,{maxPoints:Number(D.target.value)})})]})]}),W.jsx("textarea",{value:r.description,onChange:D=>v(M.id,r.id,{description:D.target.value}),placeholder:"Describe this level…",rows:3,style:{fontSize:"0.8rem",width:"100%",marginBottom:8}}),W.jsxs("button",{className:"btn btn-ghost btn-sm",style:{width:"100%",justifyContent:"space-between"},onClick:()=>B(s),children:[W.jsxs("span",{style:{fontSize:"0.78rem"},children:["Sub-items (",r.subItems.length,")"]}),W.jsx(ri,{size:13,style:{transform:f?"rotate(90deg)":"none",transition:"transform 0.2s"}})]}),f&&W.jsxs("div",{style:{marginTop:8,display:"flex",flexDirection:"column",gap:6},children:[r.subItems.map(D=>W.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[W.jsx("input",{type:"text",value:D.label,onChange:G=>L(M.id,r.id,D.id,{label:G.target.value}),placeholder:"Sub-item label…",style:{flex:1,fontSize:"0.78rem"}}),W.jsx("input",{type:"number",value:D.points,min:0,onChange:G=>L(M.id,r.id,D.id,{points:Number(G.target.value)}),style:{width:46,fontSize:"0.78rem"},title:"Points for this sub-item"}),W.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",style:{color:"var(--red)"},onClick:()=>F(M.id,r.id,D.id),children:W.jsx(or,{size:11})})]},D.id)),W.jsxs("button",{className:"btn btn-ghost btn-sm",style:{fontSize:"0.78rem"},onClick:()=>K(M.id,r.id),children:[W.jsx(Dt,{size:12})," Add Sub-item"]})]})]},r.id)}),W.jsx("div",{style:{width:210,flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"},children:W.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>$(M.id),children:[W.jsx(Dt,{size:14})," Add Level"]})})]})})]},M.id)),R.length===0&&W.jsxs("div",{className:"empty-state",children:[W.jsx("p",{children:"No criteria added yet."}),W.jsxs("button",{className:"btn btn-primary",onClick:()=>b([ei()]),children:[W.jsx(Dt,{size:16})," Add First Criterion"]})]})]}),q&&W.jsxs("div",{className:"card",style:{height:"fit-content",position:"sticky",top:0},children:[W.jsx("h3",{style:{marginBottom:16},children:"Formatting"}),W.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[[{label:"Criterion Col Width (px)",key:"criterionColWidth",min:120,max:400},{label:"Level Col Width (px)",key:"levelColWidth",min:100,max:400},{label:"Font Size (px)",key:"fontSize",min:10,max:20}].map(({label:M,key:g,min:r,max:s})=>W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:M}),W.jsx("input",{type:"number",value:y[g],min:r,max:s,onChange:f=>m(D=>({...D,[g]:Number(f.target.value)}))})]},g)),[{label:"Header Background",key:"headerColor"},{label:"Header Text Color",key:"headerTextColor"},{label:"Accent / Selected Color",key:"accentColor"}].map(({label:M,key:g})=>W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:M}),W.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[W.jsx("input",{type:"color",value:y[g],onChange:r=>m(s=>({...s,[g]:r.target.value})),style:{width:40,height:36,padding:2,border:"1px solid var(--border)",borderRadius:6}}),W.jsx("input",{type:"text",value:y[g],onChange:r=>m(s=>({...s,[g]:r.target.value})),style:{flex:1}})]})]},g)),W.jsxs("div",{className:"form-group",children:[W.jsx("label",{children:"Level Order"}),W.jsxs("select",{value:y.levelOrder,onChange:M=>m(g=>({...g,levelOrder:M.target.value})),children:[W.jsx("option",{value:"best-first",children:"Best → Worst (left to right)"}),W.jsx("option",{value:"worst-first",children:"Worst → Best (left to right)"})]})]}),W.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[{label:"Show criterion weights",key:"showWeights"},{label:"Show point values",key:"showPoints"}].map(({label:M,key:g})=>W.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",textTransform:"none",letterSpacing:0},children:[W.jsx("input",{type:"checkbox",checked:y[g],onChange:r=>m(s=>({...s,[g]:r.target.checked}))}),M]},g))}),W.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>m(Ri),children:"Reset to Defaults"})]})]})]}),Y&&W.jsx("div",{className:"modal-overlay",onClick:()=>ue(!1),children:W.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:"var(--radius-lg)",padding:24,maxWidth:"90vw",maxHeight:"90vh",overflow:"auto"},onClick:M=>M.stopPropagation(),children:[W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[W.jsx("h3",{children:"Rubric Preview"}),W.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ue(!1),children:"✕ Close"})]}),W.jsx(td,{name:c||"Untitled",criteria:R,format:y})]})}),re&&d.standardsApiKey?W.jsx(nl,{apiKey:d.standardsApiKey,onSelect:M=>{Q(re,M),H(null)},onClose:()=>H(null)}):re&&!d.standardsApiKey?W.jsx("div",{className:"modal-overlay",onClick:()=>H(null),children:W.jsxs("div",{className:"modal",onClick:M=>M.stopPropagation(),style:{maxWidth:460},children:[W.jsxs("div",{className:"modal-header",children:[W.jsxs("h3",{children:[W.jsx(ti,{size:16})," Standards Integration"]}),W.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>H(null),children:"✕"})]}),W.jsxs("div",{className:"modal-body",children:[W.jsxs("p",{style:{marginBottom:12},children:["To link academic standards you need a ",W.jsx("strong",{children:"Common Standards Project API key"}),"."]}),W.jsxs("ol",{style:{paddingLeft:20,lineHeight:2,fontSize:"0.9rem"},children:[W.jsxs("li",{children:["Register at ",W.jsx("a",{href:"https://commonstandardsproject.com",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--accent)"},children:"commonstandardsproject.com"})]}),W.jsx("li",{children:"Copy your API key from the developer dashboard"}),W.jsxs("li",{children:["Add your app URL to the ",W.jsx("strong",{children:"CORS Allowed Origins"})," list"]}),W.jsxs("li",{children:["Paste the key in ",W.jsx("strong",{children:"Settings → Standards Integration"})]})]})]}),W.jsxs("div",{className:"modal-footer",children:[W.jsx("button",{className:"btn btn-secondary",onClick:()=>H(null),children:"Close"}),W.jsx("button",{className:"btn btn-primary",onClick:()=>{H(null),i("/settings")},children:"Open Settings"})]})]})}):null]})]})}function td({name:i,criteria:e,format:t}){var h;const a=((h=e[0])==null?void 0:h.levels)??[];return W.jsxs("div",{style:{fontFamily:t.fontFamily,fontSize:t.fontSize},children:[W.jsx("h2",{style:{marginBottom:12},children:i}),W.jsxs("table",{className:"rubric-grid",style:{tableLayout:"fixed"},children:[W.jsx("thead",{children:W.jsxs("tr",{style:{background:t.headerColor,color:t.headerTextColor},children:[W.jsx("th",{style:{width:t.criterionColWidth,textAlign:"left"},children:"Criterion"}),a.map(l=>W.jsxs("th",{style:{width:t.levelColWidth},children:[l.label,t.showPoints?` (${l.minPoints}${l.minPoints!==l.maxPoints?`–${l.maxPoints}`:""}pts)`:""]},l.id)),t.showWeights&&W.jsx("th",{style:{width:80},children:"Weight"})]})}),W.jsx("tbody",{children:e.map(l=>W.jsxs("tr",{children:[W.jsxs("td",{className:"criterion-cell",children:[W.jsx("div",{style:{fontWeight:600},children:l.title}),l.description&&W.jsx("div",{style:{fontSize:"0.8em",color:"var(--text-muted)",marginTop:4},children:l.description}),l.linkedStandard&&W.jsxs("div",{style:{marginTop:6,fontSize:"0.75em",color:"var(--accent)"},children:["📌 ",l.linkedStandard.statementNotation??l.linkedStandard.guid]})]}),l.levels.map(d=>W.jsxs("td",{className:"level-cell",children:[d.description||W.jsx("span",{style:{color:"var(--text-dim)"},children:"—"}),d.subItems.length>0&&W.jsx("ul",{style:{margin:"6px 0 0",padding:"0 0 0 14px",fontSize:"0.85em",color:"var(--text-muted)"},children:d.subItems.map(n=>W.jsxs("li",{children:[n.label," (",n.points,"pts)"]},n.id))})]},d.id)),t.showWeights&&W.jsxs("td",{style:{textAlign:"center"},children:[l.weight,"%"]})]},l.id))})]})]})}export{yd as default};
