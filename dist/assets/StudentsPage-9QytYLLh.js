import{g as Ee,b as je,u as we,a as Ce,r as te,j as r,e as Se,U as xe}from"./index-CBPv6F-N.js";import{T as Re}from"./Topbar-CFjW05tQ.js";import{U as Oe}from"./upload-GE-NSHzq.js";import{P as _e}from"./plus-DFQj3cQy.js";import{P as Ae}from"./pen-Bq_uJEvr.js";import{T as Ne}from"./trash-2-BjhHTPCW.js";var ke={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(me,fe){((se,k)=>{me.exports=k()})(je,function se(){var k=typeof self<"u"?self:typeof window<"u"?window:k!==void 0?k:{},X,J=!k.document&&!!k.postMessage,de=k.IS_PAPA_WORKER||!1,ne={},pe=0,o={};function U(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var n=ae(t);n.chunkSize=parseInt(n.chunkSize),t.step||t.chunk||(n.chunkSize=null),this._handle=new V(n),(this._handle.streamer=this)._config=n}).call(this,e),this.parseChunk=function(t,n){var i=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<i){let l=this._config.newline;l||(s=this._config.quoteChar||'"',l=this._handle.guessLineEndings(t,s)),t=[...t.split(l).slice(i)].join(l)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&(s=this._config.beforeFirstChunk(t))!==void 0&&(t=s),this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+t,s=(this._partialLine="",this._handle.parse(i,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=s.meta.cursor,i=(this._finished||(this._partialLine=i.substring(t-this._baseIndex),this._baseIndex=t),s&&s.data&&(this._rowCount+=s.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),de)k.postMessage({results:s,workerId:o.WORKER_ID,finished:i});else if(b(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=s=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!i||!b(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),i||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(t){b(this._config.error)?this._config.error(t):de&&this._config.error&&k.postMessage({workerId:o.WORKER_ID,error:t,finished:!1})}}function re(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),U.call(this,e),this._nextChunk=J?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),J||(t.onload=z(this._chunkLoaded,this),t.onerror=z(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!J),this._config.downloadRequestHeaders){var n,i=this._config.downloadRequestHeaders;for(n in i)t.setRequestHeader(n,i[n])}var s;this._config.chunkSize&&(s=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+s));try{t.send(this._config.downloadRequestBody)}catch(l){this._chunkError(l.message)}J&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(n=>(n=n.getResponseHeader("Content-Range"))!==null?parseInt(n.substring(n.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(n){n=t.statusText||n,this._sendError(new Error(n))}}function M(e){(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),U.call(this,e);var t,n,i=typeof FileReader<"u";this.stream=function(s){this._input=s,n=s.slice||s.webkitSlice||s.mozSlice,i?((t=new FileReader).onload=z(this._chunkLoaded,this),t.onerror=z(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var s=this._input,l=(this._config.chunkSize&&(l=Math.min(this._start+this._config.chunkSize,this._input.size),s=n.call(s,this._start,l)),t.readAsText(s,this._config.encoding));i||this._chunkLoaded({target:{result:l}})},this._chunkLoaded=function(s){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(s.target.result)},this._chunkError=function(){this._sendError(t.error)}}function B(e){var t;U.call(this,e=e||{}),this.stream=function(n){return t=n,this._nextChunk()},this._nextChunk=function(){var n,i;if(!this._finished)return n=this._config.chunkSize,t=n?(i=t.substring(0,n),t.substring(n)):(i=t,""),this._finished=!t,this.parseChunk(i)}}function K(e){U.call(this,e=e||{});var t=[],n=!0,i=!1;this.pause=function(){U.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){U.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(s){this._input=s,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=z(function(s){try{t.push(typeof s=="string"?s:s.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(l){this._streamError(l)}},this),this._streamError=z(function(s){this._streamCleanUp(),this._sendError(s)},this),this._streamEnd=z(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=z(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function V(e){var t,n,i,s,l=Math.pow(2,53),_=-l,T=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,S=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,f=this,j=0,d=0,D=!1,h=!1,p=[],a={data:[],errors:[],meta:{}};function O(m){return e.skipEmptyLines==="greedy"?m.join("").trim()==="":m.length===1&&m[0].length===0}function R(){if(a&&i&&(P("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),i=!1),e.skipEmptyLines&&(a.data=a.data.filter(function(u){return!O(u)})),I()){let u=function(C,A){b(e.transformHeader)&&(C=e.transformHeader(C,A)),p.push(C)};if(a)if(Array.isArray(a.data[0])){for(var m=0;I()&&m<a.data.length;m++)a.data[m].forEach(u);a.data.splice(0,1)}else a.data.forEach(u)}function y(u,C){for(var A=e.header?{}:[],x=0;x<u.length;x++){var v=x,g=u[x],g=((q,c)=>(E=>(e.dynamicTypingFunction&&e.dynamicTyping[E]===void 0&&(e.dynamicTyping[E]=e.dynamicTypingFunction(E)),(e.dynamicTyping[E]||e.dynamicTyping)===!0))(q)?c==="true"||c==="TRUE"||c!=="false"&&c!=="FALSE"&&((E=>{if(T.test(E)&&(E=parseFloat(E),_<E&&E<l))return 1})(c)?parseFloat(c):S.test(c)?new Date(c):c===""?null:c):c)(v=e.header?x>=p.length?"__parsed_extra":p[x]:v,g=e.transform?e.transform(g,v):g);v==="__parsed_extra"?(A[v]=A[v]||[],A[v].push(g)):A[v]=g}return e.header&&(x>p.length?P("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+x,d+C):x<p.length&&P("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+x,d+C)),A}var w;a&&(e.header||e.dynamicTyping||e.transform)&&(w=1,!a.data.length||Array.isArray(a.data[0])?(a.data=a.data.map(y),w=a.data.length):a.data=y(a.data,0),e.header&&a.meta&&(a.meta.fields=p),d+=w)}function I(){return e.header&&p.length===0}function P(m,y,w,u){m={type:m,code:y,message:w},u!==void 0&&(m.row=u),a.errors.push(m)}b(e.step)&&(s=e.step,e.step=function(m){a=m,I()?R():(R(),a.data.length!==0&&(j+=m.data.length,e.preview&&j>e.preview?n.abort():(a.data=a.data[0],s(a,f))))}),this.parse=function(m,y,w){var u=e.quoteChar||'"',u=(e.newline||(e.newline=this.guessLineEndings(m,u)),i=!1,e.delimiter?b(e.delimiter)&&(e.delimiter=e.delimiter(m),a.meta.delimiter=e.delimiter):((u=((C,A,x,v,g)=>{var q,c,E,Y;g=g||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var oe=0;oe<g.length;oe++){for(var W,he=g[oe],L=0,H=0,N=0,F=(E=void 0,new ee({comments:v,delimiter:he,newline:A,preview:10}).parse(C)),G=0;G<F.data.length;G++)x&&O(F.data[G])?N++:(W=F.data[G].length,H+=W,E===void 0?E=W:0<W&&(L+=Math.abs(W-E),E=W));0<F.data.length&&(H/=F.data.length-N),(c===void 0||L<=c)&&(Y===void 0||Y<H)&&1.99<H&&(c=L,q=he,Y=H)}return{successful:!!(e.delimiter=q),bestDelimiter:q}})(m,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=u.bestDelimiter:(i=!0,e.delimiter=o.DefaultDelimiter),a.meta.delimiter=e.delimiter),ae(e));return e.preview&&e.header&&u.preview++,t=m,n=new ee(u),a=n.parse(t,y,w),R(),D?{meta:{paused:!0}}:a||{meta:{paused:!1}}},this.paused=function(){return D},this.pause=function(){D=!0,n.abort(),t=b(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){f.streamer._halted?(D=!1,f.streamer.parseChunk(t,!0)):setTimeout(f.resume,3)},this.aborted=function(){return h},this.abort=function(){h=!0,n.abort(),a.meta.aborted=!0,b(e.complete)&&e.complete(a),t=""},this.guessLineEndings=function(C,u){C=C.substring(0,1048576);var u=new RegExp(Q(u)+"([^]*?)"+Q(u),"gm"),w=(C=C.replace(u,"")).split("\r"),u=C.split(`
`),C=1<u.length&&u[0].length<w[0].length;if(w.length===1||C)return`
`;for(var A=0,x=0;x<w.length;x++)w[x][0]===`
`&&A++;return A>=w.length/2?`\r
`:"\r"}}function Q(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ee(e){var t=(e=e||{}).delimiter,n=e.newline,i=e.comments,s=e.step,l=e.preview,_=e.fastMode,T=null,S=!1,f=e.quoteChar==null?'"':e.quoteChar,j=f;if(e.escapeChar!==void 0&&(j=e.escapeChar),(typeof t!="string"||-1<o.BAD_DELIMITERS.indexOf(t))&&(t=","),i===t)throw new Error("Comment character same as delimiter");i===!0?i="#":(typeof i!="string"||-1<o.BAD_DELIMITERS.indexOf(i))&&(i=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var d=0,D=!1;this.parse=function(h,p,a){if(typeof h!="string")throw new Error("Input must be a string");var O=h.length,R=t.length,I=n.length,P=i.length,m=b(s),y=[],w=[],u=[],C=d=0;if(!h)return L();if(_||_!==!1&&h.indexOf(f)===-1){for(var A=h.split(n),x=0;x<A.length;x++){if(u=A[x],d+=u.length,x!==A.length-1)d+=n.length;else if(a)return L();if(!i||u.substring(0,P)!==i){if(m){if(y=[],Y(u.split(t)),H(),D)return L()}else Y(u.split(t));if(l&&l<=x)return y=y.slice(0,l),L(!0)}}return L()}for(var v=h.indexOf(t,d),g=h.indexOf(n,d),q=new RegExp(Q(j)+Q(f),"g"),c=h.indexOf(f,d);;)if(h[d]===f)for(c=d,d++;;){if((c=h.indexOf(f,c+1))===-1)return a||w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:y.length,index:d}),W();if(c===O-1)return W(h.substring(d,c).replace(q,f));if(f===j&&h[c+1]===j)c++;else if(f===j||c===0||h[c-1]!==j){v!==-1&&v<c+1&&(v=h.indexOf(t,c+1));var E=oe((g=g!==-1&&g<c+1?h.indexOf(n,c+1):g)===-1?v:Math.min(v,g));if(h.substr(c+1+E,R)===t){u.push(h.substring(d,c).replace(q,f)),h[d=c+1+E+R]!==f&&(c=h.indexOf(f,d)),v=h.indexOf(t,d),g=h.indexOf(n,d);break}if(E=oe(g),h.substring(c+1+E,c+1+E+I)===n){if(u.push(h.substring(d,c).replace(q,f)),he(c+1+E+I),v=h.indexOf(t,d),c=h.indexOf(f,d),m&&(H(),D))return L();if(l&&y.length>=l)return L(!0);break}w.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:y.length,index:d}),c++}}else if(i&&u.length===0&&h.substring(d,d+P)===i){if(g===-1)return L();d=g+I,g=h.indexOf(n,d),v=h.indexOf(t,d)}else if(v!==-1&&(v<g||g===-1))u.push(h.substring(d,v)),d=v+R,v=h.indexOf(t,d);else{if(g===-1)break;if(u.push(h.substring(d,g)),he(g+I),m&&(H(),D))return L();if(l&&y.length>=l)return L(!0)}return W();function Y(N){y.push(N),C=d}function oe(N){var F=0;return F=N!==-1&&(N=h.substring(c+1,N))&&N.trim()===""?N.length:F}function W(N){return a||(N===void 0&&(N=h.substring(d)),u.push(N),d=O,Y(u),m&&H()),L()}function he(N){d=N,Y(u),u=[],g=h.indexOf(n,d)}function L(N){if(e.header&&!p&&y.length&&!S){var F=y[0],G=Object.create(null),ge=new Set(F);let ye=!1;for(let le=0;le<F.length;le++){let $=F[le];if(G[$=b(e.transformHeader)?e.transformHeader($,le):$]){let ce,be=G[$];for(;ce=$+"_"+be,be++,ge.has(ce););ge.add(ce),F[le]=ce,G[$]++,ye=!0,(T=T===null?{}:T)[ce]=$}else G[$]=1,F[le]=$;ge.add($)}ye&&console.warn("Duplicate headers found and renamed."),S=!0}return{data:y,errors:w,meta:{delimiter:t,linebreak:n,aborted:D,truncated:!!N,cursor:C+(p||0),renamedHeaders:T}}}function H(){s(L()),y=[],w=[]}},this.abort=function(){D=!0},this.getCharIndex=function(){return d}}function ue(e){var t=e.data,n=ne[t.workerId],i=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var s={abort:function(){i=!0,Z(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:ie,resume:ie};if(b(n.userStep)){for(var l=0;l<t.results.data.length&&(n.userStep({data:t.results.data[l],errors:t.results.errors,meta:t.results.meta},s),!i);l++);delete t.results}else b(n.userChunk)&&(n.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!i&&Z(t.workerId,t.results)}function Z(e,t){var n=ne[e];b(n.userComplete)&&n.userComplete(t),n.terminate(),delete ne[e]}function ie(){throw new Error("Not implemented.")}function ae(e){if(typeof e!="object"||e===null)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=ae(e[t]);return n}function z(e,t){return function(){e.apply(t,arguments)}}function b(e){return typeof e=="function"}return o.parse=function(e,t){var n=(t=t||{}).dynamicTyping||!1;if(b(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=!!b(t.transform)&&t.transform,!t.worker||!o.WORKERS_SUPPORTED)return n=null,o.NODE_STREAM_INPUT,typeof e=="string"?(e=(i=>i.charCodeAt(0)!==65279?i:i.slice(1))(e),n=new(t.download?re:B)(t)):e.readable===!0&&b(e.read)&&b(e.on)?n=new K(t):(k.File&&e instanceof File||e instanceof Object)&&(n=new M(t)),n.stream(e);(n=(()=>{var i;return!!o.WORKERS_SUPPORTED&&(i=(()=>{var s=k.URL||k.webkitURL||null,l=se.toString();return o.BLOB_URL||(o.BLOB_URL=s.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",l,")();"],{type:"text/javascript"})))})(),(i=new k.Worker(i)).onmessage=ue,i.id=pe++,ne[i.id]=i)})()).userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=b(t.step),t.chunk=b(t.chunk),t.complete=b(t.complete),t.error=b(t.error),delete t.worker,n.postMessage({input:e,config:t,workerId:n.id})},o.unparse=function(e,t){var n=!1,i=!0,s=",",l=`\r
`,_='"',T=_+_,S=!1,f=null,j=!1,d=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||o.BAD_DELIMITERS.filter(function(p){return t.delimiter.indexOf(p)!==-1}).length||(s=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(n=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(S=t.skipEmptyLines),typeof t.newline=="string"&&(l=t.newline),typeof t.quoteChar=="string"&&(_=t.quoteChar),typeof t.header=="boolean"&&(i=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");f=t.columns}t.escapeChar!==void 0&&(T=t.escapeChar+_),t.escapeFormulae instanceof RegExp?j=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(j=/^[=+\-@\t\r].*$/)}})(),new RegExp(Q(_),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return D(null,e,S);if(typeof e[0]=="object")return D(f||Object.keys(e[0]),e,S)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||f),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),D(e.fields||[],e.data||[],S);throw new Error("Unable to serialize unrecognized input");function D(p,a,O){var R="",I=(typeof p=="string"&&(p=JSON.parse(p)),typeof a=="string"&&(a=JSON.parse(a)),Array.isArray(p)&&0<p.length),P=!Array.isArray(a[0]);if(I&&i){for(var m=0;m<p.length;m++)0<m&&(R+=s),R+=h(p[m],m);0<a.length&&(R+=l)}for(var y=0;y<a.length;y++){var w=(I?p:a[y]).length,u=!1,C=I?Object.keys(a[y]).length===0:a[y].length===0;if(O&&!I&&(u=O==="greedy"?a[y].join("").trim()==="":a[y].length===1&&a[y][0].length===0),O==="greedy"&&I){for(var A=[],x=0;x<w;x++){var v=P?p[x]:x;A.push(a[y][v])}u=A.join("").trim()===""}if(!u){for(var g=0;g<w;g++){0<g&&!C&&(R+=s);var q=I&&P?p[g]:g;R+=h(a[y][q],g)}y<a.length-1&&(!O||0<w&&!C)&&(R+=l)}}return R}function h(p,a){var O,R;return p==null?"":p.constructor===Date?JSON.stringify(p).slice(1,25):(R=!1,j&&typeof p=="string"&&j.test(p)&&(p="'"+p,R=!0),O=p.toString().replace(d,T),(R=R||n===!0||typeof n=="function"&&n(p,a)||Array.isArray(n)&&n[a]||((I,P)=>{for(var m=0;m<P.length;m++)if(-1<I.indexOf(P[m]))return!0;return!1})(O,o.BAD_DELIMITERS)||-1<O.indexOf(s)||O.charAt(0)===" "||O.charAt(O.length-1)===" ")?_+O+_:O)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!J&&!!k.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=ee,o.ParserHandle=V,o.NetworkStreamer=re,o.FileStreamer=M,o.StringStreamer=B,o.ReadableStreamStreamer=K,k.jQuery&&((X=k.jQuery).fn.parse=function(e){var t=e.config||{},n=[];return this.each(function(l){if(!(X(this).prop("tagName").toUpperCase()==="INPUT"&&X(this).attr("type").toLowerCase()==="file"&&k.FileReader)||!this.files||this.files.length===0)return!0;for(var _=0;_<this.files.length;_++)n.push({file:this.files[_],inputElem:this,instanceConfig:X.extend({},t)})}),i(),this;function i(){if(n.length===0)b(e.complete)&&e.complete();else{var l,_,T,S,f=n[0];if(b(e.before)){var j=e.before(f.file,f.inputElem);if(typeof j=="object"){if(j.action==="abort")return l="AbortError",_=f.file,T=f.inputElem,S=j.reason,void(b(e.error)&&e.error({name:l},_,T,S));if(j.action==="skip")return void s();typeof j.config=="object"&&(f.instanceConfig=X.extend(f.instanceConfig,j.config))}else if(j==="skip")return void s()}var d=f.instanceConfig.complete;f.instanceConfig.complete=function(D){b(d)&&d(D,f.file,f.inputElem),s()},o.parse(f.file,f.instanceConfig)}}function s(){n.splice(0,1),i()}}),de&&(k.onmessage=function(e){e=e.data,o.WORKER_ID===void 0&&e&&(o.WORKER_ID=e.workerId),typeof e.input=="string"?k.postMessage({workerId:o.WORKER_ID,results:o.parse(e.input,e.config),finished:!0}):(k.File&&e.input instanceof File||e.input instanceof Object)&&(e=o.parse(e.input,e.config))&&k.postMessage({workerId:o.WORKER_ID,results:e,finished:!0})}),(re.prototype=Object.create(U.prototype)).constructor=re,(M.prototype=Object.create(U.prototype)).constructor=M,(B.prototype=Object.create(B.prototype)).constructor=B,(K.prototype=Object.create(U.prototype)).constructor=K,o})})(ke);var Ie=ke.exports;const ve=Ee(Ie);function Pe(){var n,i;const me=we(),{students:fe,classes:se,rubrics:k,studentRubrics:X,addStudent:J,updateStudent:de,deleteStudent:ne,addClass:pe}=Ce(),[o,U]=te.useState(((n=se[0])==null?void 0:n.id)??""),[re,M]=te.useState(!1),[B,K]=te.useState(null),[V,Q]=te.useState(""),[ee,ue]=te.useState(""),[Z,ie]=te.useState(""),ae=te.useRef(null),z=fe.filter(s=>s.classId===o);function b(){V.trim()&&(B?de({...fe.find(s=>s.id===B.id),name:V,email:ee}):J({name:V,email:ee,classId:o}),Q(""),ue(""),M(!1),K(null))}function e(s){var _;const l=(_=s.target.files)==null?void 0:_[0];l&&(ve.parse(l,{header:!0,complete:({data:T})=>{T.forEach(S=>{S.name&&J({name:S.name,email:S.email??"",classId:o})})}}),s.target.value="")}function t(){const s=z.map(f=>({name:f.name,email:f.email??""})),l=ve.unparse(s),_=new Blob([l],{type:"text/csv"}),T=URL.createObjectURL(_),S=document.createElement("a");S.href=T,S.download="students.csv",S.click()}return r.jsxs(r.Fragment,{children:[r.jsx(Re,{title:"Students & Classes",actions:r.jsxs(r.Fragment,{children:[r.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>{var s;return(s=ae.current)==null?void 0:s.click()},children:[r.jsx(Oe,{size:15})," Import CSV"]}),r.jsx("input",{ref:ae,type:"file",accept:".csv",onChange:e,style:{display:"none"}}),r.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:t,children:[r.jsx(Se,{size:15})," Export CSV"]}),r.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>M(!0),children:[r.jsx(_e,{size:15})," Add Student"]})]})}),r.jsxs("div",{className:"page-content fade-in",children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"220px 1fr",gap:20},children:[r.jsxs("div",{className:"card",style:{height:"fit-content"},children:[r.jsx("div",{className:"card-header",children:r.jsx("h3",{children:"Classes"})}),se.map(s=>r.jsxs("button",{className:`nav-item ${s.id===o?"active":""}`,onClick:()=>U(s.id),children:[r.jsx(xe,{size:15}),r.jsx("span",{className:"truncate",children:s.name}),r.jsx("span",{style:{marginLeft:"auto",fontSize:"0.75rem",opacity:.7},children:fe.filter(l=>l.classId===s.id).length})]},s.id)),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:6},children:[r.jsx("input",{type:"text",placeholder:"New class…",value:Z,onChange:s=>ie(s.target.value),onKeyDown:s=>{s.key==="Enter"&&Z.trim()&&(pe({name:Z.trim()}),ie(""))},style:{flex:1,fontSize:"0.82rem"}}),r.jsx("button",{className:"btn btn-primary btn-icon btn-sm",onClick:()=>{Z.trim()&&(pe({name:Z.trim()}),ie(""))},children:r.jsx(_e,{size:14})})]})]}),r.jsxs("div",{className:"card",children:[r.jsx("div",{className:"card-header",children:r.jsxs("h3",{children:[((i=se.find(s=>s.id===o))==null?void 0:i.name)??"Class"," — ",z.length," students"]})}),z.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx(xe,{size:32}),r.jsx("p",{children:"No students in this class yet."}),r.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>M(!0),children:[r.jsx(_e,{size:14})," Add Student"]})]}):r.jsxs("table",{className:"data-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Grades"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:z.map(s=>{const l=X.filter(_=>_.studentId===s.id).length;return r.jsxs("tr",{children:[r.jsx("td",{style:{fontWeight:500},children:s.name}),r.jsx("td",{className:"text-muted text-sm",children:s.email||"—"}),r.jsx("td",{children:l>0?r.jsxs("span",{className:"badge badge-green",children:[l," rubric",l!==1?"s":""]}):r.jsx("span",{className:"badge badge-yellow",children:"Not graded"})}),r.jsx("td",{children:r.jsxs("div",{style:{display:"flex",gap:6},children:[k.map(_=>r.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>me(`/rubrics/${_.id}/grade/${s.id}`),children:["Grade: ",_.name.slice(0,12),_.name.length>12?"…":""]},_.id)),r.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",onClick:()=>{K({id:s.id,name:s.name,email:s.email??""}),Q(s.name),ue(s.email??""),M(!0)},children:r.jsx(Ae,{size:14})}),r.jsx("button",{className:"btn btn-ghost btn-icon btn-sm",style:{color:"var(--red)"},onClick:()=>ne(s.id),children:r.jsx(Ne,{size:14})})]})})]},s.id)})})]})]})]}),re&&r.jsx("div",{className:"modal-overlay",onClick:()=>{M(!1),K(null)},children:r.jsxs("div",{className:"modal",onClick:s=>s.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:B?"Edit Student":"Add Student"}),r.jsx("button",{className:"btn btn-ghost btn-icon",onClick:()=>{M(!1),K(null)},children:"✕"})]}),r.jsxs("div",{className:"modal-body",children:[r.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[r.jsx("label",{children:"Full Name *"}),r.jsx("input",{type:"text",value:V,onChange:s=>Q(s.target.value),placeholder:"Student name",autoFocus:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email (optional)"}),r.jsx("input",{type:"email",value:ee,onChange:s=>ue(s.target.value),placeholder:"student@school.edu"})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{className:"btn btn-secondary",onClick:()=>{M(!1),K(null)},children:"Cancel"}),r.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!V.trim(),children:B?"Save Changes":"Add Student"})]})]})})]})]})}export{Pe as default};
